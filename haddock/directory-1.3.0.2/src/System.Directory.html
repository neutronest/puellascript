<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Transitional//EN" "http://www.w3.org/TR/xhtml1/DTD/xhtml1-transitional.dtd"><html xmlns="http://www.w3.org/1999/xhtml"><head><link rel="stylesheet" type="text/css" href="style.css" /><script type="text/javascript" src="highlight.js"></script></head><body><pre><span class="hs-pragma">{-# LANGUAGE CPP #-}</span><span>
</span><a name="line-2"></a><span>
</span><a name="line-3"></a><span class="hs-cpp">#if !(MIN_VERSION_base(4,8,0))</span><span>
</span><a name="line-4"></a><span class="hs-comment">-- In base-4.8.0 the Foreign module became Safe</span><span>
</span><a name="line-5"></a><span class="hs-pragma">{-# LANGUAGE Trustworthy #-}</span><span>
</span><a name="line-6"></a><span class="hs-cpp">#endif</span><span>
</span><a name="line-7"></a><span>
</span><a name="line-8"></a><span class="hs-comment">-----------------------------------------------------------------------------</span><span>
</span><a name="line-9"></a><span class="hs-comment">-- |</span><span>
</span><a name="line-10"></a><span class="hs-comment">-- Module      :  System.Directory</span><span>
</span><a name="line-11"></a><span class="hs-comment">-- Copyright   :  (c) The University of Glasgow 2001</span><span>
</span><a name="line-12"></a><span class="hs-comment">-- License     :  BSD-style (see the file libraries/base/LICENSE)</span><span>
</span><a name="line-13"></a><span class="hs-comment">--</span><span>
</span><a name="line-14"></a><span class="hs-comment">-- Maintainer  :  libraries@haskell.org</span><span>
</span><a name="line-15"></a><span class="hs-comment">-- Stability   :  stable</span><span>
</span><a name="line-16"></a><span class="hs-comment">-- Portability :  portable</span><span>
</span><a name="line-17"></a><span class="hs-comment">--</span><span>
</span><a name="line-18"></a><span class="hs-comment">-- System-independent interface to directory manipulation.</span><span>
</span><a name="line-19"></a><span class="hs-comment">--</span><span>
</span><a name="line-20"></a><span class="hs-comment">-----------------------------------------------------------------------------</span><span>
</span><a name="line-21"></a><span>
</span><a name="line-22"></a><span class="hs-cpp">#include &lt;HsDirectoryConfig.h&gt;</span><span>
</span><a name="line-23"></a><span class="hs-keyword">module</span><span> </span><span class="hs-identifier">System</span><span class="hs-operator">.</span><span class="hs-identifier">Directory</span><span>
</span><a name="line-24"></a><span>   </span><span class="hs-special">(</span><span>
</span><a name="line-25"></a><span>    </span><span class="hs-comment">-- $intro</span><span>
</span><a name="line-26"></a><span>
</span><a name="line-27"></a><span>    </span><span class="hs-comment">-- * Actions on directories</span><span>
</span><a name="line-28"></a><span>      </span><a href="System.Directory.html#createDirectory"><span class="hs-identifier hs-var">createDirectory</span></a><span>
</span><a name="line-29"></a><span>    </span><span class="hs-special">,</span><span> </span><a href="System.Directory.html#createDirectoryIfMissing"><span class="hs-identifier hs-var">createDirectoryIfMissing</span></a><span>
</span><a name="line-30"></a><span>    </span><span class="hs-special">,</span><span> </span><a href="System.Directory.html#removeDirectory"><span class="hs-identifier hs-var">removeDirectory</span></a><span>
</span><a name="line-31"></a><span>    </span><span class="hs-special">,</span><span> </span><a href="System.Directory.html#removeDirectoryRecursive"><span class="hs-identifier hs-var">removeDirectoryRecursive</span></a><span>
</span><a name="line-32"></a><span>    </span><span class="hs-special">,</span><span> </span><a href="System.Directory.html#removePathForcibly"><span class="hs-identifier hs-var">removePathForcibly</span></a><span>
</span><a name="line-33"></a><span>    </span><span class="hs-special">,</span><span> </span><a href="System.Directory.html#renameDirectory"><span class="hs-identifier hs-var">renameDirectory</span></a><span>
</span><a name="line-34"></a><span>    </span><span class="hs-special">,</span><span> </span><a href="System.Directory.html#listDirectory"><span class="hs-identifier hs-var">listDirectory</span></a><span>
</span><a name="line-35"></a><span>    </span><span class="hs-special">,</span><span> </span><a href="System.Directory.html#getDirectoryContents"><span class="hs-identifier hs-var">getDirectoryContents</span></a><span>
</span><a name="line-36"></a><span>    </span><span class="hs-comment">-- ** Current working directory</span><span>
</span><a name="line-37"></a><span>    </span><span class="hs-special">,</span><span> </span><a href="System.Directory.html#getCurrentDirectory"><span class="hs-identifier hs-var">getCurrentDirectory</span></a><span>
</span><a name="line-38"></a><span>    </span><span class="hs-special">,</span><span> </span><a href="System.Directory.html#setCurrentDirectory"><span class="hs-identifier hs-var">setCurrentDirectory</span></a><span>
</span><a name="line-39"></a><span>    </span><span class="hs-special">,</span><span> </span><a href="System.Directory.html#withCurrentDirectory"><span class="hs-identifier hs-var">withCurrentDirectory</span></a><span>
</span><a name="line-40"></a><span>
</span><a name="line-41"></a><span>    </span><span class="hs-comment">-- * Pre-defined directories</span><span>
</span><a name="line-42"></a><span>    </span><span class="hs-special">,</span><span> </span><a href="System.Directory.html#getHomeDirectory"><span class="hs-identifier hs-var">getHomeDirectory</span></a><span>
</span><a name="line-43"></a><span>    </span><span class="hs-special">,</span><span> </span><a href="System.Directory.html#XdgDirectory"><span class="hs-identifier hs-type">XdgDirectory</span></a><span class="hs-special">(</span><span class="hs-glyph">..</span><span class="hs-special">)</span><span>
</span><a name="line-44"></a><span>    </span><span class="hs-special">,</span><span> </span><a href="System.Directory.html#getXdgDirectory"><span class="hs-identifier hs-var">getXdgDirectory</span></a><span>
</span><a name="line-45"></a><span>    </span><span class="hs-special">,</span><span> </span><a href="System.Directory.html#getAppUserDataDirectory"><span class="hs-identifier hs-var">getAppUserDataDirectory</span></a><span>
</span><a name="line-46"></a><span>    </span><span class="hs-special">,</span><span> </span><a href="System.Directory.html#getUserDocumentsDirectory"><span class="hs-identifier hs-var">getUserDocumentsDirectory</span></a><span>
</span><a name="line-47"></a><span>    </span><span class="hs-special">,</span><span> </span><a href="System.Directory.html#getTemporaryDirectory"><span class="hs-identifier hs-var">getTemporaryDirectory</span></a><span>
</span><a name="line-48"></a><span>
</span><a name="line-49"></a><span>    </span><span class="hs-comment">-- * Actions on files</span><span>
</span><a name="line-50"></a><span>    </span><span class="hs-special">,</span><span> </span><a href="System.Directory.html#removeFile"><span class="hs-identifier hs-var">removeFile</span></a><span>
</span><a name="line-51"></a><span>    </span><span class="hs-special">,</span><span> </span><a href="System.Directory.html#renameFile"><span class="hs-identifier hs-var">renameFile</span></a><span>
</span><a name="line-52"></a><span>    </span><span class="hs-special">,</span><span> </span><a href="System.Directory.html#renamePath"><span class="hs-identifier hs-var">renamePath</span></a><span>
</span><a name="line-53"></a><span>    </span><span class="hs-special">,</span><span> </span><a href="System.Directory.html#copyFile"><span class="hs-identifier hs-var">copyFile</span></a><span>
</span><a name="line-54"></a><span>    </span><span class="hs-special">,</span><span> </span><a href="System.Directory.html#copyFileWithMetadata"><span class="hs-identifier hs-var">copyFileWithMetadata</span></a><span>
</span><a name="line-55"></a><span>
</span><a name="line-56"></a><span>    </span><span class="hs-special">,</span><span> </span><a href="System.Directory.html#canonicalizePath"><span class="hs-identifier hs-var">canonicalizePath</span></a><span>
</span><a name="line-57"></a><span>    </span><span class="hs-special">,</span><span> </span><a href="System.Directory.html#makeAbsolute"><span class="hs-identifier hs-var">makeAbsolute</span></a><span>
</span><a name="line-58"></a><span>    </span><span class="hs-special">,</span><span> </span><a href="System.Directory.html#makeRelativeToCurrentDirectory"><span class="hs-identifier hs-var">makeRelativeToCurrentDirectory</span></a><span>
</span><a name="line-59"></a><span>    </span><span class="hs-special">,</span><span> </span><a href="System.Directory.html#findExecutable"><span class="hs-identifier hs-var">findExecutable</span></a><span>
</span><a name="line-60"></a><span>    </span><span class="hs-special">,</span><span> </span><a href="System.Directory.html#findExecutables"><span class="hs-identifier hs-var">findExecutables</span></a><span>
</span><a name="line-61"></a><span>    </span><span class="hs-special">,</span><span> </span><a href="System.Directory.html#findExecutablesInDirectories"><span class="hs-identifier hs-var">findExecutablesInDirectories</span></a><span>
</span><a name="line-62"></a><span>    </span><span class="hs-special">,</span><span> </span><a href="System.Directory.html#findFile"><span class="hs-identifier hs-var">findFile</span></a><span>
</span><a name="line-63"></a><span>    </span><span class="hs-special">,</span><span> </span><a href="System.Directory.html#findFiles"><span class="hs-identifier hs-var">findFiles</span></a><span>
</span><a name="line-64"></a><span>    </span><span class="hs-special">,</span><span> </span><a href="System.Directory.html#findFileWith"><span class="hs-identifier hs-var">findFileWith</span></a><span>
</span><a name="line-65"></a><span>    </span><span class="hs-special">,</span><span> </span><a href="System.Directory.html#findFilesWith"><span class="hs-identifier hs-var">findFilesWith</span></a><span>
</span><a name="line-66"></a><span>    </span><span class="hs-special">,</span><span> </span><a href="System.Directory.Internal.Config.html#exeExtension"><span class="hs-identifier hs-var">exeExtension</span></a><span>
</span><a name="line-67"></a><span>
</span><a name="line-68"></a><span>    </span><span class="hs-special">,</span><span> </span><a href="System.Directory.html#getFileSize"><span class="hs-identifier hs-var">getFileSize</span></a><span>
</span><a name="line-69"></a><span>
</span><a name="line-70"></a><span>    </span><span class="hs-comment">-- * Existence tests</span><span>
</span><a name="line-71"></a><span>    </span><span class="hs-special">,</span><span> </span><a href="System.Directory.html#doesPathExist"><span class="hs-identifier hs-var">doesPathExist</span></a><span>
</span><a name="line-72"></a><span>    </span><span class="hs-special">,</span><span> </span><a href="System.Directory.html#doesFileExist"><span class="hs-identifier hs-var">doesFileExist</span></a><span>
</span><a name="line-73"></a><span>    </span><span class="hs-special">,</span><span> </span><a href="System.Directory.html#doesDirectoryExist"><span class="hs-identifier hs-var">doesDirectoryExist</span></a><span>
</span><a name="line-74"></a><span>
</span><a name="line-75"></a><span>    </span><span class="hs-comment">-- * Symbolic links</span><span>
</span><a name="line-76"></a><span>    </span><span class="hs-special">,</span><span> </span><a href="System.Directory.html#pathIsSymbolicLink"><span class="hs-identifier hs-var">pathIsSymbolicLink</span></a><span>
</span><a name="line-77"></a><span>
</span><a name="line-78"></a><span>    </span><span class="hs-comment">-- * Permissions</span><span>
</span><a name="line-79"></a><span>
</span><a name="line-80"></a><span>    </span><span class="hs-comment">-- $permissions</span><span>
</span><a name="line-81"></a><span>
</span><a name="line-82"></a><span>    </span><span class="hs-special">,</span><span> </span><a href="System.Directory.html#Permissions"><span class="hs-identifier hs-type">Permissions</span></a><span>
</span><a name="line-83"></a><span>    </span><span class="hs-special">,</span><span> </span><a href="System.Directory.html#emptyPermissions"><span class="hs-identifier hs-var">emptyPermissions</span></a><span>
</span><a name="line-84"></a><span>    </span><span class="hs-special">,</span><span> </span><a href="System.Directory.html#readable"><span class="hs-identifier hs-var">readable</span></a><span>
</span><a name="line-85"></a><span>    </span><span class="hs-special">,</span><span> </span><a href="System.Directory.html#writable"><span class="hs-identifier hs-var">writable</span></a><span>
</span><a name="line-86"></a><span>    </span><span class="hs-special">,</span><span> </span><a href="System.Directory.html#executable"><span class="hs-identifier hs-var">executable</span></a><span>
</span><a name="line-87"></a><span>    </span><span class="hs-special">,</span><span> </span><a href="System.Directory.html#searchable"><span class="hs-identifier hs-var">searchable</span></a><span>
</span><a name="line-88"></a><span>    </span><span class="hs-special">,</span><span> </span><a href="System.Directory.html#setOwnerReadable"><span class="hs-identifier hs-var">setOwnerReadable</span></a><span>
</span><a name="line-89"></a><span>    </span><span class="hs-special">,</span><span> </span><a href="System.Directory.html#setOwnerWritable"><span class="hs-identifier hs-var">setOwnerWritable</span></a><span>
</span><a name="line-90"></a><span>    </span><span class="hs-special">,</span><span> </span><a href="System.Directory.html#setOwnerExecutable"><span class="hs-identifier hs-var">setOwnerExecutable</span></a><span>
</span><a name="line-91"></a><span>    </span><span class="hs-special">,</span><span> </span><a href="System.Directory.html#setOwnerSearchable"><span class="hs-identifier hs-var">setOwnerSearchable</span></a><span>
</span><a name="line-92"></a><span>
</span><a name="line-93"></a><span>    </span><span class="hs-special">,</span><span> </span><a href="System.Directory.html#getPermissions"><span class="hs-identifier hs-var">getPermissions</span></a><span>
</span><a name="line-94"></a><span>    </span><span class="hs-special">,</span><span> </span><a href="System.Directory.html#setPermissions"><span class="hs-identifier hs-var">setPermissions</span></a><span>
</span><a name="line-95"></a><span>    </span><span class="hs-special">,</span><span> </span><a href="System.Directory.html#copyPermissions"><span class="hs-identifier hs-var">copyPermissions</span></a><span>
</span><a name="line-96"></a><span>
</span><a name="line-97"></a><span>    </span><span class="hs-comment">-- * Timestamps</span><span>
</span><a name="line-98"></a><span>
</span><a name="line-99"></a><span>    </span><span class="hs-special">,</span><span> </span><a href="System.Directory.html#getAccessTime"><span class="hs-identifier hs-var">getAccessTime</span></a><span>
</span><a name="line-100"></a><span>    </span><span class="hs-special">,</span><span> </span><a href="System.Directory.html#getModificationTime"><span class="hs-identifier hs-var">getModificationTime</span></a><span>
</span><a name="line-101"></a><span>    </span><span class="hs-special">,</span><span> </span><a href="System.Directory.html#setAccessTime"><span class="hs-identifier hs-var">setAccessTime</span></a><span>
</span><a name="line-102"></a><span>    </span><span class="hs-special">,</span><span> </span><a href="System.Directory.html#setModificationTime"><span class="hs-identifier hs-var">setModificationTime</span></a><span>
</span><a name="line-103"></a><span>
</span><a name="line-104"></a><span>    </span><span class="hs-comment">-- * Deprecated</span><span>
</span><a name="line-105"></a><span>    </span><span class="hs-special">,</span><span> </span><a href="System.Directory.html#isSymbolicLink"><span class="hs-identifier hs-var">isSymbolicLink</span></a><span>
</span><a name="line-106"></a><span>
</span><a name="line-107"></a><span>   </span><span class="hs-special">)</span><span> </span><span class="hs-keyword">where</span><span>
</span><a name="line-108"></a><span class="hs-keyword">import</span><span> </span><a href="../base-4.10.0.0/src/%{MODULE/./-}.html#%{NAME}/Prelude.html"><span class="hs-identifier">Prelude</span></a><span> </span><span class="hs-special">(</span><span class="hs-special">)</span><span>
</span><a name="line-109"></a><span class="hs-keyword">import</span><span> </span><a href="System.Directory.Internal.html"><span class="hs-identifier">System</span><span class="hs-operator">.</span><span class="hs-identifier">Directory</span><span class="hs-operator">.</span><span class="hs-identifier">Internal</span></a><span>
</span><a name="line-110"></a><span class="hs-keyword">import</span><span> </span><a href="System.Directory.Internal.Prelude.html"><span class="hs-identifier">System</span><span class="hs-operator">.</span><span class="hs-identifier">Directory</span><span class="hs-operator">.</span><span class="hs-identifier">Internal</span><span class="hs-operator">.</span><span class="hs-identifier">Prelude</span></a><span>
</span><a name="line-111"></a><span class="hs-keyword">import</span><span> </span><a href="../filepath-1.4.1.1/src/%{MODULE/./-}.html#%{NAME}/System.FilePath.html"><span class="hs-identifier">System</span><span class="hs-operator">.</span><span class="hs-identifier">FilePath</span></a><span>
</span><a name="line-112"></a><span class="hs-keyword">import</span><span> </span><a href="../time-1.8.0.1/src/%{MODULE/./-}.html#%{NAME}/Data.Time.html"><span class="hs-identifier">Data</span><span class="hs-operator">.</span><span class="hs-identifier">Time</span></a><span> </span><span class="hs-special">(</span><a href="../time-1.8.0.1/src/%{MODULE/./-}.html#%{NAME}/Data.Time.Clock.Internal.UTCTime.html#UTCTime"><span class="hs-identifier hs-type">UTCTime</span></a><span class="hs-special">)</span><span>
</span><a name="line-113"></a><span class="hs-keyword">import</span><span> </span><a href="../time-1.8.0.1/src/%{MODULE/./-}.html#%{NAME}/Data.Time.Clock.POSIX.html"><span class="hs-identifier">Data</span><span class="hs-operator">.</span><span class="hs-identifier">Time</span><span class="hs-operator">.</span><span class="hs-identifier">Clock</span><span class="hs-operator">.</span><span class="hs-identifier">POSIX</span></a><span>
</span><a name="line-114"></a><span>  </span><span class="hs-special">(</span><span> </span><a href="../time-1.8.0.1/src/%{MODULE/./-}.html#%{NAME}/Data.Time.Clock.POSIX.html#posixSecondsToUTCTime"><span class="hs-identifier hs-var">posixSecondsToUTCTime</span></a><span>
</span><a name="line-115"></a><span>  </span><span class="hs-special">,</span><span> </span><a href="../time-1.8.0.1/src/%{MODULE/./-}.html#%{NAME}/Data.Time.Clock.POSIX.html#utcTimeToPOSIXSeconds"><span class="hs-identifier hs-var">utcTimeToPOSIXSeconds</span></a><span>
</span><a name="line-116"></a><span>  </span><span class="hs-special">,</span><span> </span><a href="../time-1.8.0.1/src/%{MODULE/./-}.html#%{NAME}/Data.Time.Clock.Internal.POSIXTime.html#POSIXTime"><span class="hs-identifier hs-type">POSIXTime</span></a><span>
</span><a name="line-117"></a><span>  </span><span class="hs-special">)</span><span>
</span><a name="line-118"></a><span class="hs-cpp">#ifdef mingw32_HOST_OS</span><span>
</span><a name="line-119"></a><span class="hs-keyword">import</span><span> </span><span class="hs-keyword">qualified</span><span> </span><span class="hs-identifier">System</span><span class="hs-operator">.</span><span class="hs-identifier">Win32</span><span> </span><span class="hs-keyword">as</span><span> </span><span class="hs-identifier">Win32</span><span>
</span><a name="line-120"></a><span class="hs-cpp">#else</span><span>
</span><a name="line-121"></a><span class="hs-keyword">import</span><span> </span><span class="hs-keyword">qualified</span><span> </span><a href="../base-4.10.0.0/src/%{MODULE/./-}.html#%{NAME}/GHC.Foreign.html"><span class="hs-identifier">GHC</span><span class="hs-operator">.</span><span class="hs-identifier">Foreign</span></a><span> </span><span class="hs-keyword">as</span><span> </span><span class="hs-identifier">GHC</span><span>
</span><a name="line-122"></a><span class="hs-keyword">import</span><span> </span><span class="hs-keyword">qualified</span><span> </span><a href="../unix-2.7.2.1/src/%{MODULE/./-}.html#%{NAME}/System.Posix.html"><span class="hs-identifier">System</span><span class="hs-operator">.</span><span class="hs-identifier">Posix</span></a><span> </span><span class="hs-keyword">as</span><span> </span><span class="hs-identifier">Posix</span><span>
</span><a name="line-123"></a><span class="hs-cpp">#endif</span><span>
</span><a name="line-124"></a><span>
</span><a name="line-125"></a><span class="hs-comment">{- $intro
A directory contains a series of entries, each of which is a named
reference to a file system object (file, directory etc.).  Some
entries may be hidden, inaccessible, or have some administrative
function (e.g. @.@ or @..@ under
&lt;http://www.opengroup.org/onlinepubs/009695399 POSIX&gt;), but in
this standard all such entries are considered to form part of the
directory contents. Entries in sub-directories are not, however,
considered to form part of the directory contents.

Each file system object is referenced by a /path/.  There is
normally at least one absolute path to each file system object.  In
some operating systems, it may also be possible to have paths which
are relative to the current directory.
-}</span><span>
</span><a name="line-140"></a><span>
</span><a name="line-141"></a><span class="hs-comment">-----------------------------------------------------------------------------</span><span>
</span><a name="line-142"></a><span class="hs-comment">-- Permissions</span><span>
</span><a name="line-143"></a><span>
</span><a name="line-144"></a><span class="hs-comment">{- $permissions

 The 'Permissions' type is used to record whether certain operations are
 permissible on a file\/directory. 'getPermissions' and 'setPermissions'
 get and set these permissions, respectively. Permissions apply both to
 files and directories. For directories, the executable field will be
 'False', and for files the searchable field will be 'False'. Note that
 directories may be searchable without being readable, if permission has
 been given to use them as part of a path, but not to examine the
 directory contents.

Note that to change some, but not all permissions, a construct on the following lines must be used.

&gt;  makeReadable f = do
&gt;     p &lt;- getPermissions f
&gt;     setPermissions f (p {readable = True})

-}</span><span>
</span><a name="line-162"></a><span>
</span><a name="line-163"></a><span class="hs-keyword">data</span><span> </span><a name="Permissions"><a href="System.Directory.html#Permissions"><span class="hs-identifier">Permissions</span></a></a><span>
</span><a name="line-164"></a><span> </span><span class="hs-glyph">=</span><span> </span><a name="Permissions"><a href="System.Directory.html#Permissions"><span class="hs-identifier">Permissions</span></a></a><span> </span><span class="hs-special">{</span><span>
</span><a name="line-165"></a><span>    </span><a name="readable"><a href="System.Directory.html#readable"><span class="hs-identifier">readable</span></a></a><span class="hs-special">,</span><span>   </span><a name="writable"><a href="System.Directory.html#writable"><span class="hs-identifier">writable</span></a></a><span class="hs-special">,</span><span>
</span><a name="line-166"></a><span>    </span><a name="executable"><a href="System.Directory.html#executable"><span class="hs-identifier">executable</span></a></a><span class="hs-special">,</span><span> </span><a name="searchable"><a href="System.Directory.html#searchable"><span class="hs-identifier">searchable</span></a></a><span> </span><span class="hs-glyph">::</span><span> </span><span class="hs-identifier hs-type">Bool</span><span>
</span><a name="line-167"></a><span>   </span><span class="hs-special">}</span><span> </span><span class="hs-keyword">deriving</span><span> </span><span class="hs-special">(</span><span class="hs-identifier hs-type">Eq</span><span class="hs-special">,</span><span> </span><span class="hs-identifier hs-type">Ord</span><span class="hs-special">,</span><span> </span><a href="../base-4.10.0.0/src/%{MODULE/./-}.html#%{NAME}/GHC.Read.html#Read"><span class="hs-identifier hs-type">Read</span></a><span class="hs-special">,</span><span> </span><a href="../base-4.10.0.0/src/%{MODULE/./-}.html#%{NAME}/GHC.Show.html#Show"><span class="hs-identifier hs-type">Show</span></a><span class="hs-special">)</span><span>
</span><a name="line-168"></a><span>
</span><a name="line-169"></a><span class="hs-identifier">emptyPermissions</span><span> </span><span class="hs-glyph">::</span><span> </span><a href="System.Directory.html#Permissions"><span class="hs-identifier hs-type">Permissions</span></a><span>
</span><a name="line-170"></a><a name="emptyPermissions"><a href="System.Directory.html#emptyPermissions"><span class="hs-identifier">emptyPermissions</span></a></a><span> </span><span class="hs-glyph">=</span><span> </span><a href="System.Directory.html#Permissions"><span class="hs-identifier hs-var">Permissions</span></a><span> </span><span class="hs-special">{</span><span>
</span><a name="line-171"></a><span>                       </span><span class="hs-identifier">readable</span><span>   </span><span class="hs-glyph">=</span><span> </span><span class="hs-identifier hs-var">False</span><span class="hs-special">,</span><span>
</span><a name="line-172"></a><span>                       </span><span class="hs-identifier">writable</span><span>   </span><span class="hs-glyph">=</span><span> </span><span class="hs-identifier hs-var">False</span><span class="hs-special">,</span><span>
</span><a name="line-173"></a><span>                       </span><span class="hs-identifier">executable</span><span> </span><span class="hs-glyph">=</span><span> </span><span class="hs-identifier hs-var">False</span><span class="hs-special">,</span><span>
</span><a name="line-174"></a><span>                       </span><span class="hs-identifier">searchable</span><span> </span><span class="hs-glyph">=</span><span> </span><span class="hs-identifier hs-var">False</span><span>
</span><a name="line-175"></a><span>                   </span><span class="hs-special">}</span><span>
</span><a name="line-176"></a><span>
</span><a name="line-177"></a><span class="hs-identifier">setOwnerReadable</span><span> </span><span class="hs-glyph">::</span><span> </span><span class="hs-identifier hs-type">Bool</span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><a href="System.Directory.html#Permissions"><span class="hs-identifier hs-type">Permissions</span></a><span> </span><span class="hs-glyph">-&gt;</span><span> </span><a href="System.Directory.html#Permissions"><span class="hs-identifier hs-type">Permissions</span></a><span>
</span><a name="line-178"></a><a name="setOwnerReadable"><a href="System.Directory.html#setOwnerReadable"><span class="hs-identifier">setOwnerReadable</span></a></a><span> </span><a name="local-6989586621679041331"><a href="#local-6989586621679041331"><span class="hs-identifier">b</span></a></a><span> </span><a name="local-6989586621679041332"><a href="#local-6989586621679041332"><span class="hs-identifier">p</span></a></a><span> </span><span class="hs-glyph">=</span><span> </span><a href="#local-6989586621679041332"><span class="hs-identifier hs-var">p</span></a><span> </span><span class="hs-special">{</span><span> </span><span class="hs-identifier">readable</span><span> </span><span class="hs-glyph">=</span><span> </span><a href="#local-6989586621679041331"><span class="hs-identifier hs-var">b</span></a><span> </span><span class="hs-special">}</span><span>
</span><a name="line-179"></a><span>
</span><a name="line-180"></a><span class="hs-identifier">setOwnerWritable</span><span> </span><span class="hs-glyph">::</span><span> </span><span class="hs-identifier hs-type">Bool</span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><a href="System.Directory.html#Permissions"><span class="hs-identifier hs-type">Permissions</span></a><span> </span><span class="hs-glyph">-&gt;</span><span> </span><a href="System.Directory.html#Permissions"><span class="hs-identifier hs-type">Permissions</span></a><span>
</span><a name="line-181"></a><a name="setOwnerWritable"><a href="System.Directory.html#setOwnerWritable"><span class="hs-identifier">setOwnerWritable</span></a></a><span> </span><a name="local-6989586621679041333"><a href="#local-6989586621679041333"><span class="hs-identifier">b</span></a></a><span> </span><a name="local-6989586621679041334"><a href="#local-6989586621679041334"><span class="hs-identifier">p</span></a></a><span> </span><span class="hs-glyph">=</span><span> </span><a href="#local-6989586621679041334"><span class="hs-identifier hs-var">p</span></a><span> </span><span class="hs-special">{</span><span> </span><span class="hs-identifier">writable</span><span> </span><span class="hs-glyph">=</span><span> </span><a href="#local-6989586621679041333"><span class="hs-identifier hs-var">b</span></a><span> </span><span class="hs-special">}</span><span>
</span><a name="line-182"></a><span>
</span><a name="line-183"></a><span class="hs-identifier">setOwnerExecutable</span><span> </span><span class="hs-glyph">::</span><span> </span><span class="hs-identifier hs-type">Bool</span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><a href="System.Directory.html#Permissions"><span class="hs-identifier hs-type">Permissions</span></a><span> </span><span class="hs-glyph">-&gt;</span><span> </span><a href="System.Directory.html#Permissions"><span class="hs-identifier hs-type">Permissions</span></a><span>
</span><a name="line-184"></a><a name="setOwnerExecutable"><a href="System.Directory.html#setOwnerExecutable"><span class="hs-identifier">setOwnerExecutable</span></a></a><span> </span><a name="local-6989586621679041335"><a href="#local-6989586621679041335"><span class="hs-identifier">b</span></a></a><span> </span><a name="local-6989586621679041336"><a href="#local-6989586621679041336"><span class="hs-identifier">p</span></a></a><span> </span><span class="hs-glyph">=</span><span> </span><a href="#local-6989586621679041336"><span class="hs-identifier hs-var">p</span></a><span> </span><span class="hs-special">{</span><span> </span><span class="hs-identifier">executable</span><span> </span><span class="hs-glyph">=</span><span> </span><a href="#local-6989586621679041335"><span class="hs-identifier hs-var">b</span></a><span> </span><span class="hs-special">}</span><span>
</span><a name="line-185"></a><span>
</span><a name="line-186"></a><span class="hs-identifier">setOwnerSearchable</span><span> </span><span class="hs-glyph">::</span><span> </span><span class="hs-identifier hs-type">Bool</span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><a href="System.Directory.html#Permissions"><span class="hs-identifier hs-type">Permissions</span></a><span> </span><span class="hs-glyph">-&gt;</span><span> </span><a href="System.Directory.html#Permissions"><span class="hs-identifier hs-type">Permissions</span></a><span>
</span><a name="line-187"></a><a name="setOwnerSearchable"><a href="System.Directory.html#setOwnerSearchable"><span class="hs-identifier">setOwnerSearchable</span></a></a><span> </span><a name="local-6989586621679041337"><a href="#local-6989586621679041337"><span class="hs-identifier">b</span></a></a><span> </span><a name="local-6989586621679041338"><a href="#local-6989586621679041338"><span class="hs-identifier">p</span></a></a><span> </span><span class="hs-glyph">=</span><span> </span><a href="#local-6989586621679041338"><span class="hs-identifier hs-var">p</span></a><span> </span><span class="hs-special">{</span><span> </span><span class="hs-identifier">searchable</span><span> </span><span class="hs-glyph">=</span><span> </span><a href="#local-6989586621679041337"><span class="hs-identifier hs-var">b</span></a><span> </span><span class="hs-special">}</span><span>
</span><a name="line-188"></a><span>
</span><a name="line-189"></a><span class="hs-comment">{- |The 'getPermissions' operation returns the
permissions for the file or directory.

The operation may fail with:

* 'isPermissionError' if the user is not permitted to access
  the permissions; or

* 'isDoesNotExistError' if the file or directory does not exist.

-}</span><span>
</span><a name="line-200"></a><span>
</span><a name="line-201"></a><span class="hs-identifier">getPermissions</span><span> </span><span class="hs-glyph">::</span><span> </span><a href="../base-4.10.0.0/src/%{MODULE/./-}.html#%{NAME}/GHC.IO.html#FilePath"><span class="hs-identifier hs-type">FilePath</span></a><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="hs-identifier hs-type">IO</span><span> </span><a href="System.Directory.html#Permissions"><span class="hs-identifier hs-type">Permissions</span></a><span>
</span><a name="line-202"></a><a name="getPermissions"><a href="System.Directory.html#getPermissions"><span class="hs-identifier">getPermissions</span></a></a><span> </span><a name="local-6989586621679041339"><a href="#local-6989586621679041339"><span class="hs-identifier">name</span></a></a><span> </span><span class="hs-glyph">=</span><span>
</span><a name="line-203"></a><span class="hs-cpp">#ifdef mingw32_HOST_OS</span><span>
</span><a name="line-204"></a><span>  </span><span class="hs-comment">-- issue #9: Windows doesn't like trailing path separators</span><span>
</span><a name="line-205"></a><span>  </span><span class="hs-identifier">withFilePath</span><span> </span><span class="hs-special">(</span><span class="hs-identifier">dropTrailingPathSeparator</span><span> </span><span class="hs-identifier">name</span><span class="hs-special">)</span><span> </span><span class="hs-operator">$</span><span> </span><span class="hs-glyph">\</span><span class="hs-identifier">s</span><span> </span><span class="hs-glyph">-&gt;</span><span>
</span><a name="line-206"></a><span>  </span><span class="hs-comment">-- stat() does a better job of guessing the permissions on Windows</span><span>
</span><a name="line-207"></a><span>  </span><span class="hs-comment">-- than access() does.  e.g. for execute permission, it looks at the</span><span>
</span><a name="line-208"></a><span>  </span><span class="hs-comment">-- filename extension :-)</span><span>
</span><a name="line-209"></a><span>  </span><span class="hs-comment">--</span><span>
</span><a name="line-210"></a><span>  </span><span class="hs-comment">-- I tried for a while to do this properly, using the Windows security API,</span><span>
</span><a name="line-211"></a><span>  </span><span class="hs-comment">-- and eventually gave up.  getPermissions is a flawed API anyway. -- SimonM</span><span>
</span><a name="line-212"></a><span>  </span><span class="hs-identifier">allocaBytes</span><span> </span><span class="hs-identifier">sizeof_stat</span><span> </span><span class="hs-operator">$</span><span> </span><span class="hs-glyph">\</span><span> </span><span class="hs-identifier">p_stat</span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="hs-keyword">do</span><span>
</span><a name="line-213"></a><span>  </span><span class="hs-identifier">throwErrnoIfMinus1_</span><span> </span><span class="hs-string">&quot;getPermissions&quot;</span><span> </span><span class="hs-operator">$</span><span> </span><span class="hs-identifier">c_stat</span><span> </span><span class="hs-identifier">s</span><span> </span><span class="hs-identifier">p_stat</span><span>
</span><a name="line-214"></a><span>  </span><span class="hs-identifier">mode</span><span> </span><span class="hs-glyph">&lt;-</span><span> </span><span class="hs-identifier">st_mode</span><span> </span><span class="hs-identifier">p_stat</span><span>
</span><a name="line-215"></a><span>  </span><span class="hs-keyword">let</span><span> </span><span class="hs-identifier">usr_read</span><span>   </span><span class="hs-glyph">=</span><span> </span><span class="hs-identifier">mode</span><span> </span><span class="hs-operator">.&amp;.</span><span> </span><span class="hs-identifier">s_IRUSR</span><span>
</span><a name="line-216"></a><span>  </span><span class="hs-keyword">let</span><span> </span><span class="hs-identifier">usr_write</span><span>  </span><span class="hs-glyph">=</span><span> </span><span class="hs-identifier">mode</span><span> </span><span class="hs-operator">.&amp;.</span><span> </span><span class="hs-identifier">s_IWUSR</span><span>
</span><a name="line-217"></a><span>  </span><span class="hs-keyword">let</span><span> </span><span class="hs-identifier">usr_exec</span><span>   </span><span class="hs-glyph">=</span><span> </span><span class="hs-identifier">mode</span><span> </span><span class="hs-operator">.&amp;.</span><span> </span><span class="hs-identifier">s_IXUSR</span><span>
</span><a name="line-218"></a><span>  </span><span class="hs-keyword">let</span><span> </span><span class="hs-identifier">is_dir</span><span> </span><span class="hs-glyph">=</span><span> </span><span class="hs-identifier">mode</span><span> </span><span class="hs-operator">.&amp;.</span><span> </span><span class="hs-identifier">s_IFDIR</span><span>
</span><a name="line-219"></a><span>  </span><span class="hs-identifier">return</span><span> </span><span class="hs-special">(</span><span>
</span><a name="line-220"></a><span>    </span><span class="hs-identifier">Permissions</span><span> </span><span class="hs-special">{</span><span>
</span><a name="line-221"></a><span>      </span><span class="hs-identifier">readable</span><span>   </span><span class="hs-glyph">=</span><span> </span><span class="hs-identifier">usr_read</span><span>  </span><span class="hs-operator">/=</span><span> </span><span class="hs-number">0</span><span class="hs-special">,</span><span>
</span><a name="line-222"></a><span>      </span><span class="hs-identifier">writable</span><span>   </span><span class="hs-glyph">=</span><span> </span><span class="hs-identifier">usr_write</span><span> </span><span class="hs-operator">/=</span><span> </span><span class="hs-number">0</span><span class="hs-special">,</span><span>
</span><a name="line-223"></a><span>      </span><span class="hs-identifier">executable</span><span> </span><span class="hs-glyph">=</span><span> </span><span class="hs-identifier">is_dir</span><span> </span><span class="hs-operator">==</span><span> </span><span class="hs-number">0</span><span> </span><span class="hs-operator">&amp;&amp;</span><span> </span><span class="hs-identifier">usr_exec</span><span> </span><span class="hs-operator">/=</span><span> </span><span class="hs-number">0</span><span class="hs-special">,</span><span>
</span><a name="line-224"></a><span>      </span><span class="hs-identifier">searchable</span><span> </span><span class="hs-glyph">=</span><span> </span><span class="hs-identifier">is_dir</span><span> </span><span class="hs-operator">/=</span><span> </span><span class="hs-number">0</span><span> </span><span class="hs-operator">&amp;&amp;</span><span> </span><span class="hs-identifier">usr_exec</span><span> </span><span class="hs-operator">/=</span><span> </span><span class="hs-number">0</span><span>
</span><a name="line-225"></a><span>    </span><span class="hs-special">}</span><span>
</span><a name="line-226"></a><span>   </span><span class="hs-special">)</span><span>
</span><a name="line-227"></a><span class="hs-cpp">#else</span><span>
</span><a name="line-228"></a><span>  </span><span class="hs-keyword">do</span><span>
</span><a name="line-229"></a><span>  </span><a name="local-6989586621679041476"><a href="#local-6989586621679041476"><span class="hs-identifier">read_ok</span></a></a><span>  </span><span class="hs-glyph">&lt;-</span><span> </span><a href="../unix-2.7.2.1/src/%{MODULE/./-}.html#%{NAME}/System.Posix.Files.html#fileAccess"><span class="hs-identifier hs-var">Posix</span><span class="hs-operator hs-var">.</span><span class="hs-identifier hs-var">fileAccess</span></a><span> </span><a href="#local-6989586621679041339"><span class="hs-identifier hs-var">name</span></a><span> </span><span class="hs-identifier hs-var">True</span><span>  </span><span class="hs-identifier hs-var">False</span><span> </span><span class="hs-identifier hs-var">False</span><span>
</span><a name="line-230"></a><span>  </span><a name="local-6989586621679041477"><a href="#local-6989586621679041477"><span class="hs-identifier">write_ok</span></a></a><span> </span><span class="hs-glyph">&lt;-</span><span> </span><a href="../unix-2.7.2.1/src/%{MODULE/./-}.html#%{NAME}/System.Posix.Files.html#fileAccess"><span class="hs-identifier hs-var">Posix</span><span class="hs-operator hs-var">.</span><span class="hs-identifier hs-var">fileAccess</span></a><span> </span><a href="#local-6989586621679041339"><span class="hs-identifier hs-var">name</span></a><span> </span><span class="hs-identifier hs-var">False</span><span> </span><span class="hs-identifier hs-var">True</span><span>  </span><span class="hs-identifier hs-var">False</span><span>
</span><a name="line-231"></a><span>  </span><a name="local-6989586621679041478"><a href="#local-6989586621679041478"><span class="hs-identifier">exec_ok</span></a></a><span>  </span><span class="hs-glyph">&lt;-</span><span> </span><a href="../unix-2.7.2.1/src/%{MODULE/./-}.html#%{NAME}/System.Posix.Files.html#fileAccess"><span class="hs-identifier hs-var">Posix</span><span class="hs-operator hs-var">.</span><span class="hs-identifier hs-var">fileAccess</span></a><span> </span><a href="#local-6989586621679041339"><span class="hs-identifier hs-var">name</span></a><span> </span><span class="hs-identifier hs-var">False</span><span> </span><span class="hs-identifier hs-var">False</span><span> </span><span class="hs-identifier hs-var">True</span><span>
</span><a name="line-232"></a><span>  </span><a name="local-6989586621679041479"><a href="#local-6989586621679041479"><span class="hs-identifier">stat</span></a></a><span> </span><span class="hs-glyph">&lt;-</span><span> </span><a href="../unix-2.7.2.1/src/%{MODULE/./-}.html#%{NAME}/System.Posix.Files.html#getFileStatus"><span class="hs-identifier hs-var">Posix</span><span class="hs-operator hs-var">.</span><span class="hs-identifier hs-var">getFileStatus</span></a><span> </span><a href="#local-6989586621679041339"><span class="hs-identifier hs-var">name</span></a><span>
</span><a name="line-233"></a><span>  </span><span class="hs-keyword">let</span><span> </span><a name="local-6989586621679041480"><a href="#local-6989586621679041480"><span class="hs-identifier">is_dir</span></a></a><span> </span><span class="hs-glyph">=</span><span> </span><a href="../unix-2.7.2.1/src/%{MODULE/./-}.html#%{NAME}/System.Posix.Files.Common.html#isDirectory"><span class="hs-identifier hs-var">Posix</span><span class="hs-operator hs-var">.</span><span class="hs-identifier hs-var">isDirectory</span></a><span> </span><a href="#local-6989586621679041479"><span class="hs-identifier hs-var">stat</span></a><span>
</span><a name="line-234"></a><span>  </span><a href="../base-4.10.0.0/src/%{MODULE/./-}.html#%{NAME}/GHC.Base.html#return"><span class="hs-identifier hs-var">return</span></a><span> </span><span class="hs-special">(</span><span>
</span><a name="line-235"></a><span>    </span><a href="System.Directory.html#Permissions"><span class="hs-identifier hs-var">Permissions</span></a><span> </span><span class="hs-special">{</span><span>
</span><a name="line-236"></a><span>      </span><span class="hs-identifier">readable</span><span>   </span><span class="hs-glyph">=</span><span> </span><a href="#local-6989586621679041476"><span class="hs-identifier hs-var">read_ok</span></a><span class="hs-special">,</span><span>
</span><a name="line-237"></a><span>      </span><span class="hs-identifier">writable</span><span>   </span><span class="hs-glyph">=</span><span> </span><a href="#local-6989586621679041477"><span class="hs-identifier hs-var">write_ok</span></a><span class="hs-special">,</span><span>
</span><a name="line-238"></a><span>      </span><span class="hs-identifier">executable</span><span> </span><span class="hs-glyph">=</span><span> </span><span class="hs-identifier hs-var">not</span><span> </span><a href="#local-6989586621679041480"><span class="hs-identifier hs-var">is_dir</span></a><span> </span><span class="hs-operator hs-var">&amp;&amp;</span><span> </span><a href="#local-6989586621679041478"><span class="hs-identifier hs-var">exec_ok</span></a><span class="hs-special">,</span><span>
</span><a name="line-239"></a><span>      </span><span class="hs-identifier">searchable</span><span> </span><span class="hs-glyph">=</span><span> </span><a href="#local-6989586621679041480"><span class="hs-identifier hs-var">is_dir</span></a><span> </span><span class="hs-operator hs-var">&amp;&amp;</span><span> </span><a href="#local-6989586621679041478"><span class="hs-identifier hs-var">exec_ok</span></a><span>
</span><a name="line-240"></a><span>    </span><span class="hs-special">}</span><span>
</span><a name="line-241"></a><span>   </span><span class="hs-special">)</span><span>
</span><a name="line-242"></a><span class="hs-cpp">#endif</span><span>
</span><a name="line-243"></a><span>
</span><a name="line-244"></a><span class="hs-comment">{- |The 'setPermissions' operation sets the
permissions for the file or directory.

The operation may fail with:

* 'isPermissionError' if the user is not permitted to set
  the permissions; or

* 'isDoesNotExistError' if the file or directory does not exist.

-}</span><span>
</span><a name="line-255"></a><span>
</span><a name="line-256"></a><span class="hs-identifier">setPermissions</span><span> </span><span class="hs-glyph">::</span><span> </span><a href="../base-4.10.0.0/src/%{MODULE/./-}.html#%{NAME}/GHC.IO.html#FilePath"><span class="hs-identifier hs-type">FilePath</span></a><span> </span><span class="hs-glyph">-&gt;</span><span> </span><a href="System.Directory.html#Permissions"><span class="hs-identifier hs-type">Permissions</span></a><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="hs-identifier hs-type">IO</span><span> </span><span class="hs-special">(</span><span class="hs-special">)</span><span>
</span><a name="line-257"></a><a name="setPermissions"><a href="System.Directory.html#setPermissions"><span class="hs-identifier">setPermissions</span></a></a><span> </span><a name="local-6989586621679041481"><a href="#local-6989586621679041481"><span class="hs-identifier">name</span></a></a><span> </span><span class="hs-special">(</span><a href="System.Directory.html#Permissions"><span class="hs-identifier hs-var">Permissions</span></a><span> </span><a name="local-6989586621679041482"><a href="#local-6989586621679041482"><span class="hs-identifier">r</span></a></a><span> </span><a name="local-6989586621679041483"><a href="#local-6989586621679041483"><span class="hs-identifier">w</span></a></a><span> </span><a name="local-6989586621679041484"><a href="#local-6989586621679041484"><span class="hs-identifier">e</span></a></a><span> </span><a name="local-6989586621679041485"><a href="#local-6989586621679041485"><span class="hs-identifier">s</span></a></a><span class="hs-special">)</span><span> </span><span class="hs-glyph">=</span><span>
</span><a name="line-258"></a><span class="hs-cpp">#ifdef mingw32_HOST_OS</span><span>
</span><a name="line-259"></a><span>  </span><span class="hs-identifier">allocaBytes</span><span> </span><span class="hs-identifier">sizeof_stat</span><span> </span><span class="hs-operator">$</span><span> </span><span class="hs-glyph">\</span><span> </span><span class="hs-identifier">p_stat</span><span> </span><span class="hs-glyph">-&gt;</span><span>
</span><a name="line-260"></a><span>  </span><span class="hs-identifier">withFilePath</span><span> </span><span class="hs-identifier">name</span><span> </span><span class="hs-operator">$</span><span> </span><span class="hs-glyph">\</span><span class="hs-identifier">p_name</span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="hs-keyword">do</span><span>
</span><a name="line-261"></a><span>    </span><span class="hs-identifier">throwErrnoIfMinus1_</span><span> </span><span class="hs-string">&quot;setPermissions&quot;</span><span> </span><span class="hs-operator">$</span><span>
</span><a name="line-262"></a><span>      </span><span class="hs-identifier">c_stat</span><span> </span><span class="hs-identifier">p_name</span><span> </span><span class="hs-identifier">p_stat</span><span>
</span><a name="line-263"></a><span>
</span><a name="line-264"></a><span>    </span><span class="hs-identifier">throwErrnoIfMinus1_</span><span> </span><span class="hs-string">&quot;setPermissions&quot;</span><span> </span><span class="hs-operator">$</span><span> </span><span class="hs-keyword">do</span><span>
</span><a name="line-265"></a><span>      </span><span class="hs-identifier">mode</span><span> </span><span class="hs-glyph">&lt;-</span><span> </span><span class="hs-identifier">st_mode</span><span> </span><span class="hs-identifier">p_stat</span><span>
</span><a name="line-266"></a><span>      </span><span class="hs-keyword">let</span><span> </span><span class="hs-identifier">mode1</span><span> </span><span class="hs-glyph">=</span><span> </span><span class="hs-identifier">modifyBit</span><span> </span><span class="hs-identifier">r</span><span> </span><span class="hs-identifier">mode</span><span> </span><span class="hs-identifier">s_IRUSR</span><span>
</span><a name="line-267"></a><span>      </span><span class="hs-keyword">let</span><span> </span><span class="hs-identifier">mode2</span><span> </span><span class="hs-glyph">=</span><span> </span><span class="hs-identifier">modifyBit</span><span> </span><span class="hs-identifier">w</span><span> </span><span class="hs-identifier">mode1</span><span> </span><span class="hs-identifier">s_IWUSR</span><span>
</span><a name="line-268"></a><span>      </span><span class="hs-keyword">let</span><span> </span><span class="hs-identifier">mode3</span><span> </span><span class="hs-glyph">=</span><span> </span><span class="hs-identifier">modifyBit</span><span> </span><span class="hs-special">(</span><span class="hs-identifier">e</span><span> </span><span class="hs-operator">||</span><span> </span><span class="hs-identifier">s</span><span class="hs-special">)</span><span> </span><span class="hs-identifier">mode2</span><span> </span><span class="hs-identifier">s_IXUSR</span><span>
</span><a name="line-269"></a><span>      </span><span class="hs-identifier">c_wchmod</span><span> </span><span class="hs-identifier">p_name</span><span> </span><span class="hs-identifier">mode3</span><span>
</span><a name="line-270"></a><span> </span><span class="hs-keyword">where</span><span>
</span><a name="line-271"></a><span>   </span><span class="hs-identifier">modifyBit</span><span> </span><span class="hs-glyph">::</span><span> </span><span class="hs-identifier">Bool</span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="hs-identifier">CMode</span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="hs-identifier">CMode</span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="hs-identifier">CMode</span><span>
</span><a name="line-272"></a><span>   </span><span class="hs-identifier">modifyBit</span><span> </span><span class="hs-identifier">False</span><span> </span><span class="hs-identifier">m</span><span> </span><span class="hs-identifier">b</span><span> </span><span class="hs-glyph">=</span><span> </span><span class="hs-identifier">m</span><span> </span><span class="hs-operator">.&amp;.</span><span> </span><span class="hs-special">(</span><span class="hs-identifier">complement</span><span> </span><span class="hs-identifier">b</span><span class="hs-special">)</span><span>
</span><a name="line-273"></a><span>   </span><span class="hs-identifier">modifyBit</span><span> </span><span class="hs-identifier">True</span><span>  </span><span class="hs-identifier">m</span><span> </span><span class="hs-identifier">b</span><span> </span><span class="hs-glyph">=</span><span> </span><span class="hs-identifier">m</span><span> </span><span class="hs-operator">.|.</span><span> </span><span class="hs-identifier">b</span><span>
</span><a name="line-274"></a><span class="hs-cpp">#else</span><span>
</span><a name="line-275"></a><span>  </span><span class="hs-keyword">do</span><span>
</span><a name="line-276"></a><span>      </span><a name="local-6989586621679041491"><a href="#local-6989586621679041491"><span class="hs-identifier">stat</span></a></a><span> </span><span class="hs-glyph">&lt;-</span><span> </span><a href="../unix-2.7.2.1/src/%{MODULE/./-}.html#%{NAME}/System.Posix.Files.html#getFileStatus"><span class="hs-identifier hs-var">Posix</span><span class="hs-operator hs-var">.</span><span class="hs-identifier hs-var">getFileStatus</span></a><span> </span><a href="#local-6989586621679041481"><span class="hs-identifier hs-var">name</span></a><span>
</span><a name="line-277"></a><span>      </span><span class="hs-keyword">let</span><span> </span><a name="local-6989586621679041492"><a href="#local-6989586621679041492"><span class="hs-identifier">mode</span></a></a><span> </span><span class="hs-glyph">=</span><span> </span><a href="../unix-2.7.2.1/src/%{MODULE/./-}.html#%{NAME}/System.Posix.Files.Common.html#fileMode"><span class="hs-identifier hs-var">Posix</span><span class="hs-operator hs-var">.</span><span class="hs-identifier hs-var">fileMode</span></a><span> </span><a href="#local-6989586621679041491"><span class="hs-identifier hs-var">stat</span></a><span>
</span><a name="line-278"></a><span>      </span><span class="hs-keyword">let</span><span> </span><a name="local-6989586621679041493"><a href="#local-6989586621679041493"><span class="hs-identifier">mode1</span></a></a><span> </span><span class="hs-glyph">=</span><span> </span><a href="#local-6989586621679041486"><span class="hs-identifier hs-var">modifyBit</span></a><span> </span><a href="#local-6989586621679041482"><span class="hs-identifier hs-var">r</span></a><span> </span><a href="#local-6989586621679041492"><span class="hs-identifier hs-var">mode</span></a><span>  </span><a href="../unix-2.7.2.1/src/%{MODULE/./-}.html#%{NAME}/System.Posix.Files.Common.html#ownerReadMode"><span class="hs-identifier hs-var">Posix</span><span class="hs-operator hs-var">.</span><span class="hs-identifier hs-var">ownerReadMode</span></a><span>
</span><a name="line-279"></a><span>      </span><span class="hs-keyword">let</span><span> </span><a name="local-6989586621679041494"><a href="#local-6989586621679041494"><span class="hs-identifier">mode2</span></a></a><span> </span><span class="hs-glyph">=</span><span> </span><a href="#local-6989586621679041486"><span class="hs-identifier hs-var">modifyBit</span></a><span> </span><a href="#local-6989586621679041483"><span class="hs-identifier hs-var">w</span></a><span> </span><a href="#local-6989586621679041493"><span class="hs-identifier hs-var">mode1</span></a><span> </span><a href="../unix-2.7.2.1/src/%{MODULE/./-}.html#%{NAME}/System.Posix.Files.Common.html#ownerWriteMode"><span class="hs-identifier hs-var">Posix</span><span class="hs-operator hs-var">.</span><span class="hs-identifier hs-var">ownerWriteMode</span></a><span>
</span><a name="line-280"></a><span>      </span><span class="hs-keyword">let</span><span> </span><a name="local-6989586621679041495"><a href="#local-6989586621679041495"><span class="hs-identifier">mode3</span></a></a><span> </span><span class="hs-glyph">=</span><span> </span><a href="#local-6989586621679041486"><span class="hs-identifier hs-var">modifyBit</span></a><span> </span><span class="hs-special">(</span><a href="#local-6989586621679041484"><span class="hs-identifier hs-var">e</span></a><span> </span><span class="hs-operator hs-var">||</span><span> </span><a href="#local-6989586621679041485"><span class="hs-identifier hs-var">s</span></a><span class="hs-special">)</span><span> </span><a href="#local-6989586621679041494"><span class="hs-identifier hs-var">mode2</span></a><span> </span><a href="../unix-2.7.2.1/src/%{MODULE/./-}.html#%{NAME}/System.Posix.Files.Common.html#ownerExecuteMode"><span class="hs-identifier hs-var">Posix</span><span class="hs-operator hs-var">.</span><span class="hs-identifier hs-var">ownerExecuteMode</span></a><span>
</span><a name="line-281"></a><span>      </span><a href="../unix-2.7.2.1/src/%{MODULE/./-}.html#%{NAME}/System.Posix.Files.html#setFileMode"><span class="hs-identifier hs-var">Posix</span><span class="hs-operator hs-var">.</span><span class="hs-identifier hs-var">setFileMode</span></a><span> </span><a href="#local-6989586621679041481"><span class="hs-identifier hs-var">name</span></a><span> </span><a href="#local-6989586621679041495"><span class="hs-identifier hs-var">mode3</span></a><span>
</span><a name="line-282"></a><span> </span><span class="hs-keyword">where</span><span>
</span><a name="line-283"></a><span>   </span><span class="hs-identifier">modifyBit</span><span> </span><span class="hs-glyph">::</span><span> </span><span class="hs-identifier hs-type">Bool</span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><a href="../base-4.10.0.0/src/%{MODULE/./-}.html#%{NAME}/System.Posix.Types.html#FileMode"><span class="hs-identifier hs-type">FileMode</span></a><span> </span><span class="hs-glyph">-&gt;</span><span> </span><a href="../base-4.10.0.0/src/%{MODULE/./-}.html#%{NAME}/System.Posix.Types.html#FileMode"><span class="hs-identifier hs-type">FileMode</span></a><span> </span><span class="hs-glyph">-&gt;</span><span> </span><a href="../base-4.10.0.0/src/%{MODULE/./-}.html#%{NAME}/System.Posix.Types.html#FileMode"><span class="hs-identifier hs-type">FileMode</span></a><span>
</span><a name="line-284"></a><span>   </span><a name="local-6989586621679041486"><a href="#local-6989586621679041486"><span class="hs-identifier">modifyBit</span></a></a><span> </span><span class="hs-identifier hs-var">False</span><span> </span><a name="local-6989586621679041487"><a href="#local-6989586621679041487"><span class="hs-identifier">m</span></a></a><span> </span><a name="local-6989586621679041488"><a href="#local-6989586621679041488"><span class="hs-identifier">b</span></a></a><span> </span><span class="hs-glyph">=</span><span> </span><a href="#local-6989586621679041487"><span class="hs-identifier hs-var">m</span></a><span> </span><a href="../base-4.10.0.0/src/%{MODULE/./-}.html#%{NAME}/Data.Bits.html#.%26."><span class="hs-operator hs-var">.&amp;.</span></a><span> </span><span class="hs-special">(</span><a href="../base-4.10.0.0/src/%{MODULE/./-}.html#%{NAME}/Data.Bits.html#complement"><span class="hs-identifier hs-var">complement</span></a><span> </span><a href="#local-6989586621679041488"><span class="hs-identifier hs-var">b</span></a><span class="hs-special">)</span><span>
</span><a name="line-285"></a><span>   </span><span class="hs-identifier">modifyBit</span><span> </span><span class="hs-identifier hs-var">True</span><span>  </span><a name="local-6989586621679041489"><a href="#local-6989586621679041489"><span class="hs-identifier">m</span></a></a><span> </span><a name="local-6989586621679041490"><a href="#local-6989586621679041490"><span class="hs-identifier">b</span></a></a><span> </span><span class="hs-glyph">=</span><span> </span><a href="#local-6989586621679041489"><span class="hs-identifier hs-var">m</span></a><span> </span><a href="../base-4.10.0.0/src/%{MODULE/./-}.html#%{NAME}/Data.Bits.html#.%7C."><span class="hs-operator hs-var">.|.</span></a><span> </span><a href="#local-6989586621679041490"><span class="hs-identifier hs-var">b</span></a><span>
</span><a name="line-286"></a><span class="hs-cpp">#endif</span><span>
</span><a name="line-287"></a><span>
</span><a name="line-288"></a><span class="hs-identifier">copyPermissions</span><span> </span><span class="hs-glyph">::</span><span> </span><a href="../base-4.10.0.0/src/%{MODULE/./-}.html#%{NAME}/GHC.IO.html#FilePath"><span class="hs-identifier hs-type">FilePath</span></a><span> </span><span class="hs-glyph">-&gt;</span><span> </span><a href="../base-4.10.0.0/src/%{MODULE/./-}.html#%{NAME}/GHC.IO.html#FilePath"><span class="hs-identifier hs-type">FilePath</span></a><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="hs-identifier hs-type">IO</span><span> </span><span class="hs-special">(</span><span class="hs-special">)</span><span>
</span><a name="line-289"></a><a name="copyPermissions"><a href="System.Directory.html#copyPermissions"><span class="hs-identifier">copyPermissions</span></a></a><span> </span><a name="local-6989586621679041496"><a href="#local-6989586621679041496"><span class="hs-identifier">source</span></a></a><span> </span><a name="local-6989586621679041497"><a href="#local-6989586621679041497"><span class="hs-identifier">dest</span></a></a><span> </span><span class="hs-glyph">=</span><span>
</span><a name="line-290"></a><span class="hs-cpp">#ifdef mingw32_HOST_OS</span><span>
</span><a name="line-291"></a><span>  </span><span class="hs-identifier">allocaBytes</span><span> </span><span class="hs-identifier">sizeof_stat</span><span> </span><span class="hs-operator">$</span><span> </span><span class="hs-glyph">\</span><span> </span><span class="hs-identifier">p_stat</span><span> </span><span class="hs-glyph">-&gt;</span><span>
</span><a name="line-292"></a><span>  </span><span class="hs-identifier">withFilePath</span><span> </span><span class="hs-identifier">source</span><span> </span><span class="hs-operator">$</span><span> </span><span class="hs-glyph">\</span><span class="hs-identifier">p_source</span><span> </span><span class="hs-glyph">-&gt;</span><span>
</span><a name="line-293"></a><span>  </span><span class="hs-identifier">withFilePath</span><span> </span><span class="hs-identifier">dest</span><span> </span><span class="hs-operator">$</span><span> </span><span class="hs-glyph">\</span><span class="hs-identifier">p_dest</span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="hs-keyword">do</span><span>
</span><a name="line-294"></a><span>    </span><span class="hs-identifier">throwErrnoIfMinus1_</span><span> </span><span class="hs-string">&quot;copyPermissions&quot;</span><span> </span><span class="hs-operator">$</span><span> </span><span class="hs-identifier">c_stat</span><span> </span><span class="hs-identifier">p_source</span><span> </span><span class="hs-identifier">p_stat</span><span>
</span><a name="line-295"></a><span>    </span><span class="hs-identifier">mode</span><span> </span><span class="hs-glyph">&lt;-</span><span> </span><span class="hs-identifier">st_mode</span><span> </span><span class="hs-identifier">p_stat</span><span>
</span><a name="line-296"></a><span>    </span><span class="hs-identifier">throwErrnoIfMinus1_</span><span> </span><span class="hs-string">&quot;copyPermissions&quot;</span><span> </span><span class="hs-operator">$</span><span> </span><span class="hs-identifier">c_wchmod</span><span> </span><span class="hs-identifier">p_dest</span><span> </span><span class="hs-identifier">mode</span><span>
</span><a name="line-297"></a><span class="hs-cpp">#else</span><span>
</span><a name="line-298"></a><span>  </span><span class="hs-keyword">do</span><span>
</span><a name="line-299"></a><span>  </span><a name="local-6989586621679041498"><a href="#local-6989586621679041498"><span class="hs-identifier">stat</span></a></a><span> </span><span class="hs-glyph">&lt;-</span><span> </span><a href="../unix-2.7.2.1/src/%{MODULE/./-}.html#%{NAME}/System.Posix.Files.html#getFileStatus"><span class="hs-identifier hs-var">Posix</span><span class="hs-operator hs-var">.</span><span class="hs-identifier hs-var">getFileStatus</span></a><span> </span><a href="#local-6989586621679041496"><span class="hs-identifier hs-var">source</span></a><span>
</span><a name="line-300"></a><span>  </span><a href="System.Directory.html#copyPermissionsFromStatus"><span class="hs-identifier hs-var">copyPermissionsFromStatus</span></a><span> </span><a href="#local-6989586621679041498"><span class="hs-identifier hs-var">stat</span></a><span> </span><a href="#local-6989586621679041497"><span class="hs-identifier hs-var">dest</span></a><span>
</span><a name="line-301"></a><span class="hs-cpp">#endif</span><span>
</span><a name="line-302"></a><span>
</span><a name="line-303"></a><span class="hs-cpp">#ifndef mingw32_HOST_OS</span><span>
</span><a name="line-304"></a><span class="hs-identifier">copyPermissionsFromStatus</span><span> </span><span class="hs-glyph">::</span><span> </span><a href="../unix-2.7.2.1/src/%{MODULE/./-}.html#%{NAME}/System.Posix.Files.Common.html#FileStatus"><span class="hs-identifier hs-type">Posix</span><span class="hs-operator hs-type">.</span><span class="hs-identifier hs-type">FileStatus</span></a><span> </span><span class="hs-glyph">-&gt;</span><span> </span><a href="../base-4.10.0.0/src/%{MODULE/./-}.html#%{NAME}/GHC.IO.html#FilePath"><span class="hs-identifier hs-type">FilePath</span></a><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="hs-identifier hs-type">IO</span><span> </span><span class="hs-special">(</span><span class="hs-special">)</span><span>
</span><a name="line-305"></a><a name="copyPermissionsFromStatus"><a href="System.Directory.html#copyPermissionsFromStatus"><span class="hs-identifier">copyPermissionsFromStatus</span></a></a><span> </span><a name="local-6989586621679041499"><a href="#local-6989586621679041499"><span class="hs-identifier">st</span></a></a><span> </span><a name="local-6989586621679041500"><a href="#local-6989586621679041500"><span class="hs-identifier">dst</span></a></a><span> </span><span class="hs-glyph">=</span><span> </span><span class="hs-keyword">do</span><span>
</span><a name="line-306"></a><span>  </span><a href="../unix-2.7.2.1/src/%{MODULE/./-}.html#%{NAME}/System.Posix.Files.html#setFileMode"><span class="hs-identifier hs-var">Posix</span><span class="hs-operator hs-var">.</span><span class="hs-identifier hs-var">setFileMode</span></a><span> </span><a href="#local-6989586621679041500"><span class="hs-identifier hs-var">dst</span></a><span> </span><span class="hs-special">(</span><a href="../unix-2.7.2.1/src/%{MODULE/./-}.html#%{NAME}/System.Posix.Files.Common.html#fileMode"><span class="hs-identifier hs-var">Posix</span><span class="hs-operator hs-var">.</span><span class="hs-identifier hs-var">fileMode</span></a><span> </span><a href="#local-6989586621679041499"><span class="hs-identifier hs-var">st</span></a><span class="hs-special">)</span><span>
</span><a name="line-307"></a><span class="hs-cpp">#endif</span><span>
</span><a name="line-308"></a><span>
</span><a name="line-309"></a><span class="hs-comment">-----------------------------------------------------------------------------</span><span>
</span><a name="line-310"></a><span class="hs-comment">-- Implementation</span><span>
</span><a name="line-311"></a><span>
</span><a name="line-312"></a><span class="hs-comment">{- |@'createDirectory' dir@ creates a new directory @dir@ which is
initially empty, or as near to empty as the operating system
allows.

The operation may fail with:

* 'isPermissionError' \/ 'PermissionDenied'
The process has insufficient privileges to perform the operation.
@[EROFS, EACCES]@

* 'isAlreadyExistsError' \/ 'AlreadyExists'
The operand refers to a directory that already exists.
@ [EEXIST]@

* 'HardwareFault'
A physical I\/O error has occurred.
@[EIO]@

* 'InvalidArgument'
The operand is not a valid directory name.
@[ENAMETOOLONG, ELOOP]@

* 'NoSuchThing'
There is no path to the directory.
@[ENOENT, ENOTDIR]@

* 'ResourceExhausted'
Insufficient resources (virtual memory, process file descriptors,
physical disk space, etc.) are available to perform the operation.
@[EDQUOT, ENOSPC, ENOMEM, EMLINK]@

* 'InappropriateType'
The path refers to an existing non-directory object.
@[EEXIST]@

-}</span><span>
</span><a name="line-348"></a><span>
</span><a name="line-349"></a><span class="hs-identifier">createDirectory</span><span> </span><span class="hs-glyph">::</span><span> </span><a href="../base-4.10.0.0/src/%{MODULE/./-}.html#%{NAME}/GHC.IO.html#FilePath"><span class="hs-identifier hs-type">FilePath</span></a><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="hs-identifier hs-type">IO</span><span> </span><span class="hs-special">(</span><span class="hs-special">)</span><span>
</span><a name="line-350"></a><a name="createDirectory"><a href="System.Directory.html#createDirectory"><span class="hs-identifier">createDirectory</span></a></a><span> </span><a name="local-6989586621679041501"><a href="#local-6989586621679041501"><span class="hs-identifier">path</span></a></a><span> </span><span class="hs-glyph">=</span><span> </span><span class="hs-keyword">do</span><span>
</span><a name="line-351"></a><span class="hs-cpp">#ifdef mingw32_HOST_OS</span><span>
</span><a name="line-352"></a><span>  </span><span class="hs-identifier">Win32</span><span class="hs-operator">.</span><span class="hs-identifier">createDirectory</span><span> </span><span class="hs-identifier">path</span><span> </span><span class="hs-identifier">Nothing</span><span>
</span><a name="line-353"></a><span class="hs-cpp">#else</span><span>
</span><a name="line-354"></a><span>  </span><a href="../unix-2.7.2.1/src/%{MODULE/./-}.html#%{NAME}/System.Posix.Directory.html#createDirectory"><span class="hs-identifier hs-var">Posix</span><span class="hs-operator hs-var">.</span><span class="hs-identifier hs-var">createDirectory</span></a><span> </span><a href="#local-6989586621679041501"><span class="hs-identifier hs-var">path</span></a><span> </span><span class="hs-number">0o777</span><span>
</span><a name="line-355"></a><span class="hs-cpp">#endif</span><span>
</span><a name="line-356"></a><span>
</span><a name="line-357"></a><span class="hs-comment">-- | @'createDirectoryIfMissing' parents dir@ creates a new directory</span><span>
</span><a name="line-358"></a><span class="hs-comment">-- @dir@ if it doesn\'t exist. If the first argument is 'True'</span><span>
</span><a name="line-359"></a><span class="hs-comment">-- the function will also create all parent directories if they are missing.</span><span>
</span><a name="line-360"></a><span class="hs-identifier">createDirectoryIfMissing</span><span> </span><span class="hs-glyph">::</span><span> </span><span class="hs-identifier hs-type">Bool</span><span>     </span><span class="hs-comment">-- ^ Create its parents too?</span><span>
</span><a name="line-361"></a><span>                         </span><span class="hs-glyph">-&gt;</span><span> </span><a href="../base-4.10.0.0/src/%{MODULE/./-}.html#%{NAME}/GHC.IO.html#FilePath"><span class="hs-identifier hs-type">FilePath</span></a><span> </span><span class="hs-comment">-- ^ The path to the directory you want to make</span><span>
</span><a name="line-362"></a><span>                         </span><span class="hs-glyph">-&gt;</span><span> </span><span class="hs-identifier hs-type">IO</span><span> </span><span class="hs-special">(</span><span class="hs-special">)</span><span>
</span><a name="line-363"></a><a name="createDirectoryIfMissing"><a href="System.Directory.html#createDirectoryIfMissing"><span class="hs-identifier">createDirectoryIfMissing</span></a></a><span> </span><a name="local-6989586621679041566"><a href="#local-6989586621679041566"><span class="hs-identifier">create_parents</span></a></a><span> </span><a name="local-6989586621679041567"><a href="#local-6989586621679041567"><span class="hs-identifier">path0</span></a></a><span>
</span><a name="line-364"></a><span>  </span><span class="hs-glyph">|</span><span> </span><a href="#local-6989586621679041566"><span class="hs-identifier hs-var">create_parents</span></a><span> </span><span class="hs-glyph">=</span><span> </span><a href="#local-6989586621679041569"><span class="hs-identifier hs-var">createDirs</span></a><span> </span><span class="hs-special">(</span><a href="#local-6989586621679041568"><span class="hs-identifier hs-var">parents</span></a><span> </span><a href="#local-6989586621679041567"><span class="hs-identifier hs-var">path0</span></a><span class="hs-special">)</span><span>
</span><a name="line-365"></a><span>  </span><span class="hs-glyph">|</span><span> </span><a href="../base-4.10.0.0/src/%{MODULE/./-}.html#%{NAME}/GHC.Base.html#otherwise"><span class="hs-identifier hs-var">otherwise</span></a><span>      </span><span class="hs-glyph">=</span><span> </span><a href="#local-6989586621679041569"><span class="hs-identifier hs-var">createDirs</span></a><span> </span><span class="hs-special">(</span><a href="../base-4.10.0.0/src/%{MODULE/./-}.html#%{NAME}/GHC.List.html#take"><span class="hs-identifier hs-var">take</span></a><span> </span><span class="hs-number">1</span><span> </span><span class="hs-special">(</span><a href="#local-6989586621679041568"><span class="hs-identifier hs-var">parents</span></a><span> </span><a href="#local-6989586621679041567"><span class="hs-identifier hs-var">path0</span></a><span class="hs-special">)</span><span class="hs-special">)</span><span>
</span><a name="line-366"></a><span>  </span><span class="hs-keyword">where</span><span>
</span><a name="line-367"></a><span>    </span><a name="local-6989586621679041568"><a href="#local-6989586621679041568"><span class="hs-identifier">parents</span></a></a><span> </span><span class="hs-glyph">=</span><span> </span><a href="../base-4.10.0.0/src/%{MODULE/./-}.html#%{NAME}/GHC.List.html#reverse"><span class="hs-identifier hs-var">reverse</span></a><span> </span><a href="../base-4.10.0.0/src/%{MODULE/./-}.html#%{NAME}/GHC.Base.html#."><span class="hs-operator hs-var">.</span></a><span> </span><a href="../base-4.10.0.0/src/%{MODULE/./-}.html#%{NAME}/GHC.List.html#scanl1"><span class="hs-identifier hs-var">scanl1</span></a><span> </span><span class="hs-special">(</span><a href="../filepath-1.4.1.1/src/%{MODULE/./-}.html#%{NAME}/System.FilePath.Posix.html#%3C%2F%3E"><span class="hs-operator hs-var">&lt;/&gt;</span></a><span class="hs-special">)</span><span> </span><a href="../base-4.10.0.0/src/%{MODULE/./-}.html#%{NAME}/GHC.Base.html#."><span class="hs-operator hs-var">.</span></a><span> </span><a href="../filepath-1.4.1.1/src/%{MODULE/./-}.html#%{NAME}/System.FilePath.Posix.html#splitDirectories"><span class="hs-identifier hs-var">splitDirectories</span></a><span> </span><a href="../base-4.10.0.0/src/%{MODULE/./-}.html#%{NAME}/GHC.Base.html#."><span class="hs-operator hs-var">.</span></a><span> </span><a href="../filepath-1.4.1.1/src/%{MODULE/./-}.html#%{NAME}/System.FilePath.Posix.html#normalise"><span class="hs-identifier hs-var">normalise</span></a><span>
</span><a name="line-368"></a><span>
</span><a name="line-369"></a><span>    </span><a name="local-6989586621679041569"><a href="#local-6989586621679041569"><span class="hs-identifier">createDirs</span></a></a><span> </span><span class="hs-special">[</span><span class="hs-special">]</span><span>         </span><span class="hs-glyph">=</span><span> </span><a href="../base-4.10.0.0/src/%{MODULE/./-}.html#%{NAME}/GHC.Base.html#return"><span class="hs-identifier hs-var">return</span></a><span> </span><span class="hs-special">(</span><span class="hs-special">)</span><span>
</span><a name="line-370"></a><span>    </span><span class="hs-identifier">createDirs</span><span> </span><span class="hs-special">(</span><a name="local-6989586621679041851"><a href="#local-6989586621679041851"><span class="hs-identifier">dir</span></a></a><span class="hs-glyph">:</span><span class="hs-special">[</span><span class="hs-special">]</span><span class="hs-special">)</span><span>   </span><span class="hs-glyph">=</span><span> </span><a href="#local-6989586621679041570"><span class="hs-identifier hs-var">createDir</span></a><span> </span><a href="#local-6989586621679041851"><span class="hs-identifier hs-var">dir</span></a><span> </span><a href="../base-4.10.0.0/src/%{MODULE/./-}.html#%{NAME}/GHC.IO.Exception.html#ioError"><span class="hs-identifier hs-var">ioError</span></a><span>
</span><a name="line-371"></a><span>    </span><span class="hs-identifier">createDirs</span><span> </span><span class="hs-special">(</span><a name="local-6989586621679041852"><a href="#local-6989586621679041852"><span class="hs-identifier">dir</span></a></a><span class="hs-glyph">:</span><a name="local-6989586621679041853"><a href="#local-6989586621679041853"><span class="hs-identifier">dirs</span></a></a><span class="hs-special">)</span><span> </span><span class="hs-glyph">=</span><span>
</span><a name="line-372"></a><span>      </span><a href="#local-6989586621679041570"><span class="hs-identifier hs-var">createDir</span></a><span> </span><a href="#local-6989586621679041852"><span class="hs-identifier hs-var">dir</span></a><span> </span><a href="../base-4.10.0.0/src/%{MODULE/./-}.html#%{NAME}/GHC.Base.html#%24"><span class="hs-operator hs-var">$</span></a><span> </span><span class="hs-glyph">\</span><span class="hs-identifier">_</span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="hs-keyword">do</span><span>
</span><a name="line-373"></a><span>        </span><a href="#local-6989586621679041569"><span class="hs-identifier hs-var">createDirs</span></a><span> </span><a href="#local-6989586621679041853"><span class="hs-identifier hs-var">dirs</span></a><span>
</span><a name="line-374"></a><span>        </span><a href="#local-6989586621679041570"><span class="hs-identifier hs-var">createDir</span></a><span> </span><a href="#local-6989586621679041852"><span class="hs-identifier hs-var">dir</span></a><span> </span><a href="../base-4.10.0.0/src/%{MODULE/./-}.html#%{NAME}/GHC.IO.Exception.html#ioError"><span class="hs-identifier hs-var">ioError</span></a><span>
</span><a name="line-375"></a><span>
</span><a name="line-376"></a><span>    </span><a name="local-6989586621679041570"><a href="#local-6989586621679041570"><span class="hs-identifier">createDir</span></a></a><span> </span><a name="local-6989586621679041854"><a href="#local-6989586621679041854"><span class="hs-identifier">dir</span></a></a><span> </span><a name="local-6989586621679041855"><a href="#local-6989586621679041855"><span class="hs-identifier">notExistHandler</span></a></a><span> </span><span class="hs-glyph">=</span><span> </span><span class="hs-keyword">do</span><span>
</span><a name="line-377"></a><span>      </span><a name="local-6989586621679041870"><a href="#local-6989586621679041870"><span class="hs-identifier">r</span></a></a><span> </span><span class="hs-glyph">&lt;-</span><span> </span><a href="../base-4.10.0.0/src/%{MODULE/./-}.html#%{NAME}/System.IO.Error.html#tryIOError"><span class="hs-identifier hs-var">tryIOError</span></a><span> </span><span class="hs-special">(</span><a href="System.Directory.html#createDirectory"><span class="hs-identifier hs-var">createDirectory</span></a><span> </span><a href="#local-6989586621679041854"><span class="hs-identifier hs-var">dir</span></a><span class="hs-special">)</span><span>
</span><a name="line-378"></a><span>      </span><span class="hs-keyword">case</span><span> </span><a href="#local-6989586621679041870"><span class="hs-identifier hs-var">r</span></a><span> </span><span class="hs-keyword">of</span><span>
</span><a name="line-379"></a><span>        </span><a href="../base-4.10.0.0/src/%{MODULE/./-}.html#%{NAME}/Data.Either.html#Right"><span class="hs-identifier hs-var">Right</span></a><span> </span><span class="hs-special">(</span><span class="hs-special">)</span><span>                   </span><span class="hs-glyph">-&gt;</span><span> </span><a href="../base-4.10.0.0/src/%{MODULE/./-}.html#%{NAME}/GHC.Base.html#return"><span class="hs-identifier hs-var">return</span></a><span> </span><span class="hs-special">(</span><span class="hs-special">)</span><span>
</span><a name="line-380"></a><span>        </span><a href="../base-4.10.0.0/src/%{MODULE/./-}.html#%{NAME}/Data.Either.html#Left"><span class="hs-identifier hs-var">Left</span></a><span>  </span><a name="local-6989586621679041871"><a href="#local-6989586621679041871"><span class="hs-identifier">e</span></a></a><span>
</span><a name="line-381"></a><span>          </span><span class="hs-glyph">|</span><span> </span><a href="../base-4.10.0.0/src/%{MODULE/./-}.html#%{NAME}/System.IO.Error.html#isDoesNotExistError"><span class="hs-identifier hs-var">isDoesNotExistError</span></a><span>  </span><a href="#local-6989586621679041871"><span class="hs-identifier hs-var">e</span></a><span> </span><span class="hs-glyph">-&gt;</span><span> </span><a href="#local-6989586621679041855"><span class="hs-identifier hs-var">notExistHandler</span></a><span> </span><a href="#local-6989586621679041871"><span class="hs-identifier hs-var">e</span></a><span>
</span><a name="line-382"></a><span>          </span><span class="hs-comment">-- createDirectory (and indeed POSIX mkdir) does not distinguish</span><span>
</span><a name="line-383"></a><span>          </span><span class="hs-comment">-- between a dir already existing and a file already existing. So we</span><span>
</span><a name="line-384"></a><span>          </span><span class="hs-comment">-- check for it here. Unfortunately there is a slight race condition</span><span>
</span><a name="line-385"></a><span>          </span><span class="hs-comment">-- here, but we think it is benign. It could report an exeption in</span><span>
</span><a name="line-386"></a><span>          </span><span class="hs-comment">-- the case that the dir did exist but another process deletes the</span><span>
</span><a name="line-387"></a><span>          </span><span class="hs-comment">-- directory and creates a file in its place before we can check</span><span>
</span><a name="line-388"></a><span>          </span><span class="hs-comment">-- that the directory did indeed exist.</span><span>
</span><a name="line-389"></a><span>          </span><span class="hs-comment">-- We also follow this path when we get a permissions error, as</span><span>
</span><a name="line-390"></a><span>          </span><span class="hs-comment">-- trying to create &quot;.&quot; when in the root directory on Windows</span><span>
</span><a name="line-391"></a><span>          </span><span class="hs-comment">-- fails with</span><span>
</span><a name="line-392"></a><span>          </span><span class="hs-comment">--     CreateDirectory &quot;.&quot;: permission denied (Access is denied.)</span><span>
</span><a name="line-393"></a><span>          </span><span class="hs-comment">-- This caused GHCi to crash when loading a module in the root</span><span>
</span><a name="line-394"></a><span>          </span><span class="hs-comment">-- directory.</span><span>
</span><a name="line-395"></a><span>          </span><span class="hs-glyph">|</span><span> </span><a href="../base-4.10.0.0/src/%{MODULE/./-}.html#%{NAME}/System.IO.Error.html#isAlreadyExistsError"><span class="hs-identifier hs-var">isAlreadyExistsError</span></a><span> </span><a href="#local-6989586621679041871"><span class="hs-identifier hs-var">e</span></a><span>
</span><a name="line-396"></a><span>         </span><span class="hs-operator hs-var">||</span><span> </span><a href="../base-4.10.0.0/src/%{MODULE/./-}.html#%{NAME}/System.IO.Error.html#isPermissionError"><span class="hs-identifier hs-var">isPermissionError</span></a><span>    </span><a href="#local-6989586621679041871"><span class="hs-identifier hs-var">e</span></a><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="hs-keyword">do</span><span>
</span><a name="line-397"></a><span>              </span><a name="local-6989586621679041872"><a href="#local-6989586621679041872"><span class="hs-identifier">canIgnore</span></a></a><span> </span><span class="hs-glyph">&lt;-</span><span> </span><a href="#local-6989586621679041856"><span class="hs-identifier hs-var">isDir</span></a><span> </span><span class="hs-special">`</span><a href="../base-4.10.0.0/src/%{MODULE/./-}.html#%{NAME}/System.IO.Error.html#catchIOError"><span class="hs-identifier hs-var">catchIOError</span></a><span class="hs-special">`</span><span> </span><span class="hs-glyph">\</span><span> </span><span class="hs-identifier">_</span><span> </span><span class="hs-glyph">-&gt;</span><span>
</span><a name="line-398"></a><span>                           </span><a href="../base-4.10.0.0/src/%{MODULE/./-}.html#%{NAME}/GHC.Base.html#return"><span class="hs-identifier hs-var">return</span></a><span> </span><span class="hs-special">(</span><a href="../base-4.10.0.0/src/%{MODULE/./-}.html#%{NAME}/System.IO.Error.html#isAlreadyExistsError"><span class="hs-identifier hs-var">isAlreadyExistsError</span></a><span> </span><a href="#local-6989586621679041871"><span class="hs-identifier hs-var">e</span></a><span class="hs-special">)</span><span>
</span><a name="line-399"></a><span>              </span><a href="../base-4.10.0.0/src/%{MODULE/./-}.html#%{NAME}/Control.Monad.html#unless"><span class="hs-identifier hs-var">unless</span></a><span> </span><a href="#local-6989586621679041872"><span class="hs-identifier hs-var">canIgnore</span></a><span> </span><span class="hs-special">(</span><a href="../base-4.10.0.0/src/%{MODULE/./-}.html#%{NAME}/GHC.IO.Exception.html#ioError"><span class="hs-identifier hs-var">ioError</span></a><span> </span><a href="#local-6989586621679041871"><span class="hs-identifier hs-var">e</span></a><span class="hs-special">)</span><span>
</span><a name="line-400"></a><span>          </span><span class="hs-glyph">|</span><span> </span><a href="../base-4.10.0.0/src/%{MODULE/./-}.html#%{NAME}/GHC.Base.html#otherwise"><span class="hs-identifier hs-var">otherwise</span></a><span>              </span><span class="hs-glyph">-&gt;</span><span> </span><a href="../base-4.10.0.0/src/%{MODULE/./-}.html#%{NAME}/GHC.IO.Exception.html#ioError"><span class="hs-identifier hs-var">ioError</span></a><span> </span><a href="#local-6989586621679041871"><span class="hs-identifier hs-var">e</span></a><span>
</span><a name="line-401"></a><span>      </span><span class="hs-keyword">where</span><span>
</span><a name="line-402"></a><span class="hs-cpp">#ifdef mingw32_HOST_OS</span><span>
</span><a name="line-403"></a><span>        </span><span class="hs-identifier">isDir</span><span> </span><span class="hs-glyph">=</span><span> </span><span class="hs-identifier">withFileStatus</span><span> </span><span class="hs-string">&quot;createDirectoryIfMissing&quot;</span><span> </span><span class="hs-identifier">dir</span><span> </span><span class="hs-identifier">isDirectory</span><span>
</span><a name="line-404"></a><span class="hs-cpp">#else</span><span>
</span><a name="line-405"></a><span>        </span><a name="local-6989586621679041856"><a href="#local-6989586621679041856"><span class="hs-identifier">isDir</span></a></a><span> </span><span class="hs-glyph">=</span><span> </span><span class="hs-special">(</span><a href="../unix-2.7.2.1/src/%{MODULE/./-}.html#%{NAME}/System.Posix.Files.Common.html#isDirectory"><span class="hs-identifier hs-var">Posix</span><span class="hs-operator hs-var">.</span><span class="hs-identifier hs-var">isDirectory</span></a><span> </span><a href="../base-4.10.0.0/src/%{MODULE/./-}.html#%{NAME}/Data.Functor.html#%3C%24%3E"><span class="hs-operator hs-var">&lt;$&gt;</span></a><span> </span><a href="../unix-2.7.2.1/src/%{MODULE/./-}.html#%{NAME}/System.Posix.Files.html#getFileStatus"><span class="hs-identifier hs-var">Posix</span><span class="hs-operator hs-var">.</span><span class="hs-identifier hs-var">getFileStatus</span></a><span> </span><a href="#local-6989586621679041854"><span class="hs-identifier hs-var">dir</span></a><span class="hs-special">)</span><span>
</span><a name="line-406"></a><span class="hs-cpp">#endif</span><span>
</span><a name="line-407"></a><span>
</span><a name="line-408"></a><span class="hs-comment">-- | * @'NotDirectory'@:   not a directory.</span><span>
</span><a name="line-409"></a><span class="hs-comment">--   * @'Directory'@:      a true directory (not a symbolic link).</span><span>
</span><a name="line-410"></a><span class="hs-comment">--   * @'DirectoryLink'@:  a directory symbolic link (only exists on Windows).</span><span>
</span><a name="line-411"></a><span class="hs-keyword">data</span><span> </span><a name="DirectoryType"><a href="System.Directory.html#DirectoryType"><span class="hs-identifier">DirectoryType</span></a></a><span> </span><span class="hs-glyph">=</span><span> </span><a name="NotDirectory"><a href="System.Directory.html#NotDirectory"><span class="hs-identifier">NotDirectory</span></a></a><span>
</span><a name="line-412"></a><span>                   </span><span class="hs-glyph">|</span><span> </span><a name="Directory"><a href="System.Directory.html#Directory"><span class="hs-identifier">Directory</span></a></a><span>
</span><a name="line-413"></a><span>                   </span><span class="hs-glyph">|</span><span> </span><a name="DirectoryLink"><a href="System.Directory.html#DirectoryLink"><span class="hs-identifier">DirectoryLink</span></a></a><span>
</span><a name="line-414"></a><span>                   </span><span class="hs-keyword">deriving</span><span> </span><span class="hs-special">(</span><a href="../base-4.10.0.0/src/%{MODULE/./-}.html#%{NAME}/GHC.Enum.html#Enum"><span class="hs-identifier hs-type">Enum</span></a><span class="hs-special">,</span><span> </span><span class="hs-identifier hs-type">Eq</span><span class="hs-special">,</span><span> </span><span class="hs-identifier hs-type">Ord</span><span class="hs-special">,</span><span> </span><a href="../base-4.10.0.0/src/%{MODULE/./-}.html#%{NAME}/GHC.Read.html#Read"><span class="hs-identifier hs-type">Read</span></a><span class="hs-special">,</span><span> </span><a href="../base-4.10.0.0/src/%{MODULE/./-}.html#%{NAME}/GHC.Show.html#Show"><span class="hs-identifier hs-type">Show</span></a><span class="hs-special">)</span><span>
</span><a name="line-415"></a><span>
</span><a name="line-416"></a><span class="hs-comment">-- | Obtain the type of a directory.</span><span>
</span><a name="line-417"></a><span class="hs-identifier">getDirectoryType</span><span> </span><span class="hs-glyph">::</span><span> </span><a href="../base-4.10.0.0/src/%{MODULE/./-}.html#%{NAME}/GHC.IO.html#FilePath"><span class="hs-identifier hs-type">FilePath</span></a><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="hs-identifier hs-type">IO</span><span> </span><a href="System.Directory.html#DirectoryType"><span class="hs-identifier hs-type">DirectoryType</span></a><span>
</span><a name="line-418"></a><a name="getDirectoryType"><a href="System.Directory.html#getDirectoryType"><span class="hs-identifier">getDirectoryType</span></a></a><span> </span><a name="local-6989586621679041873"><a href="#local-6989586621679041873"><span class="hs-identifier">path</span></a></a><span> </span><span class="hs-glyph">=</span><span>
</span><a name="line-419"></a><span>  </span><span class="hs-special">(</span><span class="hs-special">`</span><a href="System.Directory.html#ioeAddLocation"><span class="hs-identifier hs-var">ioeAddLocation</span></a><span class="hs-special">`</span><span> </span><span class="hs-string">&quot;getDirectoryType&quot;</span><span class="hs-special">)</span><span> </span><span class="hs-special">`</span><a href="../base-4.10.0.0/src/%{MODULE/./-}.html#%{NAME}/System.IO.Error.html#modifyIOError"><span class="hs-identifier hs-var">modifyIOError</span></a><span class="hs-special">`</span><span> </span><span class="hs-keyword">do</span><span>
</span><a name="line-420"></a><span class="hs-cpp">#ifdef mingw32_HOST_OS</span><span>
</span><a name="line-421"></a><span>    </span><span class="hs-identifier">isDir</span><span> </span><span class="hs-glyph">&lt;-</span><span> </span><span class="hs-identifier">withFileStatus</span><span> </span><span class="hs-string">&quot;getDirectoryType&quot;</span><span> </span><span class="hs-identifier">path</span><span> </span><span class="hs-identifier">isDirectory</span><span>
</span><a name="line-422"></a><span>    </span><span class="hs-keyword">if</span><span> </span><span class="hs-identifier">isDir</span><span>
</span><a name="line-423"></a><span>      </span><span class="hs-keyword">then</span><span> </span><span class="hs-keyword">do</span><span>
</span><a name="line-424"></a><span>        </span><span class="hs-identifier">isLink</span><span> </span><span class="hs-glyph">&lt;-</span><span> </span><span class="hs-identifier">pathIsSymbolicLink</span><span> </span><span class="hs-identifier">path</span><span>
</span><a name="line-425"></a><span>        </span><span class="hs-keyword">if</span><span> </span><span class="hs-identifier">isLink</span><span>
</span><a name="line-426"></a><span>          </span><span class="hs-keyword">then</span><span> </span><span class="hs-identifier">return</span><span> </span><span class="hs-identifier">DirectoryLink</span><span>
</span><a name="line-427"></a><span>          </span><span class="hs-keyword">else</span><span> </span><span class="hs-identifier">return</span><span> </span><span class="hs-identifier">Directory</span><span>
</span><a name="line-428"></a><span>      </span><span class="hs-keyword">else</span><span> </span><span class="hs-keyword">do</span><span>
</span><a name="line-429"></a><span>        </span><span class="hs-identifier">return</span><span> </span><span class="hs-identifier">NotDirectory</span><span>
</span><a name="line-430"></a><span class="hs-cpp">#else</span><span>
</span><a name="line-431"></a><span>    </span><a name="local-6989586621679041874"><a href="#local-6989586621679041874"><span class="hs-identifier">stat</span></a></a><span> </span><span class="hs-glyph">&lt;-</span><span> </span><a href="../unix-2.7.2.1/src/%{MODULE/./-}.html#%{NAME}/System.Posix.Files.html#getSymbolicLinkStatus"><span class="hs-identifier hs-var">Posix</span><span class="hs-operator hs-var">.</span><span class="hs-identifier hs-var">getSymbolicLinkStatus</span></a><span> </span><a href="#local-6989586621679041873"><span class="hs-identifier hs-var">path</span></a><span>
</span><a name="line-432"></a><span>    </span><a href="../base-4.10.0.0/src/%{MODULE/./-}.html#%{NAME}/GHC.Base.html#return"><span class="hs-identifier hs-var">return</span></a><span> </span><a href="../base-4.10.0.0/src/%{MODULE/./-}.html#%{NAME}/GHC.Base.html#%24"><span class="hs-operator hs-var">$</span></a><span> </span><span class="hs-keyword">if</span><span> </span><a href="../unix-2.7.2.1/src/%{MODULE/./-}.html#%{NAME}/System.Posix.Files.Common.html#isDirectory"><span class="hs-identifier hs-var">Posix</span><span class="hs-operator hs-var">.</span><span class="hs-identifier hs-var">isDirectory</span></a><span> </span><a href="#local-6989586621679041874"><span class="hs-identifier hs-var">stat</span></a><span>
</span><a name="line-433"></a><span>             </span><span class="hs-keyword">then</span><span> </span><a href="System.Directory.html#Directory"><span class="hs-identifier hs-var">Directory</span></a><span>
</span><a name="line-434"></a><span>             </span><span class="hs-keyword">else</span><span> </span><a href="System.Directory.html#NotDirectory"><span class="hs-identifier hs-var">NotDirectory</span></a><span>
</span><a name="line-435"></a><span class="hs-cpp">#endif</span><span>
</span><a name="line-436"></a><span>
</span><a name="line-437"></a><span class="hs-comment">{- | @'removeDirectory' dir@ removes an existing directory /dir/.  The
implementation may specify additional constraints which must be
satisfied before a directory can be removed (e.g. the directory has to
be empty, or may not be in use by other processes).  It is not legal
for an implementation to partially remove a directory unless the
entire directory is removed. A conformant implementation need not
support directory removal in all situations (e.g. removal of the root
directory).

The operation may fail with:

* 'HardwareFault'
A physical I\/O error has occurred.
@[EIO]@

* 'InvalidArgument'
The operand is not a valid directory name.
@[ENAMETOOLONG, ELOOP]@

* 'isDoesNotExistError' \/ 'NoSuchThing'
The directory does not exist.
@[ENOENT, ENOTDIR]@

* 'isPermissionError' \/ 'PermissionDenied'
The process has insufficient privileges to perform the operation.
@[EROFS, EACCES, EPERM]@

* 'UnsatisfiedConstraints'
Implementation-dependent constraints are not satisfied.
@[EBUSY, ENOTEMPTY, EEXIST]@

* 'UnsupportedOperation'
The implementation does not support removal in this situation.
@[EINVAL]@

* 'InappropriateType'
The operand refers to an existing non-directory object.
@[ENOTDIR]@

-}</span><span>
</span><a name="line-477"></a><span>
</span><a name="line-478"></a><span class="hs-identifier">removeDirectory</span><span> </span><span class="hs-glyph">::</span><span> </span><a href="../base-4.10.0.0/src/%{MODULE/./-}.html#%{NAME}/GHC.IO.html#FilePath"><span class="hs-identifier hs-type">FilePath</span></a><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="hs-identifier hs-type">IO</span><span> </span><span class="hs-special">(</span><span class="hs-special">)</span><span>
</span><a name="line-479"></a><a name="removeDirectory"><a href="System.Directory.html#removeDirectory"><span class="hs-identifier">removeDirectory</span></a></a><span> </span><a name="local-6989586621679041875"><a href="#local-6989586621679041875"><span class="hs-identifier">path</span></a></a><span> </span><span class="hs-glyph">=</span><span>
</span><a name="line-480"></a><span class="hs-cpp">#ifdef mingw32_HOST_OS</span><span>
</span><a name="line-481"></a><span>  </span><span class="hs-identifier">Win32</span><span class="hs-operator">.</span><span class="hs-identifier">removeDirectory</span><span> </span><span class="hs-identifier">path</span><span>
</span><a name="line-482"></a><span class="hs-cpp">#else</span><span>
</span><a name="line-483"></a><span>  </span><a href="../unix-2.7.2.1/src/%{MODULE/./-}.html#%{NAME}/System.Posix.Directory.html#removeDirectory"><span class="hs-identifier hs-var">Posix</span><span class="hs-operator hs-var">.</span><span class="hs-identifier hs-var">removeDirectory</span></a><span> </span><a href="#local-6989586621679041875"><span class="hs-identifier hs-var">path</span></a><span>
</span><a name="line-484"></a><span class="hs-cpp">#endif</span><span>
</span><a name="line-485"></a><span>
</span><a name="line-486"></a><span class="hs-comment">-- | @'removeDirectoryRecursive' dir@ removes an existing directory /dir/</span><span>
</span><a name="line-487"></a><span class="hs-comment">-- together with its contents and subdirectories. Within this directory,</span><span>
</span><a name="line-488"></a><span class="hs-comment">-- symbolic links are removed without affecting their targets.</span><span>
</span><a name="line-489"></a><span class="hs-comment">--</span><span>
</span><a name="line-490"></a><span class="hs-comment">-- On Windows, the operation fails if /dir/ is a directory symbolic link.</span><span>
</span><a name="line-491"></a><span class="hs-identifier">removeDirectoryRecursive</span><span> </span><span class="hs-glyph">::</span><span> </span><a href="../base-4.10.0.0/src/%{MODULE/./-}.html#%{NAME}/GHC.IO.html#FilePath"><span class="hs-identifier hs-type">FilePath</span></a><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="hs-identifier hs-type">IO</span><span> </span><span class="hs-special">(</span><span class="hs-special">)</span><span>
</span><a name="line-492"></a><a name="removeDirectoryRecursive"><a href="System.Directory.html#removeDirectoryRecursive"><span class="hs-identifier">removeDirectoryRecursive</span></a></a><span> </span><a name="local-6989586621679041876"><a href="#local-6989586621679041876"><span class="hs-identifier">path</span></a></a><span> </span><span class="hs-glyph">=</span><span>
</span><a name="line-493"></a><span>  </span><span class="hs-special">(</span><span class="hs-special">`</span><a href="System.Directory.html#ioeAddLocation"><span class="hs-identifier hs-var">ioeAddLocation</span></a><span class="hs-special">`</span><span> </span><span class="hs-string">&quot;removeDirectoryRecursive&quot;</span><span class="hs-special">)</span><span> </span><span class="hs-special">`</span><a href="../base-4.10.0.0/src/%{MODULE/./-}.html#%{NAME}/System.IO.Error.html#modifyIOError"><span class="hs-identifier hs-var">modifyIOError</span></a><span class="hs-special">`</span><span> </span><span class="hs-keyword">do</span><span>
</span><a name="line-494"></a><span>    </span><a name="local-6989586621679041878"><a href="#local-6989586621679041878"><span class="hs-identifier">dirType</span></a></a><span> </span><span class="hs-glyph">&lt;-</span><span> </span><a href="System.Directory.html#getDirectoryType"><span class="hs-identifier hs-var">getDirectoryType</span></a><span> </span><a href="#local-6989586621679041876"><span class="hs-identifier hs-var">path</span></a><span>
</span><a name="line-495"></a><span>    </span><span class="hs-keyword">case</span><span> </span><a href="#local-6989586621679041878"><span class="hs-identifier hs-var">dirType</span></a><span> </span><span class="hs-keyword">of</span><span>
</span><a name="line-496"></a><span>      </span><a href="System.Directory.html#Directory"><span class="hs-identifier hs-var">Directory</span></a><span> </span><span class="hs-glyph">-&gt;</span><span>
</span><a name="line-497"></a><span>        </span><a href="System.Directory.html#removeContentsRecursive"><span class="hs-identifier hs-var">removeContentsRecursive</span></a><span> </span><a href="#local-6989586621679041876"><span class="hs-identifier hs-var">path</span></a><span>
</span><a name="line-498"></a><span>      </span><a href="System.Directory.html#DirectoryLink"><span class="hs-identifier hs-var">DirectoryLink</span></a><span> </span><span class="hs-glyph">-&gt;</span><span>
</span><a name="line-499"></a><span>        </span><a href="../base-4.10.0.0/src/%{MODULE/./-}.html#%{NAME}/GHC.IO.Exception.html#ioError"><span class="hs-identifier hs-var">ioError</span></a><span> </span><span class="hs-special">(</span><a href="#local-6989586621679041877"><span class="hs-identifier hs-var">err</span></a><span> </span><span class="hs-special">`</span><a href="../base-4.10.0.0/src/%{MODULE/./-}.html#%{NAME}/System.IO.Error.html#ioeSetErrorString"><span class="hs-identifier hs-var">ioeSetErrorString</span></a><span class="hs-special">`</span><span> </span><span class="hs-string">&quot;is a directory symbolic link&quot;</span><span class="hs-special">)</span><span>
</span><a name="line-500"></a><span>      </span><a href="System.Directory.html#NotDirectory"><span class="hs-identifier hs-var">NotDirectory</span></a><span> </span><span class="hs-glyph">-&gt;</span><span>
</span><a name="line-501"></a><span>        </span><a href="../base-4.10.0.0/src/%{MODULE/./-}.html#%{NAME}/GHC.IO.Exception.html#ioError"><span class="hs-identifier hs-var">ioError</span></a><span> </span><span class="hs-special">(</span><a href="#local-6989586621679041877"><span class="hs-identifier hs-var">err</span></a><span> </span><span class="hs-special">`</span><a href="../base-4.10.0.0/src/%{MODULE/./-}.html#%{NAME}/System.IO.Error.html#ioeSetErrorString"><span class="hs-identifier hs-var">ioeSetErrorString</span></a><span class="hs-special">`</span><span> </span><span class="hs-string">&quot;not a directory&quot;</span><span class="hs-special">)</span><span>
</span><a name="line-502"></a><span>  </span><span class="hs-keyword">where</span><span> </span><a name="local-6989586621679041877"><a href="#local-6989586621679041877"><span class="hs-identifier">err</span></a></a><span> </span><span class="hs-glyph">=</span><span> </span><a href="../base-4.10.0.0/src/%{MODULE/./-}.html#%{NAME}/System.IO.Error.html#mkIOError"><span class="hs-identifier hs-var">mkIOError</span></a><span> </span><a href="../base-4.10.0.0/src/%{MODULE/./-}.html#%{NAME}/GHC.IO.Exception.html#InappropriateType"><span class="hs-identifier hs-var">InappropriateType</span></a><span> </span><span class="hs-string">&quot;&quot;</span><span> </span><a href="../base-4.10.0.0/src/%{MODULE/./-}.html#%{NAME}/GHC.Base.html#Nothing"><span class="hs-identifier hs-var">Nothing</span></a><span> </span><span class="hs-special">(</span><a href="../base-4.10.0.0/src/%{MODULE/./-}.html#%{NAME}/GHC.Base.html#Just"><span class="hs-identifier hs-var">Just</span></a><span> </span><a href="#local-6989586621679041876"><span class="hs-identifier hs-var">path</span></a><span class="hs-special">)</span><span>
</span><a name="line-503"></a><span>
</span><a name="line-504"></a><span class="hs-comment">-- | @'removePathRecursive' path@ removes an existing file or directory at</span><span>
</span><a name="line-505"></a><span class="hs-comment">-- /path/ together with its contents and subdirectories. Symbolic links are</span><span>
</span><a name="line-506"></a><span class="hs-comment">-- removed without affecting their the targets.</span><span>
</span><a name="line-507"></a><span class="hs-identifier">removePathRecursive</span><span> </span><span class="hs-glyph">::</span><span> </span><a href="../base-4.10.0.0/src/%{MODULE/./-}.html#%{NAME}/GHC.IO.html#FilePath"><span class="hs-identifier hs-type">FilePath</span></a><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="hs-identifier hs-type">IO</span><span> </span><span class="hs-special">(</span><span class="hs-special">)</span><span>
</span><a name="line-508"></a><a name="removePathRecursive"><a href="System.Directory.html#removePathRecursive"><span class="hs-identifier">removePathRecursive</span></a></a><span> </span><a name="local-6989586621679041879"><a href="#local-6989586621679041879"><span class="hs-identifier">path</span></a></a><span> </span><span class="hs-glyph">=</span><span>
</span><a name="line-509"></a><span>  </span><span class="hs-special">(</span><span class="hs-special">`</span><a href="System.Directory.html#ioeAddLocation"><span class="hs-identifier hs-var">ioeAddLocation</span></a><span class="hs-special">`</span><span> </span><span class="hs-string">&quot;removePathRecursive&quot;</span><span class="hs-special">)</span><span> </span><span class="hs-special">`</span><a href="../base-4.10.0.0/src/%{MODULE/./-}.html#%{NAME}/System.IO.Error.html#modifyIOError"><span class="hs-identifier hs-var">modifyIOError</span></a><span class="hs-special">`</span><span> </span><span class="hs-keyword">do</span><span>
</span><a name="line-510"></a><span>    </span><a name="local-6989586621679041880"><a href="#local-6989586621679041880"><span class="hs-identifier">dirType</span></a></a><span> </span><span class="hs-glyph">&lt;-</span><span> </span><a href="System.Directory.html#getDirectoryType"><span class="hs-identifier hs-var">getDirectoryType</span></a><span> </span><a href="#local-6989586621679041879"><span class="hs-identifier hs-var">path</span></a><span>
</span><a name="line-511"></a><span>    </span><span class="hs-keyword">case</span><span> </span><a href="#local-6989586621679041880"><span class="hs-identifier hs-var">dirType</span></a><span> </span><span class="hs-keyword">of</span><span>
</span><a name="line-512"></a><span>      </span><a href="System.Directory.html#NotDirectory"><span class="hs-identifier hs-var">NotDirectory</span></a><span>  </span><span class="hs-glyph">-&gt;</span><span> </span><a href="System.Directory.html#removeFile"><span class="hs-identifier hs-var">removeFile</span></a><span> </span><a href="#local-6989586621679041879"><span class="hs-identifier hs-var">path</span></a><span>
</span><a name="line-513"></a><span>      </span><a href="System.Directory.html#Directory"><span class="hs-identifier hs-var">Directory</span></a><span>     </span><span class="hs-glyph">-&gt;</span><span> </span><a href="System.Directory.html#removeContentsRecursive"><span class="hs-identifier hs-var">removeContentsRecursive</span></a><span> </span><a href="#local-6989586621679041879"><span class="hs-identifier hs-var">path</span></a><span>
</span><a name="line-514"></a><span>      </span><a href="System.Directory.html#DirectoryLink"><span class="hs-identifier hs-var">DirectoryLink</span></a><span> </span><span class="hs-glyph">-&gt;</span><span> </span><a href="System.Directory.html#removeDirectory"><span class="hs-identifier hs-var">removeDirectory</span></a><span> </span><a href="#local-6989586621679041879"><span class="hs-identifier hs-var">path</span></a><span>
</span><a name="line-515"></a><span>
</span><a name="line-516"></a><span class="hs-comment">-- | @'removeContentsRecursive' dir@ removes the contents of the directory</span><span>
</span><a name="line-517"></a><span class="hs-comment">-- /dir/ recursively. Symbolic links are removed without affecting their the</span><span>
</span><a name="line-518"></a><span class="hs-comment">-- targets.</span><span>
</span><a name="line-519"></a><span class="hs-identifier">removeContentsRecursive</span><span> </span><span class="hs-glyph">::</span><span> </span><a href="../base-4.10.0.0/src/%{MODULE/./-}.html#%{NAME}/GHC.IO.html#FilePath"><span class="hs-identifier hs-type">FilePath</span></a><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="hs-identifier hs-type">IO</span><span> </span><span class="hs-special">(</span><span class="hs-special">)</span><span>
</span><a name="line-520"></a><a name="removeContentsRecursive"><a href="System.Directory.html#removeContentsRecursive"><span class="hs-identifier">removeContentsRecursive</span></a></a><span> </span><a name="local-6989586621679041881"><a href="#local-6989586621679041881"><span class="hs-identifier">path</span></a></a><span> </span><span class="hs-glyph">=</span><span>
</span><a name="line-521"></a><span>  </span><span class="hs-special">(</span><span class="hs-special">`</span><a href="System.Directory.html#ioeAddLocation"><span class="hs-identifier hs-var">ioeAddLocation</span></a><span class="hs-special">`</span><span> </span><span class="hs-string">&quot;removeContentsRecursive&quot;</span><span class="hs-special">)</span><span> </span><span class="hs-special">`</span><a href="../base-4.10.0.0/src/%{MODULE/./-}.html#%{NAME}/System.IO.Error.html#modifyIOError"><span class="hs-identifier hs-var">modifyIOError</span></a><span class="hs-special">`</span><span> </span><span class="hs-keyword">do</span><span>
</span><a name="line-522"></a><span>    </span><a name="local-6989586621679041882"><a href="#local-6989586621679041882"><span class="hs-identifier">cont</span></a></a><span> </span><span class="hs-glyph">&lt;-</span><span> </span><a href="System.Directory.html#listDirectory"><span class="hs-identifier hs-var">listDirectory</span></a><span> </span><a href="#local-6989586621679041881"><span class="hs-identifier hs-var">path</span></a><span>
</span><a name="line-523"></a><span>    </span><a href="../base-4.10.0.0/src/%{MODULE/./-}.html#%{NAME}/Data.Foldable.html#mapM_"><span class="hs-identifier hs-var">mapM_</span></a><span> </span><a href="System.Directory.html#removePathRecursive"><span class="hs-identifier hs-var">removePathRecursive</span></a><span> </span><span class="hs-special">[</span><a href="#local-6989586621679041881"><span class="hs-identifier hs-var">path</span></a><span> </span><a href="../filepath-1.4.1.1/src/%{MODULE/./-}.html#%{NAME}/System.FilePath.Posix.html#%3C%2F%3E"><span class="hs-operator hs-var">&lt;/&gt;</span></a><span> </span><a href="#local-6989586621679041883"><span class="hs-identifier hs-var">x</span></a><span> </span><span class="hs-glyph">|</span><span> </span><a name="local-6989586621679041883"><a href="#local-6989586621679041883"><span class="hs-identifier">x</span></a></a><span> </span><span class="hs-glyph">&lt;-</span><span> </span><a href="#local-6989586621679041882"><span class="hs-identifier hs-var">cont</span></a><span class="hs-special">]</span><span>
</span><a name="line-524"></a><span>    </span><a href="System.Directory.html#removeDirectory"><span class="hs-identifier hs-var">removeDirectory</span></a><span> </span><a href="#local-6989586621679041881"><span class="hs-identifier hs-var">path</span></a><span>
</span><a name="line-525"></a><span>
</span><a name="line-526"></a><span class="hs-comment">-- | Removes a file or directory at /path/ together with its contents and</span><span>
</span><a name="line-527"></a><span class="hs-comment">-- subdirectories. Symbolic links are removed without affecting their</span><span>
</span><a name="line-528"></a><span class="hs-comment">-- targets. If the path does not exist, nothing happens.</span><span>
</span><a name="line-529"></a><span class="hs-comment">--</span><span>
</span><a name="line-530"></a><span class="hs-comment">-- Unlike other removal functions, this function will also attempt to delete</span><span>
</span><a name="line-531"></a><span class="hs-comment">-- files marked as read-only or otherwise made unremovable due to permissions.</span><span>
</span><a name="line-532"></a><span class="hs-comment">-- As a result, if the removal is incomplete, the permissions or attributes on</span><span>
</span><a name="line-533"></a><span class="hs-comment">-- the remaining files may be altered.  If there are hard links in the</span><span>
</span><a name="line-534"></a><span class="hs-comment">-- directory, then permissions on all related hard links may be altered.</span><span>
</span><a name="line-535"></a><span class="hs-comment">--</span><span>
</span><a name="line-536"></a><span class="hs-comment">-- If an entry within the directory vanishes while @removePathForcibly@ is</span><span>
</span><a name="line-537"></a><span class="hs-comment">-- running, it is silently ignored.</span><span>
</span><a name="line-538"></a><span class="hs-comment">--</span><span>
</span><a name="line-539"></a><span class="hs-comment">-- If an exception occurs while removing an entry, @removePathForcibly@ will</span><span>
</span><a name="line-540"></a><span class="hs-comment">-- still try to remove as many entries as it can before failing with an</span><span>
</span><a name="line-541"></a><span class="hs-comment">-- exception.  The first exception that it encountered is re-thrown.</span><span>
</span><a name="line-542"></a><span class="hs-comment">--</span><span>
</span><a name="line-543"></a><span class="hs-comment">-- @since 1.2.7.0</span><span>
</span><a name="line-544"></a><span class="hs-identifier">removePathForcibly</span><span> </span><span class="hs-glyph">::</span><span> </span><a href="../base-4.10.0.0/src/%{MODULE/./-}.html#%{NAME}/GHC.IO.html#FilePath"><span class="hs-identifier hs-type">FilePath</span></a><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="hs-identifier hs-type">IO</span><span> </span><span class="hs-special">(</span><span class="hs-special">)</span><span>
</span><a name="line-545"></a><a name="removePathForcibly"><a href="System.Directory.html#removePathForcibly"><span class="hs-identifier">removePathForcibly</span></a></a><span> </span><a name="local-6989586621679041884"><a href="#local-6989586621679041884"><span class="hs-identifier">path</span></a></a><span> </span><span class="hs-glyph">=</span><span>
</span><a name="line-546"></a><span>  </span><span class="hs-special">(</span><span class="hs-special">`</span><a href="System.Directory.html#ioeAddLocation"><span class="hs-identifier hs-var">ioeAddLocation</span></a><span class="hs-special">`</span><span> </span><span class="hs-string">&quot;removePathForcibly&quot;</span><span class="hs-special">)</span><span> </span><span class="hs-special">`</span><a href="../base-4.10.0.0/src/%{MODULE/./-}.html#%{NAME}/System.IO.Error.html#modifyIOError"><span class="hs-identifier hs-var">modifyIOError</span></a><span class="hs-special">`</span><span> </span><span class="hs-keyword">do</span><span>
</span><a name="line-547"></a><span>    </span><a href="#local-6989586621679041886"><span class="hs-identifier hs-var">makeRemovable</span></a><span> </span><a href="#local-6989586621679041884"><span class="hs-identifier hs-var">path</span></a><span> </span><span class="hs-special">`</span><a href="../base-4.10.0.0/src/%{MODULE/./-}.html#%{NAME}/System.IO.Error.html#catchIOError"><span class="hs-identifier hs-var">catchIOError</span></a><span class="hs-special">`</span><span> </span><span class="hs-glyph">\</span><span> </span><span class="hs-identifier">_</span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><a href="../base-4.10.0.0/src/%{MODULE/./-}.html#%{NAME}/GHC.Base.html#return"><span class="hs-identifier hs-var">return</span></a><span> </span><span class="hs-special">(</span><span class="hs-special">)</span><span>
</span><a name="line-548"></a><span>    </span><a href="#local-6989586621679041885"><span class="hs-identifier hs-var">ignoreDoesNotExistError</span></a><span> </span><a href="../base-4.10.0.0/src/%{MODULE/./-}.html#%{NAME}/GHC.Base.html#%24"><span class="hs-operator hs-var">$</span></a><span> </span><span class="hs-keyword">do</span><span>
</span><a name="line-549"></a><span>      </span><a name="local-6989586621679041890"><a href="#local-6989586621679041890"><span class="hs-identifier">dirType</span></a></a><span> </span><span class="hs-glyph">&lt;-</span><span> </span><a href="System.Directory.html#getDirectoryType"><span class="hs-identifier hs-var">getDirectoryType</span></a><span> </span><a href="#local-6989586621679041884"><span class="hs-identifier hs-var">path</span></a><span>
</span><a name="line-550"></a><span>      </span><span class="hs-keyword">case</span><span> </span><a href="#local-6989586621679041890"><span class="hs-identifier hs-var">dirType</span></a><span> </span><span class="hs-keyword">of</span><span>
</span><a name="line-551"></a><span>        </span><a href="System.Directory.html#NotDirectory"><span class="hs-identifier hs-var">NotDirectory</span></a><span>  </span><span class="hs-glyph">-&gt;</span><span> </span><a href="System.Directory.html#removeFile"><span class="hs-identifier hs-var">removeFile</span></a><span> </span><a href="#local-6989586621679041884"><span class="hs-identifier hs-var">path</span></a><span>
</span><a name="line-552"></a><span>        </span><a href="System.Directory.html#DirectoryLink"><span class="hs-identifier hs-var">DirectoryLink</span></a><span> </span><span class="hs-glyph">-&gt;</span><span> </span><a href="System.Directory.html#removeDirectory"><span class="hs-identifier hs-var">removeDirectory</span></a><span> </span><a href="#local-6989586621679041884"><span class="hs-identifier hs-var">path</span></a><span>
</span><a name="line-553"></a><span>        </span><a href="System.Directory.html#Directory"><span class="hs-identifier hs-var">Directory</span></a><span>     </span><span class="hs-glyph">-&gt;</span><span> </span><span class="hs-keyword">do</span><span>
</span><a name="line-554"></a><span>          </span><a name="local-6989586621679041891"><a href="#local-6989586621679041891"><span class="hs-identifier">names</span></a></a><span> </span><span class="hs-glyph">&lt;-</span><span> </span><a href="System.Directory.html#listDirectory"><span class="hs-identifier hs-var">listDirectory</span></a><span> </span><a href="#local-6989586621679041884"><span class="hs-identifier hs-var">path</span></a><span>
</span><a name="line-555"></a><span>          </span><a href="System.Directory.html#sequenceWithIOErrors_"><span class="hs-identifier hs-var">sequenceWithIOErrors_</span></a><span> </span><a href="../base-4.10.0.0/src/%{MODULE/./-}.html#%{NAME}/GHC.Base.html#%24"><span class="hs-operator hs-var">$</span></a><span>
</span><a name="line-556"></a><span>            </span><span class="hs-special">[</span><span> </span><a href="System.Directory.html#removePathForcibly"><span class="hs-identifier hs-var">removePathForcibly</span></a><span> </span><span class="hs-special">(</span><a href="#local-6989586621679041884"><span class="hs-identifier hs-var">path</span></a><span> </span><a href="../filepath-1.4.1.1/src/%{MODULE/./-}.html#%{NAME}/System.FilePath.Posix.html#%3C%2F%3E"><span class="hs-operator hs-var">&lt;/&gt;</span></a><span> </span><a href="#local-6989586621679041892"><span class="hs-identifier hs-var">name</span></a><span class="hs-special">)</span><span> </span><span class="hs-glyph">|</span><span> </span><a name="local-6989586621679041892"><a href="#local-6989586621679041892"><span class="hs-identifier">name</span></a></a><span> </span><span class="hs-glyph">&lt;-</span><span> </span><a href="#local-6989586621679041891"><span class="hs-identifier hs-var">names</span></a><span> </span><span class="hs-special">]</span><span> </span><a href="../base-4.10.0.0/src/%{MODULE/./-}.html#%{NAME}/GHC.Base.html#%2B%2B"><span class="hs-operator hs-var">++</span></a><span>
</span><a name="line-557"></a><span>            </span><span class="hs-special">[</span><span> </span><a href="System.Directory.html#removeDirectory"><span class="hs-identifier hs-var">removeDirectory</span></a><span> </span><a href="#local-6989586621679041884"><span class="hs-identifier hs-var">path</span></a><span> </span><span class="hs-special">]</span><span>
</span><a name="line-558"></a><span>  </span><span class="hs-keyword">where</span><span>
</span><a name="line-559"></a><span>
</span><a name="line-560"></a><span>    </span><span class="hs-identifier">ignoreDoesNotExistError</span><span> </span><span class="hs-glyph">::</span><span> </span><span class="hs-identifier hs-type">IO</span><span> </span><span class="hs-special">(</span><span class="hs-special">)</span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="hs-identifier hs-type">IO</span><span> </span><span class="hs-special">(</span><span class="hs-special">)</span><span>
</span><a name="line-561"></a><span>    </span><a name="local-6989586621679041885"><a href="#local-6989586621679041885"><span class="hs-identifier">ignoreDoesNotExistError</span></a></a><span> </span><a name="local-6989586621679041887"><a href="#local-6989586621679041887"><span class="hs-identifier">action</span></a></a><span> </span><span class="hs-glyph">=</span><span> </span><span class="hs-keyword">do</span><span>
</span><a name="line-562"></a><span>      </span><span class="hs-identifier">_</span><span> </span><span class="hs-glyph">&lt;-</span><span> </span><a href="System.Directory.html#tryIOErrorType"><span class="hs-identifier hs-var">tryIOErrorType</span></a><span> </span><a href="../base-4.10.0.0/src/%{MODULE/./-}.html#%{NAME}/System.IO.Error.html#isDoesNotExistError"><span class="hs-identifier hs-var">isDoesNotExistError</span></a><span> </span><a href="#local-6989586621679041887"><span class="hs-identifier hs-var">action</span></a><span>
</span><a name="line-563"></a><span>      </span><a href="../base-4.10.0.0/src/%{MODULE/./-}.html#%{NAME}/GHC.Base.html#return"><span class="hs-identifier hs-var">return</span></a><span> </span><span class="hs-special">(</span><span class="hs-special">)</span><span>
</span><a name="line-564"></a><span>
</span><a name="line-565"></a><span>    </span><span class="hs-identifier">makeRemovable</span><span> </span><span class="hs-glyph">::</span><span> </span><a href="../base-4.10.0.0/src/%{MODULE/./-}.html#%{NAME}/GHC.IO.html#FilePath"><span class="hs-identifier hs-type">FilePath</span></a><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="hs-identifier hs-type">IO</span><span> </span><span class="hs-special">(</span><span class="hs-special">)</span><span>
</span><a name="line-566"></a><span>    </span><a name="local-6989586621679041886"><a href="#local-6989586621679041886"><span class="hs-identifier">makeRemovable</span></a></a><span> </span><a name="local-6989586621679041888"><a href="#local-6989586621679041888"><span class="hs-identifier">p</span></a></a><span> </span><span class="hs-glyph">=</span><span> </span><span class="hs-keyword">do</span><span>
</span><a name="line-567"></a><span>      </span><a name="local-6989586621679041889"><a href="#local-6989586621679041889"><span class="hs-identifier">perms</span></a></a><span> </span><span class="hs-glyph">&lt;-</span><span> </span><a href="System.Directory.html#getPermissions"><span class="hs-identifier hs-var">getPermissions</span></a><span> </span><a href="#local-6989586621679041888"><span class="hs-identifier hs-var">p</span></a><span>
</span><a name="line-568"></a><span>      </span><a href="System.Directory.html#setPermissions"><span class="hs-identifier hs-var">setPermissions</span></a><span> </span><a href="#local-6989586621679041884"><span class="hs-identifier hs-var">path</span></a><span> </span><a href="#local-6989586621679041889"><span class="hs-identifier hs-var">perms</span></a><span class="hs-special">{</span><span> </span><span class="hs-identifier">readable</span><span> </span><span class="hs-glyph">=</span><span> </span><span class="hs-identifier hs-var">True</span><span>
</span><a name="line-569"></a><span>                               </span><span class="hs-special">,</span><span> </span><span class="hs-identifier">searchable</span><span> </span><span class="hs-glyph">=</span><span> </span><span class="hs-identifier hs-var">True</span><span>
</span><a name="line-570"></a><span>                               </span><span class="hs-special">,</span><span> </span><span class="hs-identifier">writable</span><span> </span><span class="hs-glyph">=</span><span> </span><span class="hs-identifier hs-var">True</span><span> </span><span class="hs-special">}</span><span>
</span><a name="line-571"></a><span>
</span><a name="line-572"></a><span class="hs-identifier">sequenceWithIOErrors_</span><span> </span><span class="hs-glyph">::</span><span> </span><span class="hs-special">[</span><span class="hs-identifier hs-type">IO</span><span> </span><span class="hs-special">(</span><span class="hs-special">)</span><span class="hs-special">]</span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="hs-identifier hs-type">IO</span><span> </span><span class="hs-special">(</span><span class="hs-special">)</span><span>
</span><a name="line-573"></a><a name="sequenceWithIOErrors_"><a href="System.Directory.html#sequenceWithIOErrors_"><span class="hs-identifier">sequenceWithIOErrors_</span></a></a><span> </span><a name="local-6989586621679041893"><a href="#local-6989586621679041893"><span class="hs-identifier">actions</span></a></a><span> </span><span class="hs-glyph">=</span><span> </span><a href="#local-6989586621679041894"><span class="hs-identifier hs-var">go</span></a><span> </span><span class="hs-special">(</span><a href="../base-4.10.0.0/src/%{MODULE/./-}.html#%{NAME}/Data.Either.html#Right"><span class="hs-identifier hs-var">Right</span></a><span> </span><span class="hs-special">(</span><span class="hs-special">)</span><span class="hs-special">)</span><span> </span><a href="#local-6989586621679041893"><span class="hs-identifier hs-var">actions</span></a><span>
</span><a name="line-574"></a><span>  </span><span class="hs-keyword">where</span><span>
</span><a name="line-575"></a><span>
</span><a name="line-576"></a><span>    </span><span class="hs-identifier">go</span><span> </span><span class="hs-glyph">::</span><span> </span><a href="../base-4.10.0.0/src/%{MODULE/./-}.html#%{NAME}/Data.Either.html#Either"><span class="hs-identifier hs-type">Either</span></a><span> </span><a href="../base-4.10.0.0/src/%{MODULE/./-}.html#%{NAME}/GHC.IO.Exception.html#IOError"><span class="hs-identifier hs-type">IOError</span></a><span> </span><span class="hs-special">(</span><span class="hs-special">)</span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="hs-special">[</span><span class="hs-identifier hs-type">IO</span><span> </span><span class="hs-special">(</span><span class="hs-special">)</span><span class="hs-special">]</span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="hs-identifier hs-type">IO</span><span> </span><span class="hs-special">(</span><span class="hs-special">)</span><span>
</span><a name="line-577"></a><span>    </span><a name="local-6989586621679041894"><a href="#local-6989586621679041894"><span class="hs-identifier">go</span></a></a><span> </span><span class="hs-special">(</span><a href="../base-4.10.0.0/src/%{MODULE/./-}.html#%{NAME}/Data.Either.html#Left"><span class="hs-identifier hs-var">Left</span></a><span> </span><a name="local-6989586621679041898"><a href="#local-6989586621679041898"><span class="hs-identifier">e</span></a></a><span class="hs-special">)</span><span>   </span><span class="hs-special">[</span><span class="hs-special">]</span><span>       </span><span class="hs-glyph">=</span><span> </span><a href="../base-4.10.0.0/src/%{MODULE/./-}.html#%{NAME}/GHC.IO.Exception.html#ioError"><span class="hs-identifier hs-var">ioError</span></a><span> </span><a href="#local-6989586621679041898"><span class="hs-identifier hs-var">e</span></a><span>
</span><a name="line-578"></a><span>    </span><span class="hs-identifier">go</span><span> </span><span class="hs-special">(</span><a href="../base-4.10.0.0/src/%{MODULE/./-}.html#%{NAME}/Data.Either.html#Right"><span class="hs-identifier hs-var">Right</span></a><span> </span><span class="hs-special">(</span><span class="hs-special">)</span><span class="hs-special">)</span><span> </span><span class="hs-special">[</span><span class="hs-special">]</span><span>       </span><span class="hs-glyph">=</span><span> </span><a href="../base-4.10.0.0/src/%{MODULE/./-}.html#%{NAME}/GHC.Base.html#return"><span class="hs-identifier hs-var">return</span></a><span> </span><span class="hs-special">(</span><span class="hs-special">)</span><span>
</span><a name="line-579"></a><span>    </span><span class="hs-identifier">go</span><span> </span><a name="local-6989586621679041899"><a href="#local-6989586621679041899"><span class="hs-identifier">s</span></a></a><span>          </span><span class="hs-special">(</span><a name="local-6989586621679041900"><a href="#local-6989586621679041900"><span class="hs-identifier">m</span></a></a><span> </span><span class="hs-glyph">:</span><span> </span><a name="local-6989586621679041901"><a href="#local-6989586621679041901"><span class="hs-identifier">ms</span></a></a><span class="hs-special">)</span><span> </span><span class="hs-glyph">=</span><span> </span><a href="#local-6989586621679041899"><span class="hs-identifier hs-var">s</span></a><span> </span><span class="hs-special">`</span><span class="hs-identifier hs-var">seq</span><span class="hs-special">`</span><span> </span><span class="hs-keyword">do</span><span>
</span><a name="line-580"></a><span>      </span><a name="local-6989586621679041902"><a href="#local-6989586621679041902"><span class="hs-identifier">r</span></a></a><span> </span><span class="hs-glyph">&lt;-</span><span> </span><a href="../base-4.10.0.0/src/%{MODULE/./-}.html#%{NAME}/System.IO.Error.html#tryIOError"><span class="hs-identifier hs-var">tryIOError</span></a><span> </span><a href="#local-6989586621679041900"><span class="hs-identifier hs-var">m</span></a><span>
</span><a name="line-581"></a><span>      </span><a href="#local-6989586621679041894"><span class="hs-identifier hs-var">go</span></a><span> </span><span class="hs-special">(</span><a href="#local-6989586621679041895"><span class="hs-identifier hs-var">thenEither</span></a><span> </span><a href="#local-6989586621679041899"><span class="hs-identifier hs-var">s</span></a><span> </span><a href="#local-6989586621679041902"><span class="hs-identifier hs-var">r</span></a><span class="hs-special">)</span><span> </span><a href="#local-6989586621679041901"><span class="hs-identifier hs-var">ms</span></a><span>
</span><a name="line-582"></a><span>
</span><a name="line-583"></a><span>    </span><span class="hs-comment">-- equivalent to (*&gt;) for Either, defined here to retain compatibility</span><span>
</span><a name="line-584"></a><span>    </span><span class="hs-comment">-- with base prior to 4.3</span><span>
</span><a name="line-585"></a><span>    </span><span class="hs-identifier">thenEither</span><span> </span><span class="hs-glyph">::</span><span> </span><a href="../base-4.10.0.0/src/%{MODULE/./-}.html#%{NAME}/Data.Either.html#Either"><span class="hs-identifier hs-type">Either</span></a><span> </span><a href="#local-6989586621679041896"><span class="hs-identifier hs-type">b</span></a><span> </span><a href="#local-6989586621679041897"><span class="hs-identifier hs-type">a</span></a><span> </span><span class="hs-glyph">-&gt;</span><span> </span><a href="../base-4.10.0.0/src/%{MODULE/./-}.html#%{NAME}/Data.Either.html#Either"><span class="hs-identifier hs-type">Either</span></a><span> </span><a href="#local-6989586621679041896"><span class="hs-identifier hs-type">b</span></a><span> </span><a href="#local-6989586621679041897"><span class="hs-identifier hs-type">a</span></a><span> </span><span class="hs-glyph">-&gt;</span><span> </span><a href="../base-4.10.0.0/src/%{MODULE/./-}.html#%{NAME}/Data.Either.html#Either"><span class="hs-identifier hs-type">Either</span></a><span> </span><a href="#local-6989586621679041896"><span class="hs-identifier hs-type">b</span></a><span> </span><a href="#local-6989586621679041897"><span class="hs-identifier hs-type">a</span></a><span>
</span><a name="line-586"></a><span>    </span><a name="local-6989586621679041895"><a href="#local-6989586621679041895"><span class="hs-identifier">thenEither</span></a></a><span> </span><a name="local-6989586621679041903"><a href="#local-6989586621679041903"><span class="hs-identifier">x</span></a></a><span class="hs-glyph">@</span><span class="hs-special">(</span><a href="../base-4.10.0.0/src/%{MODULE/./-}.html#%{NAME}/Data.Either.html#Left"><span class="hs-identifier hs-var">Left</span></a><span> </span><span class="hs-identifier">_</span><span class="hs-special">)</span><span> </span><span class="hs-identifier">_</span><span> </span><span class="hs-glyph">=</span><span> </span><a href="#local-6989586621679041903"><span class="hs-identifier hs-var">x</span></a><span>
</span><a name="line-587"></a><span>    </span><span class="hs-identifier">thenEither</span><span> </span><span class="hs-identifier">_</span><span>          </span><a name="local-6989586621679041904"><a href="#local-6989586621679041904"><span class="hs-identifier">y</span></a></a><span> </span><span class="hs-glyph">=</span><span> </span><a href="#local-6989586621679041904"><span class="hs-identifier hs-var">y</span></a><span>
</span><a name="line-588"></a><span>
</span><a name="line-589"></a><span class="hs-comment">{- |'removeFile' /file/ removes the directory entry for an existing file
/file/, where /file/ is not itself a directory. The
implementation may specify additional constraints which must be
satisfied before a file can be removed (e.g. the file may not be in
use by other processes).

The operation may fail with:

* 'HardwareFault'
A physical I\/O error has occurred.
@[EIO]@

* 'InvalidArgument'
The operand is not a valid file name.
@[ENAMETOOLONG, ELOOP]@

* 'isDoesNotExistError' \/ 'NoSuchThing'
The file does not exist.
@[ENOENT, ENOTDIR]@

* 'isPermissionError' \/ 'PermissionDenied'
The process has insufficient privileges to perform the operation.
@[EROFS, EACCES, EPERM]@

* 'UnsatisfiedConstraints'
Implementation-dependent constraints are not satisfied.
@[EBUSY]@

* 'InappropriateType'
The operand refers to an existing directory.
@[EPERM, EINVAL]@

-}</span><span>
</span><a name="line-622"></a><span>
</span><a name="line-623"></a><span class="hs-identifier">removeFile</span><span> </span><span class="hs-glyph">::</span><span> </span><a href="../base-4.10.0.0/src/%{MODULE/./-}.html#%{NAME}/GHC.IO.html#FilePath"><span class="hs-identifier hs-type">FilePath</span></a><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="hs-identifier hs-type">IO</span><span> </span><span class="hs-special">(</span><span class="hs-special">)</span><span>
</span><a name="line-624"></a><a name="removeFile"><a href="System.Directory.html#removeFile"><span class="hs-identifier">removeFile</span></a></a><span> </span><a name="local-6989586621679041905"><a href="#local-6989586621679041905"><span class="hs-identifier">path</span></a></a><span> </span><span class="hs-glyph">=</span><span>
</span><a name="line-625"></a><span class="hs-cpp">#ifdef mingw32_HOST_OS</span><span>
</span><a name="line-626"></a><span>  </span><span class="hs-identifier">Win32</span><span class="hs-operator">.</span><span class="hs-identifier">deleteFile</span><span> </span><span class="hs-identifier">path</span><span>
</span><a name="line-627"></a><span class="hs-cpp">#else</span><span>
</span><a name="line-628"></a><span>  </span><a href="../unix-2.7.2.1/src/%{MODULE/./-}.html#%{NAME}/System.Posix.Files.html#removeLink"><span class="hs-identifier hs-var">Posix</span><span class="hs-operator hs-var">.</span><span class="hs-identifier hs-var">removeLink</span></a><span> </span><a href="#local-6989586621679041905"><span class="hs-identifier hs-var">path</span></a><span>
</span><a name="line-629"></a><span class="hs-cpp">#endif</span><span>
</span><a name="line-630"></a><span>
</span><a name="line-631"></a><span class="hs-comment">{- |@'renameDirectory' old new@ changes the name of an existing
directory from /old/ to /new/.  If the /new/ directory
already exists, it is atomically replaced by the /old/ directory.
If the /new/ directory is neither the /old/ directory nor an
alias of the /old/ directory, it is removed as if by
'removeDirectory'.  A conformant implementation need not support
renaming directories in all situations (e.g. renaming to an existing
directory, or across different physical devices), but the constraints
must be documented.

On Win32 platforms, @renameDirectory@ fails if the /new/ directory already
exists.

The operation may fail with:

* 'HardwareFault'
A physical I\/O error has occurred.
@[EIO]@

* 'InvalidArgument'
Either operand is not a valid directory name.
@[ENAMETOOLONG, ELOOP]@

* 'isDoesNotExistError' \/ 'NoSuchThing'
The original directory does not exist, or there is no path to the target.
@[ENOENT, ENOTDIR]@

* 'isPermissionError' \/ 'PermissionDenied'
The process has insufficient privileges to perform the operation.
@[EROFS, EACCES, EPERM]@

* 'ResourceExhausted'
Insufficient resources are available to perform the operation.
@[EDQUOT, ENOSPC, ENOMEM, EMLINK]@

* 'UnsatisfiedConstraints'
Implementation-dependent constraints are not satisfied.
@[EBUSY, ENOTEMPTY, EEXIST]@

* 'UnsupportedOperation'
The implementation does not support renaming in this situation.
@[EINVAL, EXDEV]@

* 'InappropriateType'
Either path refers to an existing non-directory object.
@[ENOTDIR, EISDIR]@

-}</span><span>
</span><a name="line-679"></a><span>
</span><a name="line-680"></a><span class="hs-identifier">renameDirectory</span><span> </span><span class="hs-glyph">::</span><span> </span><a href="../base-4.10.0.0/src/%{MODULE/./-}.html#%{NAME}/GHC.IO.html#FilePath"><span class="hs-identifier hs-type">FilePath</span></a><span> </span><span class="hs-glyph">-&gt;</span><span> </span><a href="../base-4.10.0.0/src/%{MODULE/./-}.html#%{NAME}/GHC.IO.html#FilePath"><span class="hs-identifier hs-type">FilePath</span></a><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="hs-identifier hs-type">IO</span><span> </span><span class="hs-special">(</span><span class="hs-special">)</span><span>
</span><a name="line-681"></a><a name="renameDirectory"><a href="System.Directory.html#renameDirectory"><span class="hs-identifier">renameDirectory</span></a></a><span> </span><a name="local-6989586621679041906"><a href="#local-6989586621679041906"><span class="hs-identifier">opath</span></a></a><span> </span><a name="local-6989586621679041907"><a href="#local-6989586621679041907"><span class="hs-identifier">npath</span></a></a><span> </span><span class="hs-glyph">=</span><span>
</span><a name="line-682"></a><span>   </span><span class="hs-comment">-- XXX this test isn't performed atomically with the following rename</span><span>
</span><a name="line-683"></a><span class="hs-cpp">#ifdef mingw32_HOST_OS</span><span>
</span><a name="line-684"></a><span>   </span><span class="hs-comment">-- ToDo: use Win32 API</span><span>
</span><a name="line-685"></a><span>   </span><span class="hs-identifier">withFileStatus</span><span> </span><span class="hs-string">&quot;renameDirectory&quot;</span><span> </span><span class="hs-identifier">opath</span><span> </span><span class="hs-operator">$</span><span> </span><span class="hs-glyph">\</span><span class="hs-identifier">st</span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="hs-keyword">do</span><span>
</span><a name="line-686"></a><span>   </span><span class="hs-identifier">is_dir</span><span> </span><span class="hs-glyph">&lt;-</span><span> </span><span class="hs-identifier">isDirectory</span><span> </span><span class="hs-identifier">st</span><span>
</span><a name="line-687"></a><span class="hs-cpp">#else</span><span>
</span><a name="line-688"></a><span>   </span><span class="hs-keyword">do</span><span>
</span><a name="line-689"></a><span>   </span><a name="local-6989586621679041908"><a href="#local-6989586621679041908"><span class="hs-identifier">stat</span></a></a><span> </span><span class="hs-glyph">&lt;-</span><span> </span><a href="../unix-2.7.2.1/src/%{MODULE/./-}.html#%{NAME}/System.Posix.Files.html#getFileStatus"><span class="hs-identifier hs-var">Posix</span><span class="hs-operator hs-var">.</span><span class="hs-identifier hs-var">getFileStatus</span></a><span> </span><a href="#local-6989586621679041906"><span class="hs-identifier hs-var">opath</span></a><span>
</span><a name="line-690"></a><span>   </span><span class="hs-keyword">let</span><span> </span><a name="local-6989586621679041909"><a href="#local-6989586621679041909"><span class="hs-identifier">is_dir</span></a></a><span> </span><span class="hs-glyph">=</span><span> </span><a href="../unix-2.7.2.1/src/%{MODULE/./-}.html#%{NAME}/System.Posix.Files.Common.html#fileMode"><span class="hs-identifier hs-var">Posix</span><span class="hs-operator hs-var">.</span><span class="hs-identifier hs-var">fileMode</span></a><span> </span><a href="#local-6989586621679041908"><span class="hs-identifier hs-var">stat</span></a><span> </span><a href="../base-4.10.0.0/src/%{MODULE/./-}.html#%{NAME}/Data.Bits.html#.%26."><span class="hs-operator hs-var">.&amp;.</span></a><span> </span><a href="../unix-2.7.2.1/src/%{MODULE/./-}.html#%{NAME}/System.Posix.Files.Common.html#directoryMode"><span class="hs-identifier hs-var">Posix</span><span class="hs-operator hs-var">.</span><span class="hs-identifier hs-var">directoryMode</span></a><span> </span><span class="hs-operator hs-var">/=</span><span> </span><span class="hs-number">0</span><span>
</span><a name="line-691"></a><span class="hs-cpp">#endif</span><span>
</span><a name="line-692"></a><span>   </span><a href="../base-4.10.0.0/src/%{MODULE/./-}.html#%{NAME}/GHC.Base.html#when"><span class="hs-identifier hs-var">when</span></a><span> </span><span class="hs-special">(</span><span class="hs-identifier hs-var">not</span><span> </span><a href="#local-6989586621679041909"><span class="hs-identifier hs-var">is_dir</span></a><span class="hs-special">)</span><span> </span><a href="../base-4.10.0.0/src/%{MODULE/./-}.html#%{NAME}/GHC.Base.html#%24"><span class="hs-operator hs-var">$</span></a><span> </span><span class="hs-keyword">do</span><span>
</span><a name="line-693"></a><span>     </span><a href="../base-4.10.0.0/src/%{MODULE/./-}.html#%{NAME}/GHC.IO.Exception.html#ioError"><span class="hs-identifier hs-var">ioError</span></a><span> </span><a href="../base-4.10.0.0/src/%{MODULE/./-}.html#%{NAME}/GHC.Base.html#."><span class="hs-operator hs-var">.</span></a><span> </span><span class="hs-special">(</span><span class="hs-special">`</span><a href="../base-4.10.0.0/src/%{MODULE/./-}.html#%{NAME}/System.IO.Error.html#ioeSetErrorString"><span class="hs-identifier hs-var">ioeSetErrorString</span></a><span class="hs-special">`</span><span> </span><span class="hs-string">&quot;not a directory&quot;</span><span class="hs-special">)</span><span> </span><a href="../base-4.10.0.0/src/%{MODULE/./-}.html#%{NAME}/GHC.Base.html#%24"><span class="hs-operator hs-var">$</span></a><span>
</span><a name="line-694"></a><span>       </span><span class="hs-special">(</span><a href="../base-4.10.0.0/src/%{MODULE/./-}.html#%{NAME}/System.IO.Error.html#mkIOError"><span class="hs-identifier hs-var">mkIOError</span></a><span> </span><a href="../base-4.10.0.0/src/%{MODULE/./-}.html#%{NAME}/GHC.IO.Exception.html#InappropriateType"><span class="hs-identifier hs-var">InappropriateType</span></a><span> </span><span class="hs-string">&quot;renameDirectory&quot;</span><span> </span><a href="../base-4.10.0.0/src/%{MODULE/./-}.html#%{NAME}/GHC.Base.html#Nothing"><span class="hs-identifier hs-var">Nothing</span></a><span> </span><span class="hs-special">(</span><a href="../base-4.10.0.0/src/%{MODULE/./-}.html#%{NAME}/GHC.Base.html#Just"><span class="hs-identifier hs-var">Just</span></a><span> </span><a href="#local-6989586621679041906"><span class="hs-identifier hs-var">opath</span></a><span class="hs-special">)</span><span class="hs-special">)</span><span>
</span><a name="line-695"></a><span>   </span><a href="System.Directory.html#renamePath"><span class="hs-identifier hs-var">renamePath</span></a><span> </span><a href="#local-6989586621679041906"><span class="hs-identifier hs-var">opath</span></a><span> </span><a href="#local-6989586621679041907"><span class="hs-identifier hs-var">npath</span></a><span>
</span><a name="line-696"></a><span>
</span><a name="line-697"></a><span class="hs-comment">{- |@'renameFile' old new@ changes the name of an existing file system
object from /old/ to /new/.  If the /new/ object already
exists, it is atomically replaced by the /old/ object.  Neither
path may refer to an existing directory.  A conformant implementation
need not support renaming files in all situations (e.g. renaming
across different physical devices), but the constraints must be
documented.

The operation may fail with:

* 'HardwareFault'
A physical I\/O error has occurred.
@[EIO]@

* 'InvalidArgument'
Either operand is not a valid file name.
@[ENAMETOOLONG, ELOOP]@

* 'isDoesNotExistError' \/ 'NoSuchThing'
The original file does not exist, or there is no path to the target.
@[ENOENT, ENOTDIR]@

* 'isPermissionError' \/ 'PermissionDenied'
The process has insufficient privileges to perform the operation.
@[EROFS, EACCES, EPERM]@

* 'ResourceExhausted'
Insufficient resources are available to perform the operation.
@[EDQUOT, ENOSPC, ENOMEM, EMLINK]@

* 'UnsatisfiedConstraints'
Implementation-dependent constraints are not satisfied.
@[EBUSY]@

* 'UnsupportedOperation'
The implementation does not support renaming in this situation.
@[EXDEV]@

* 'InappropriateType'
Either path refers to an existing directory.
@[ENOTDIR, EISDIR, EINVAL, EEXIST, ENOTEMPTY]@

-}</span><span>
</span><a name="line-740"></a><span>
</span><a name="line-741"></a><span class="hs-identifier">renameFile</span><span> </span><span class="hs-glyph">::</span><span> </span><a href="../base-4.10.0.0/src/%{MODULE/./-}.html#%{NAME}/GHC.IO.html#FilePath"><span class="hs-identifier hs-type">FilePath</span></a><span> </span><span class="hs-glyph">-&gt;</span><span> </span><a href="../base-4.10.0.0/src/%{MODULE/./-}.html#%{NAME}/GHC.IO.html#FilePath"><span class="hs-identifier hs-type">FilePath</span></a><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="hs-identifier hs-type">IO</span><span> </span><span class="hs-special">(</span><span class="hs-special">)</span><span>
</span><a name="line-742"></a><a name="renameFile"><a href="System.Directory.html#renameFile"><span class="hs-identifier">renameFile</span></a></a><span> </span><a name="local-6989586621679041910"><a href="#local-6989586621679041910"><span class="hs-identifier">opath</span></a></a><span> </span><a name="local-6989586621679041911"><a href="#local-6989586621679041911"><span class="hs-identifier">npath</span></a></a><span> </span><span class="hs-glyph">=</span><span> </span><span class="hs-special">(</span><span class="hs-special">`</span><a href="System.Directory.html#ioeAddLocation"><span class="hs-identifier hs-var">ioeAddLocation</span></a><span class="hs-special">`</span><span> </span><span class="hs-string">&quot;renameFile&quot;</span><span class="hs-special">)</span><span> </span><span class="hs-special">`</span><a href="../base-4.10.0.0/src/%{MODULE/./-}.html#%{NAME}/System.IO.Error.html#modifyIOError"><span class="hs-identifier hs-var">modifyIOError</span></a><span class="hs-special">`</span><span> </span><span class="hs-keyword">do</span><span>
</span><a name="line-743"></a><span>   </span><span class="hs-comment">-- XXX the tests are not performed atomically with the rename</span><span>
</span><a name="line-744"></a><span>   </span><a href="#local-6989586621679041912"><span class="hs-identifier hs-var">checkNotDir</span></a><span> </span><a href="#local-6989586621679041910"><span class="hs-identifier hs-var">opath</span></a><span>
</span><a name="line-745"></a><span>   </span><a href="System.Directory.html#renamePath"><span class="hs-identifier hs-var">renamePath</span></a><span> </span><a href="#local-6989586621679041910"><span class="hs-identifier hs-var">opath</span></a><span> </span><a href="#local-6989586621679041911"><span class="hs-identifier hs-var">npath</span></a><span>
</span><a name="line-746"></a><span>     </span><span class="hs-comment">-- The underlying rename implementation can throw odd exceptions when the</span><span>
</span><a name="line-747"></a><span>     </span><span class="hs-comment">-- destination is a directory.  For example, Windows typically throws a</span><span>
</span><a name="line-748"></a><span>     </span><span class="hs-comment">-- permission error, while POSIX systems may throw a resource busy error</span><span>
</span><a name="line-749"></a><span>     </span><span class="hs-comment">-- if one of the paths refers to the current directory.  In these cases,</span><span>
</span><a name="line-750"></a><span>     </span><span class="hs-comment">-- we check if the destination is a directory and, if so, throw an</span><span>
</span><a name="line-751"></a><span>     </span><span class="hs-comment">-- InappropriateType error.</span><span>
</span><a name="line-752"></a><span>     </span><span class="hs-special">`</span><a href="../base-4.10.0.0/src/%{MODULE/./-}.html#%{NAME}/System.IO.Error.html#catchIOError"><span class="hs-identifier hs-var">catchIOError</span></a><span class="hs-special">`</span><span> </span><span class="hs-glyph">\</span><span> </span><a name="local-6989586621679041917"><a href="#local-6989586621679041917"><span class="hs-identifier">err</span></a></a><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="hs-keyword">do</span><span>
</span><a name="line-753"></a><span>       </span><a href="#local-6989586621679041912"><span class="hs-identifier hs-var">checkNotDir</span></a><span> </span><a href="#local-6989586621679041911"><span class="hs-identifier hs-var">npath</span></a><span>
</span><a name="line-754"></a><span>       </span><a href="../base-4.10.0.0/src/%{MODULE/./-}.html#%{NAME}/GHC.IO.Exception.html#ioError"><span class="hs-identifier hs-var">ioError</span></a><span> </span><a href="#local-6989586621679041917"><span class="hs-identifier hs-var">err</span></a><span>
</span><a name="line-755"></a><span>   </span><span class="hs-keyword">where</span><span> </span><a name="local-6989586621679041912"><a href="#local-6989586621679041912"><span class="hs-identifier">checkNotDir</span></a></a><span> </span><a name="local-6989586621679041914"><a href="#local-6989586621679041914"><span class="hs-identifier">path</span></a></a><span> </span><span class="hs-glyph">=</span><span> </span><span class="hs-keyword">do</span><span>
</span><a name="line-756"></a><span>           </span><a name="local-6989586621679041915"><a href="#local-6989586621679041915"><span class="hs-identifier">dirType</span></a></a><span> </span><span class="hs-glyph">&lt;-</span><span> </span><a href="System.Directory.html#getDirectoryType"><span class="hs-identifier hs-var">getDirectoryType</span></a><span> </span><a href="#local-6989586621679041914"><span class="hs-identifier hs-var">path</span></a><span>
</span><a name="line-757"></a><span>                      </span><span class="hs-special">`</span><a href="../base-4.10.0.0/src/%{MODULE/./-}.html#%{NAME}/System.IO.Error.html#catchIOError"><span class="hs-identifier hs-var">catchIOError</span></a><span class="hs-special">`</span><span> </span><span class="hs-glyph">\</span><span> </span><span class="hs-identifier">_</span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><a href="../base-4.10.0.0/src/%{MODULE/./-}.html#%{NAME}/GHC.Base.html#return"><span class="hs-identifier hs-var">return</span></a><span> </span><a href="System.Directory.html#NotDirectory"><span class="hs-identifier hs-var">NotDirectory</span></a><span>
</span><a name="line-758"></a><span>           </span><span class="hs-keyword">case</span><span> </span><a href="#local-6989586621679041915"><span class="hs-identifier hs-var">dirType</span></a><span> </span><span class="hs-keyword">of</span><span>
</span><a name="line-759"></a><span>             </span><a href="System.Directory.html#Directory"><span class="hs-identifier hs-var">Directory</span></a><span>     </span><span class="hs-glyph">-&gt;</span><span> </span><a href="#local-6989586621679041913"><span class="hs-identifier hs-var">errIsDir</span></a><span> </span><a href="#local-6989586621679041914"><span class="hs-identifier hs-var">path</span></a><span>
</span><a name="line-760"></a><span>             </span><a href="System.Directory.html#DirectoryLink"><span class="hs-identifier hs-var">DirectoryLink</span></a><span> </span><span class="hs-glyph">-&gt;</span><span> </span><a href="#local-6989586621679041913"><span class="hs-identifier hs-var">errIsDir</span></a><span> </span><a href="#local-6989586621679041914"><span class="hs-identifier hs-var">path</span></a><span>
</span><a name="line-761"></a><span>             </span><a href="System.Directory.html#NotDirectory"><span class="hs-identifier hs-var">NotDirectory</span></a><span>  </span><span class="hs-glyph">-&gt;</span><span> </span><a href="../base-4.10.0.0/src/%{MODULE/./-}.html#%{NAME}/GHC.Base.html#return"><span class="hs-identifier hs-var">return</span></a><span> </span><span class="hs-special">(</span><span class="hs-special">)</span><span>
</span><a name="line-762"></a><span>         </span><a name="local-6989586621679041913"><a href="#local-6989586621679041913"><span class="hs-identifier">errIsDir</span></a></a><span> </span><a name="local-6989586621679041916"><a href="#local-6989586621679041916"><span class="hs-identifier">path</span></a></a><span> </span><span class="hs-glyph">=</span><span> </span><a href="../base-4.10.0.0/src/%{MODULE/./-}.html#%{NAME}/GHC.IO.Exception.html#ioError"><span class="hs-identifier hs-var">ioError</span></a><span> </span><a href="../base-4.10.0.0/src/%{MODULE/./-}.html#%{NAME}/GHC.Base.html#."><span class="hs-operator hs-var">.</span></a><span> </span><span class="hs-special">(</span><span class="hs-special">`</span><a href="../base-4.10.0.0/src/%{MODULE/./-}.html#%{NAME}/System.IO.Error.html#ioeSetErrorString"><span class="hs-identifier hs-var">ioeSetErrorString</span></a><span class="hs-special">`</span><span> </span><span class="hs-string">&quot;is a directory&quot;</span><span class="hs-special">)</span><span> </span><a href="../base-4.10.0.0/src/%{MODULE/./-}.html#%{NAME}/GHC.Base.html#%24"><span class="hs-operator hs-var">$</span></a><span>
</span><a name="line-763"></a><span>                         </span><a href="../base-4.10.0.0/src/%{MODULE/./-}.html#%{NAME}/System.IO.Error.html#mkIOError"><span class="hs-identifier hs-var">mkIOError</span></a><span> </span><a href="../base-4.10.0.0/src/%{MODULE/./-}.html#%{NAME}/GHC.IO.Exception.html#InappropriateType"><span class="hs-identifier hs-var">InappropriateType</span></a><span> </span><span class="hs-string">&quot;&quot;</span><span> </span><a href="../base-4.10.0.0/src/%{MODULE/./-}.html#%{NAME}/GHC.Base.html#Nothing"><span class="hs-identifier hs-var">Nothing</span></a><span> </span><span class="hs-special">(</span><a href="../base-4.10.0.0/src/%{MODULE/./-}.html#%{NAME}/GHC.Base.html#Just"><span class="hs-identifier hs-var">Just</span></a><span> </span><a href="#local-6989586621679041916"><span class="hs-identifier hs-var">path</span></a><span class="hs-special">)</span><span>
</span><a name="line-764"></a><span>
</span><a name="line-765"></a><span class="hs-comment">-- | Rename a file or directory.  If the destination path already exists, it</span><span>
</span><a name="line-766"></a><span class="hs-comment">-- is replaced atomically.  The destination path must not point to an existing</span><span>
</span><a name="line-767"></a><span class="hs-comment">-- directory.  A conformant implementation need not support renaming files in</span><span>
</span><a name="line-768"></a><span class="hs-comment">-- all situations (e.g. renaming across different physical devices), but the</span><span>
</span><a name="line-769"></a><span class="hs-comment">-- constraints must be documented.</span><span>
</span><a name="line-770"></a><span class="hs-comment">--</span><span>
</span><a name="line-771"></a><span class="hs-comment">-- The operation may fail with:</span><span>
</span><a name="line-772"></a><span class="hs-comment">--</span><span>
</span><a name="line-773"></a><span class="hs-comment">-- * 'HardwareFault'</span><span>
</span><a name="line-774"></a><span class="hs-comment">-- A physical I\/O error has occurred.</span><span>
</span><a name="line-775"></a><span class="hs-comment">-- @[EIO]@</span><span>
</span><a name="line-776"></a><span class="hs-comment">--</span><span>
</span><a name="line-777"></a><span class="hs-comment">-- * 'InvalidArgument'</span><span>
</span><a name="line-778"></a><span class="hs-comment">-- Either operand is not a valid file name.</span><span>
</span><a name="line-779"></a><span class="hs-comment">-- @[ENAMETOOLONG, ELOOP]@</span><span>
</span><a name="line-780"></a><span class="hs-comment">--</span><span>
</span><a name="line-781"></a><span class="hs-comment">-- * 'isDoesNotExistError' \/ 'NoSuchThing'</span><span>
</span><a name="line-782"></a><span class="hs-comment">-- The original file does not exist, or there is no path to the target.</span><span>
</span><a name="line-783"></a><span class="hs-comment">-- @[ENOENT, ENOTDIR]@</span><span>
</span><a name="line-784"></a><span class="hs-comment">--</span><span>
</span><a name="line-785"></a><span class="hs-comment">-- * 'isPermissionError' \/ 'PermissionDenied'</span><span>
</span><a name="line-786"></a><span class="hs-comment">-- The process has insufficient privileges to perform the operation.</span><span>
</span><a name="line-787"></a><span class="hs-comment">-- @[EROFS, EACCES, EPERM]@</span><span>
</span><a name="line-788"></a><span class="hs-comment">--</span><span>
</span><a name="line-789"></a><span class="hs-comment">-- * 'ResourceExhausted'</span><span>
</span><a name="line-790"></a><span class="hs-comment">-- Insufficient resources are available to perform the operation.</span><span>
</span><a name="line-791"></a><span class="hs-comment">-- @[EDQUOT, ENOSPC, ENOMEM, EMLINK]@</span><span>
</span><a name="line-792"></a><span class="hs-comment">--</span><span>
</span><a name="line-793"></a><span class="hs-comment">-- * 'UnsatisfiedConstraints'</span><span>
</span><a name="line-794"></a><span class="hs-comment">-- Implementation-dependent constraints are not satisfied.</span><span>
</span><a name="line-795"></a><span class="hs-comment">-- @[EBUSY]@</span><span>
</span><a name="line-796"></a><span class="hs-comment">--</span><span>
</span><a name="line-797"></a><span class="hs-comment">-- * 'UnsupportedOperation'</span><span>
</span><a name="line-798"></a><span class="hs-comment">-- The implementation does not support renaming in this situation.</span><span>
</span><a name="line-799"></a><span class="hs-comment">-- @[EXDEV]@</span><span>
</span><a name="line-800"></a><span class="hs-comment">--</span><span>
</span><a name="line-801"></a><span class="hs-comment">-- * 'InappropriateType'</span><span>
</span><a name="line-802"></a><span class="hs-comment">-- Either the destination path refers to an existing directory, or one of the</span><span>
</span><a name="line-803"></a><span class="hs-comment">-- parent segments in the destination path is not a directory.</span><span>
</span><a name="line-804"></a><span class="hs-comment">-- @[ENOTDIR, EISDIR, EINVAL, EEXIST, ENOTEMPTY]@</span><span>
</span><a name="line-805"></a><span class="hs-comment">--</span><span>
</span><a name="line-806"></a><span class="hs-comment">-- @since 1.2.7.0</span><span>
</span><a name="line-807"></a><span class="hs-identifier">renamePath</span><span> </span><span class="hs-glyph">::</span><span> </span><a href="../base-4.10.0.0/src/%{MODULE/./-}.html#%{NAME}/GHC.IO.html#FilePath"><span class="hs-identifier hs-type">FilePath</span></a><span>                  </span><span class="hs-comment">-- ^ Old path</span><span>
</span><a name="line-808"></a><span>           </span><span class="hs-glyph">-&gt;</span><span> </span><a href="../base-4.10.0.0/src/%{MODULE/./-}.html#%{NAME}/GHC.IO.html#FilePath"><span class="hs-identifier hs-type">FilePath</span></a><span>                  </span><span class="hs-comment">-- ^ New path</span><span>
</span><a name="line-809"></a><span>           </span><span class="hs-glyph">-&gt;</span><span> </span><span class="hs-identifier hs-type">IO</span><span> </span><span class="hs-special">(</span><span class="hs-special">)</span><span>
</span><a name="line-810"></a><a name="renamePath"><a href="System.Directory.html#renamePath"><span class="hs-identifier">renamePath</span></a></a><span> </span><a name="local-6989586621679041918"><a href="#local-6989586621679041918"><span class="hs-identifier">opath</span></a></a><span> </span><a name="local-6989586621679041919"><a href="#local-6989586621679041919"><span class="hs-identifier">npath</span></a></a><span> </span><span class="hs-glyph">=</span><span> </span><span class="hs-special">(</span><span class="hs-special">`</span><a href="System.Directory.html#ioeAddLocation"><span class="hs-identifier hs-var">ioeAddLocation</span></a><span class="hs-special">`</span><span> </span><span class="hs-string">&quot;renamePath&quot;</span><span class="hs-special">)</span><span> </span><span class="hs-special">`</span><a href="../base-4.10.0.0/src/%{MODULE/./-}.html#%{NAME}/System.IO.Error.html#modifyIOError"><span class="hs-identifier hs-var">modifyIOError</span></a><span class="hs-special">`</span><span> </span><span class="hs-keyword">do</span><span>
</span><a name="line-811"></a><span class="hs-cpp">#ifdef mingw32_HOST_OS</span><span>
</span><a name="line-812"></a><span>   </span><span class="hs-identifier">Win32</span><span class="hs-operator">.</span><span class="hs-identifier">moveFileEx</span><span> </span><span class="hs-identifier">opath</span><span> </span><span class="hs-identifier">npath</span><span> </span><span class="hs-identifier">Win32</span><span class="hs-operator">.</span><span class="hs-identifier">mOVEFILE_REPLACE_EXISTING</span><span>
</span><a name="line-813"></a><span class="hs-cpp">#else</span><span>
</span><a name="line-814"></a><span>   </span><a href="../unix-2.7.2.1/src/%{MODULE/./-}.html#%{NAME}/System.Posix.Files.html#rename"><span class="hs-identifier hs-var">Posix</span><span class="hs-operator hs-var">.</span><span class="hs-identifier hs-var">rename</span></a><span> </span><a href="#local-6989586621679041918"><span class="hs-identifier hs-var">opath</span></a><span> </span><a href="#local-6989586621679041919"><span class="hs-identifier hs-var">npath</span></a><span>
</span><a name="line-815"></a><span class="hs-cpp">#endif</span><span>
</span><a name="line-816"></a><span>
</span><a name="line-817"></a><span class="hs-comment">-- | Copy a file with its permissions.  If the destination file already exists,</span><span>
</span><a name="line-818"></a><span class="hs-comment">-- it is replaced atomically.  Neither path may refer to an existing</span><span>
</span><a name="line-819"></a><span class="hs-comment">-- directory.  No exceptions are thrown if the permissions could not be</span><span>
</span><a name="line-820"></a><span class="hs-comment">-- copied.</span><span>
</span><a name="line-821"></a><span class="hs-identifier">copyFile</span><span> </span><span class="hs-glyph">::</span><span> </span><a href="../base-4.10.0.0/src/%{MODULE/./-}.html#%{NAME}/GHC.IO.html#FilePath"><span class="hs-identifier hs-type">FilePath</span></a><span>                    </span><span class="hs-comment">-- ^ Source filename</span><span>
</span><a name="line-822"></a><span>         </span><span class="hs-glyph">-&gt;</span><span> </span><a href="../base-4.10.0.0/src/%{MODULE/./-}.html#%{NAME}/GHC.IO.html#FilePath"><span class="hs-identifier hs-type">FilePath</span></a><span>                    </span><span class="hs-comment">-- ^ Destination filename</span><span>
</span><a name="line-823"></a><span>         </span><span class="hs-glyph">-&gt;</span><span> </span><span class="hs-identifier hs-type">IO</span><span> </span><span class="hs-special">(</span><span class="hs-special">)</span><span>
</span><a name="line-824"></a><a name="copyFile"><a href="System.Directory.html#copyFile"><span class="hs-identifier">copyFile</span></a></a><span> </span><a name="local-6989586621679041920"><a href="#local-6989586621679041920"><span class="hs-identifier">fromFPath</span></a></a><span> </span><a name="local-6989586621679041921"><a href="#local-6989586621679041921"><span class="hs-identifier">toFPath</span></a></a><span> </span><span class="hs-glyph">=</span><span>
</span><a name="line-825"></a><span>  </span><span class="hs-special">(</span><span class="hs-special">`</span><a href="System.Directory.html#ioeAddLocation"><span class="hs-identifier hs-var">ioeAddLocation</span></a><span class="hs-special">`</span><span> </span><span class="hs-string">&quot;copyFile&quot;</span><span class="hs-special">)</span><span> </span><span class="hs-special">`</span><a href="../base-4.10.0.0/src/%{MODULE/./-}.html#%{NAME}/System.IO.Error.html#modifyIOError"><span class="hs-identifier hs-var">modifyIOError</span></a><span class="hs-special">`</span><span> </span><span class="hs-keyword">do</span><span>
</span><a name="line-826"></a><span>    </span><a href="System.Directory.html#atomicCopyFileContents"><span class="hs-identifier hs-var">atomicCopyFileContents</span></a><span> </span><a href="#local-6989586621679041920"><span class="hs-identifier hs-var">fromFPath</span></a><span> </span><a href="#local-6989586621679041921"><span class="hs-identifier hs-var">toFPath</span></a><span>
</span><a name="line-827"></a><span>      </span><span class="hs-special">(</span><a href="System.Directory.html#ignoreIOExceptions"><span class="hs-identifier hs-var">ignoreIOExceptions</span></a><span> </span><a href="../base-4.10.0.0/src/%{MODULE/./-}.html#%{NAME}/GHC.Base.html#."><span class="hs-operator hs-var">.</span></a><span> </span><a href="System.Directory.html#copyPermissions"><span class="hs-identifier hs-var">copyPermissions</span></a><span> </span><a href="#local-6989586621679041920"><span class="hs-identifier hs-var">fromFPath</span></a><span class="hs-special">)</span><span>
</span><a name="line-828"></a><span>
</span><a name="line-829"></a><span class="hs-cpp">#ifndef mingw32_HOST_OS</span><span>
</span><a name="line-830"></a><span class="hs-comment">-- | Truncate the destination file and then copy the contents of the source</span><span>
</span><a name="line-831"></a><span class="hs-comment">-- file to the destination file.  If the destination file already exists, its</span><span>
</span><a name="line-832"></a><span class="hs-comment">-- attributes shall remain unchanged.  Otherwise, its attributes are reset to</span><span>
</span><a name="line-833"></a><span class="hs-comment">-- the defaults.</span><span>
</span><a name="line-834"></a><span class="hs-identifier">copyFileContents</span><span> </span><span class="hs-glyph">::</span><span> </span><a href="../base-4.10.0.0/src/%{MODULE/./-}.html#%{NAME}/GHC.IO.html#FilePath"><span class="hs-identifier hs-type">FilePath</span></a><span>            </span><span class="hs-comment">-- ^ Source filename</span><span>
</span><a name="line-835"></a><span>                 </span><span class="hs-glyph">-&gt;</span><span> </span><a href="../base-4.10.0.0/src/%{MODULE/./-}.html#%{NAME}/GHC.IO.html#FilePath"><span class="hs-identifier hs-type">FilePath</span></a><span>            </span><span class="hs-comment">-- ^ Destination filename</span><span>
</span><a name="line-836"></a><span>                 </span><span class="hs-glyph">-&gt;</span><span> </span><span class="hs-identifier hs-type">IO</span><span> </span><span class="hs-special">(</span><span class="hs-special">)</span><span>
</span><a name="line-837"></a><a name="copyFileContents"><a href="System.Directory.html#copyFileContents"><span class="hs-identifier">copyFileContents</span></a></a><span> </span><a name="local-6989586621679041922"><a href="#local-6989586621679041922"><span class="hs-identifier">fromFPath</span></a></a><span> </span><a name="local-6989586621679041923"><a href="#local-6989586621679041923"><span class="hs-identifier">toFPath</span></a></a><span> </span><span class="hs-glyph">=</span><span>
</span><a name="line-838"></a><span>  </span><span class="hs-special">(</span><span class="hs-special">`</span><a href="System.Directory.html#ioeAddLocation"><span class="hs-identifier hs-var">ioeAddLocation</span></a><span class="hs-special">`</span><span> </span><span class="hs-string">&quot;copyFileContents&quot;</span><span class="hs-special">)</span><span> </span><span class="hs-special">`</span><a href="../base-4.10.0.0/src/%{MODULE/./-}.html#%{NAME}/System.IO.Error.html#modifyIOError"><span class="hs-identifier hs-var">modifyIOError</span></a><span class="hs-special">`</span><span> </span><span class="hs-keyword">do</span><span>
</span><a name="line-839"></a><span>    </span><a href="../base-4.10.0.0/src/%{MODULE/./-}.html#%{NAME}/System.IO.html#withBinaryFile"><span class="hs-identifier hs-var">withBinaryFile</span></a><span> </span><a href="#local-6989586621679041923"><span class="hs-identifier hs-var">toFPath</span></a><span> </span><a href="../base-4.10.0.0/src/%{MODULE/./-}.html#%{NAME}/GHC.IO.IOMode.html#WriteMode"><span class="hs-identifier hs-var">WriteMode</span></a><span> </span><a href="../base-4.10.0.0/src/%{MODULE/./-}.html#%{NAME}/GHC.Base.html#%24"><span class="hs-operator hs-var">$</span></a><span> </span><span class="hs-glyph">\</span><span> </span><a name="local-6989586621679042133"><a href="#local-6989586621679042133"><span class="hs-identifier">hTo</span></a></a><span> </span><span class="hs-glyph">-&gt;</span><span>
</span><a name="line-840"></a><span>      </span><a href="System.Directory.html#copyFileToHandle"><span class="hs-identifier hs-var">copyFileToHandle</span></a><span> </span><a href="#local-6989586621679041922"><span class="hs-identifier hs-var">fromFPath</span></a><span> </span><a href="#local-6989586621679042133"><span class="hs-identifier hs-var">hTo</span></a><span>
</span><a name="line-841"></a><span class="hs-cpp">#endif</span><span>
</span><a name="line-842"></a><span>
</span><a name="line-843"></a><span class="hs-comment">-- | Copy the contents of a source file to a destination file, replacing the</span><span>
</span><a name="line-844"></a><span class="hs-comment">-- destination file atomically via 'withReplacementFile', resetting the</span><span>
</span><a name="line-845"></a><span class="hs-comment">-- attributes of the destination file to the defaults.</span><span>
</span><a name="line-846"></a><span class="hs-identifier">atomicCopyFileContents</span><span> </span><span class="hs-glyph">::</span><span> </span><a href="../base-4.10.0.0/src/%{MODULE/./-}.html#%{NAME}/GHC.IO.html#FilePath"><span class="hs-identifier hs-type">FilePath</span></a><span>            </span><span class="hs-comment">-- ^ Source filename</span><span>
</span><a name="line-847"></a><span>                       </span><span class="hs-glyph">-&gt;</span><span> </span><a href="../base-4.10.0.0/src/%{MODULE/./-}.html#%{NAME}/GHC.IO.html#FilePath"><span class="hs-identifier hs-type">FilePath</span></a><span>            </span><span class="hs-comment">-- ^ Destination filename</span><span>
</span><a name="line-848"></a><span>                       </span><span class="hs-glyph">-&gt;</span><span> </span><span class="hs-special">(</span><a href="../base-4.10.0.0/src/%{MODULE/./-}.html#%{NAME}/GHC.IO.html#FilePath"><span class="hs-identifier hs-type">FilePath</span></a><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="hs-identifier hs-type">IO</span><span> </span><span class="hs-special">(</span><span class="hs-special">)</span><span class="hs-special">)</span><span> </span><span class="hs-comment">-- ^ Post-action</span><span>
</span><a name="line-849"></a><span>                       </span><span class="hs-glyph">-&gt;</span><span> </span><span class="hs-identifier hs-type">IO</span><span> </span><span class="hs-special">(</span><span class="hs-special">)</span><span>
</span><a name="line-850"></a><a name="atomicCopyFileContents"><a href="System.Directory.html#atomicCopyFileContents"><span class="hs-identifier">atomicCopyFileContents</span></a></a><span> </span><a name="local-6989586621679042134"><a href="#local-6989586621679042134"><span class="hs-identifier">fromFPath</span></a></a><span> </span><a name="local-6989586621679042135"><a href="#local-6989586621679042135"><span class="hs-identifier">toFPath</span></a></a><span> </span><a name="local-6989586621679042136"><a href="#local-6989586621679042136"><span class="hs-identifier">postAction</span></a></a><span> </span><span class="hs-glyph">=</span><span>
</span><a name="line-851"></a><span>  </span><span class="hs-special">(</span><span class="hs-special">`</span><a href="System.Directory.html#ioeAddLocation"><span class="hs-identifier hs-var">ioeAddLocation</span></a><span class="hs-special">`</span><span> </span><span class="hs-string">&quot;atomicCopyFileContents&quot;</span><span class="hs-special">)</span><span> </span><span class="hs-special">`</span><a href="../base-4.10.0.0/src/%{MODULE/./-}.html#%{NAME}/System.IO.Error.html#modifyIOError"><span class="hs-identifier hs-var">modifyIOError</span></a><span class="hs-special">`</span><span> </span><span class="hs-keyword">do</span><span>
</span><a name="line-852"></a><span>    </span><a href="System.Directory.html#withReplacementFile"><span class="hs-identifier hs-var">withReplacementFile</span></a><span> </span><a href="#local-6989586621679042135"><span class="hs-identifier hs-var">toFPath</span></a><span> </span><a href="#local-6989586621679042136"><span class="hs-identifier hs-var">postAction</span></a><span> </span><a href="../base-4.10.0.0/src/%{MODULE/./-}.html#%{NAME}/GHC.Base.html#%24"><span class="hs-operator hs-var">$</span></a><span> </span><span class="hs-glyph">\</span><span> </span><a name="local-6989586621679042137"><a href="#local-6989586621679042137"><span class="hs-identifier">hTo</span></a></a><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="hs-keyword">do</span><span>
</span><a name="line-853"></a><span>      </span><a href="System.Directory.html#copyFileToHandle"><span class="hs-identifier hs-var">copyFileToHandle</span></a><span> </span><a href="#local-6989586621679042134"><span class="hs-identifier hs-var">fromFPath</span></a><span> </span><a href="#local-6989586621679042137"><span class="hs-identifier hs-var">hTo</span></a><span>
</span><a name="line-854"></a><span>
</span><a name="line-855"></a><span class="hs-comment">-- | A helper function useful for replacing files in an atomic manner.  The</span><span>
</span><a name="line-856"></a><span class="hs-comment">-- function creates a temporary file in the directory of the destination file,</span><span>
</span><a name="line-857"></a><span class="hs-comment">-- opens it, performs the main action with its handle, closes it, performs the</span><span>
</span><a name="line-858"></a><span class="hs-comment">-- post-action with its path, and finally replaces the destination file with</span><span>
</span><a name="line-859"></a><span class="hs-comment">-- the temporary file.  If an error occurs during any step of this process,</span><span>
</span><a name="line-860"></a><span class="hs-comment">-- the temporary file is removed and the destination file remains untouched.</span><span>
</span><a name="line-861"></a><span class="hs-identifier">withReplacementFile</span><span> </span><span class="hs-glyph">::</span><span> </span><a href="../base-4.10.0.0/src/%{MODULE/./-}.html#%{NAME}/GHC.IO.html#FilePath"><span class="hs-identifier hs-type">FilePath</span></a><span>            </span><span class="hs-comment">-- ^ Destination file</span><span>
</span><a name="line-862"></a><span>                    </span><span class="hs-glyph">-&gt;</span><span> </span><span class="hs-special">(</span><a href="../base-4.10.0.0/src/%{MODULE/./-}.html#%{NAME}/GHC.IO.html#FilePath"><span class="hs-identifier hs-type">FilePath</span></a><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="hs-identifier hs-type">IO</span><span> </span><span class="hs-special">(</span><span class="hs-special">)</span><span class="hs-special">)</span><span> </span><span class="hs-comment">-- ^ Post-action</span><span>
</span><a name="line-863"></a><span>                    </span><span class="hs-glyph">-&gt;</span><span> </span><span class="hs-special">(</span><a href="../base-4.10.0.0/src/%{MODULE/./-}.html#%{NAME}/GHC.IO.Handle.Types.html#Handle"><span class="hs-identifier hs-type">Handle</span></a><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="hs-identifier hs-type">IO</span><span> </span><a href="#local-6989586621679041330"><span class="hs-identifier hs-type">a</span></a><span class="hs-special">)</span><span>    </span><span class="hs-comment">-- ^ Main action</span><span>
</span><a name="line-864"></a><span>                    </span><span class="hs-glyph">-&gt;</span><span> </span><span class="hs-identifier hs-type">IO</span><span> </span><a href="#local-6989586621679041330"><span class="hs-identifier hs-type">a</span></a><span>
</span><a name="line-865"></a><a name="withReplacementFile"><a href="System.Directory.html#withReplacementFile"><span class="hs-identifier">withReplacementFile</span></a></a><span> </span><a name="local-6989586621679042138"><a href="#local-6989586621679042138"><span class="hs-identifier">path</span></a></a><span> </span><a name="local-6989586621679042139"><a href="#local-6989586621679042139"><span class="hs-identifier">postAction</span></a></a><span> </span><a name="local-6989586621679042140"><a href="#local-6989586621679042140"><span class="hs-identifier">action</span></a></a><span> </span><span class="hs-glyph">=</span><span>
</span><a name="line-866"></a><span>  </span><span class="hs-special">(</span><span class="hs-special">`</span><a href="System.Directory.html#ioeAddLocation"><span class="hs-identifier hs-var">ioeAddLocation</span></a><span class="hs-special">`</span><span> </span><span class="hs-string">&quot;withReplacementFile&quot;</span><span class="hs-special">)</span><span> </span><span class="hs-special">`</span><a href="../base-4.10.0.0/src/%{MODULE/./-}.html#%{NAME}/System.IO.Error.html#modifyIOError"><span class="hs-identifier hs-var">modifyIOError</span></a><span class="hs-special">`</span><span> </span><span class="hs-keyword">do</span><span>
</span><a name="line-867"></a><span>    </span><a href="../base-4.10.0.0/src/%{MODULE/./-}.html#%{NAME}/GHC.IO.html#mask"><span class="hs-identifier hs-var">mask</span></a><span> </span><a href="../base-4.10.0.0/src/%{MODULE/./-}.html#%{NAME}/GHC.Base.html#%24"><span class="hs-operator hs-var">$</span></a><span> </span><span class="hs-glyph">\</span><span> </span><a name="local-6989586621679042141"><a href="#local-6989586621679042141"><span class="hs-identifier">restore</span></a></a><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="hs-keyword">do</span><span>
</span><a name="line-868"></a><span>      </span><span class="hs-special">(</span><a name="local-6989586621679042142"><a href="#local-6989586621679042142"><span class="hs-identifier">tmpFPath</span></a></a><span class="hs-special">,</span><span> </span><a name="local-6989586621679042143"><a href="#local-6989586621679042143"><span class="hs-identifier">hTmp</span></a></a><span class="hs-special">)</span><span> </span><span class="hs-glyph">&lt;-</span><span> </span><a href="../base-4.10.0.0/src/%{MODULE/./-}.html#%{NAME}/System.IO.html#openBinaryTempFile"><span class="hs-identifier hs-var">openBinaryTempFile</span></a><span> </span><span class="hs-special">(</span><a href="../filepath-1.4.1.1/src/%{MODULE/./-}.html#%{NAME}/System.FilePath.Posix.html#takeDirectory"><span class="hs-identifier hs-var">takeDirectory</span></a><span> </span><a href="#local-6989586621679042138"><span class="hs-identifier hs-var">path</span></a><span class="hs-special">)</span><span>
</span><a name="line-869"></a><span>                                             </span><span class="hs-string">&quot;.copyFile.tmp&quot;</span><span>
</span><a name="line-870"></a><span>      </span><span class="hs-special">(</span><span class="hs-special">`</span><a href="../base-4.10.0.0/src/%{MODULE/./-}.html#%{NAME}/Control.Exception.Base.html#onException"><span class="hs-identifier hs-var">onException</span></a><span class="hs-special">`</span><span> </span><a href="System.Directory.html#ignoreIOExceptions"><span class="hs-identifier hs-var">ignoreIOExceptions</span></a><span> </span><span class="hs-special">(</span><a href="System.Directory.html#removeFile"><span class="hs-identifier hs-var">removeFile</span></a><span> </span><a href="#local-6989586621679042142"><span class="hs-identifier hs-var">tmpFPath</span></a><span class="hs-special">)</span><span class="hs-special">)</span><span> </span><a href="../base-4.10.0.0/src/%{MODULE/./-}.html#%{NAME}/GHC.Base.html#%24"><span class="hs-operator hs-var">$</span></a><span> </span><span class="hs-keyword">do</span><span>
</span><a name="line-871"></a><span>        </span><a name="local-6989586621679042416"><a href="#local-6989586621679042416"><span class="hs-identifier">r</span></a></a><span> </span><span class="hs-glyph">&lt;-</span><span> </span><span class="hs-special">(</span><span class="hs-special">`</span><a href="../base-4.10.0.0/src/%{MODULE/./-}.html#%{NAME}/Control.Exception.Base.html#onException"><span class="hs-identifier hs-var">onException</span></a><span class="hs-special">`</span><span> </span><a href="System.Directory.html#ignoreIOExceptions"><span class="hs-identifier hs-var">ignoreIOExceptions</span></a><span> </span><span class="hs-special">(</span><a href="../base-4.10.0.0/src/%{MODULE/./-}.html#%{NAME}/GHC.IO.Handle.html#hClose"><span class="hs-identifier hs-var">hClose</span></a><span> </span><a href="#local-6989586621679042143"><span class="hs-identifier hs-var">hTmp</span></a><span class="hs-special">)</span><span class="hs-special">)</span><span> </span><a href="../base-4.10.0.0/src/%{MODULE/./-}.html#%{NAME}/GHC.Base.html#%24"><span class="hs-operator hs-var">$</span></a><span> </span><span class="hs-keyword">do</span><span>
</span><a name="line-872"></a><span>          </span><a href="#local-6989586621679042141"><span class="hs-identifier hs-var">restore</span></a><span> </span><span class="hs-special">(</span><a href="#local-6989586621679042140"><span class="hs-identifier hs-var">action</span></a><span> </span><a href="#local-6989586621679042143"><span class="hs-identifier hs-var">hTmp</span></a><span class="hs-special">)</span><span>
</span><a name="line-873"></a><span>        </span><a href="../base-4.10.0.0/src/%{MODULE/./-}.html#%{NAME}/GHC.IO.Handle.html#hClose"><span class="hs-identifier hs-var">hClose</span></a><span> </span><a href="#local-6989586621679042143"><span class="hs-identifier hs-var">hTmp</span></a><span>
</span><a name="line-874"></a><span>        </span><a href="#local-6989586621679042141"><span class="hs-identifier hs-var">restore</span></a><span> </span><span class="hs-special">(</span><a href="#local-6989586621679042139"><span class="hs-identifier hs-var">postAction</span></a><span> </span><a href="#local-6989586621679042142"><span class="hs-identifier hs-var">tmpFPath</span></a><span class="hs-special">)</span><span>
</span><a name="line-875"></a><span>        </span><a href="System.Directory.html#renameFile"><span class="hs-identifier hs-var">renameFile</span></a><span> </span><a href="#local-6989586621679042142"><span class="hs-identifier hs-var">tmpFPath</span></a><span> </span><a href="#local-6989586621679042138"><span class="hs-identifier hs-var">path</span></a><span>
</span><a name="line-876"></a><span>        </span><a href="../base-4.10.0.0/src/%{MODULE/./-}.html#%{NAME}/GHC.Base.html#return"><span class="hs-identifier hs-var">return</span></a><span> </span><a href="#local-6989586621679042416"><span class="hs-identifier hs-var">r</span></a><span>
</span><a name="line-877"></a><span>
</span><a name="line-878"></a><span class="hs-comment">-- | Attempt to perform the given action, silencing any IO exception thrown by</span><span>
</span><a name="line-879"></a><span class="hs-comment">-- it.</span><span>
</span><a name="line-880"></a><span class="hs-identifier">ignoreIOExceptions</span><span> </span><span class="hs-glyph">::</span><span> </span><span class="hs-identifier hs-type">IO</span><span> </span><span class="hs-special">(</span><span class="hs-special">)</span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="hs-identifier hs-type">IO</span><span> </span><span class="hs-special">(</span><span class="hs-special">)</span><span>
</span><a name="line-881"></a><a name="ignoreIOExceptions"><a href="System.Directory.html#ignoreIOExceptions"><span class="hs-identifier">ignoreIOExceptions</span></a></a><span> </span><a name="local-6989586621679042417"><a href="#local-6989586621679042417"><span class="hs-identifier">io</span></a></a><span> </span><span class="hs-glyph">=</span><span> </span><a href="#local-6989586621679042417"><span class="hs-identifier hs-var">io</span></a><span> </span><span class="hs-special">`</span><a href="../base-4.10.0.0/src/%{MODULE/./-}.html#%{NAME}/System.IO.Error.html#catchIOError"><span class="hs-identifier hs-var">catchIOError</span></a><span class="hs-special">`</span><span> </span><span class="hs-special">(</span><span class="hs-glyph">\</span><span class="hs-identifier">_</span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><a href="../base-4.10.0.0/src/%{MODULE/./-}.html#%{NAME}/GHC.Base.html#return"><span class="hs-identifier hs-var">return</span></a><span> </span><span class="hs-special">(</span><span class="hs-special">)</span><span class="hs-special">)</span><span>
</span><a name="line-882"></a><span>
</span><a name="line-883"></a><span class="hs-comment">-- | Copy all data from a file to a handle.</span><span>
</span><a name="line-884"></a><span class="hs-identifier">copyFileToHandle</span><span> </span><span class="hs-glyph">::</span><span> </span><a href="../base-4.10.0.0/src/%{MODULE/./-}.html#%{NAME}/GHC.IO.html#FilePath"><span class="hs-identifier hs-type">FilePath</span></a><span>            </span><span class="hs-comment">-- ^ Source file</span><span>
</span><a name="line-885"></a><span>                 </span><span class="hs-glyph">-&gt;</span><span> </span><a href="../base-4.10.0.0/src/%{MODULE/./-}.html#%{NAME}/GHC.IO.Handle.Types.html#Handle"><span class="hs-identifier hs-type">Handle</span></a><span>              </span><span class="hs-comment">-- ^ Destination handle</span><span>
</span><a name="line-886"></a><span>                 </span><span class="hs-glyph">-&gt;</span><span> </span><span class="hs-identifier hs-type">IO</span><span> </span><span class="hs-special">(</span><span class="hs-special">)</span><span>
</span><a name="line-887"></a><a name="copyFileToHandle"><a href="System.Directory.html#copyFileToHandle"><span class="hs-identifier">copyFileToHandle</span></a></a><span> </span><a name="local-6989586621679042418"><a href="#local-6989586621679042418"><span class="hs-identifier">fromFPath</span></a></a><span> </span><a name="local-6989586621679042419"><a href="#local-6989586621679042419"><span class="hs-identifier">hTo</span></a></a><span> </span><span class="hs-glyph">=</span><span>
</span><a name="line-888"></a><span>  </span><span class="hs-special">(</span><span class="hs-special">`</span><a href="System.Directory.html#ioeAddLocation"><span class="hs-identifier hs-var">ioeAddLocation</span></a><span class="hs-special">`</span><span> </span><span class="hs-string">&quot;copyFileToHandle&quot;</span><span class="hs-special">)</span><span> </span><span class="hs-special">`</span><a href="../base-4.10.0.0/src/%{MODULE/./-}.html#%{NAME}/System.IO.Error.html#modifyIOError"><span class="hs-identifier hs-var">modifyIOError</span></a><span class="hs-special">`</span><span> </span><span class="hs-keyword">do</span><span>
</span><a name="line-889"></a><span>    </span><a href="../base-4.10.0.0/src/%{MODULE/./-}.html#%{NAME}/System.IO.html#withBinaryFile"><span class="hs-identifier hs-var">withBinaryFile</span></a><span> </span><a href="#local-6989586621679042418"><span class="hs-identifier hs-var">fromFPath</span></a><span> </span><a href="../base-4.10.0.0/src/%{MODULE/./-}.html#%{NAME}/GHC.IO.IOMode.html#ReadMode"><span class="hs-identifier hs-var">ReadMode</span></a><span> </span><a href="../base-4.10.0.0/src/%{MODULE/./-}.html#%{NAME}/GHC.Base.html#%24"><span class="hs-operator hs-var">$</span></a><span> </span><span class="hs-glyph">\</span><span> </span><a name="local-6989586621679042420"><a href="#local-6989586621679042420"><span class="hs-identifier">hFrom</span></a></a><span> </span><span class="hs-glyph">-&gt;</span><span>
</span><a name="line-890"></a><span>      </span><a href="System.Directory.html#copyHandleData"><span class="hs-identifier hs-var">copyHandleData</span></a><span> </span><a href="#local-6989586621679042420"><span class="hs-identifier hs-var">hFrom</span></a><span> </span><a href="#local-6989586621679042419"><span class="hs-identifier hs-var">hTo</span></a><span>
</span><a name="line-891"></a><span>
</span><a name="line-892"></a><span class="hs-comment">-- | Copy data from one handle to another until end of file.</span><span>
</span><a name="line-893"></a><span class="hs-identifier">copyHandleData</span><span> </span><span class="hs-glyph">::</span><span> </span><a href="../base-4.10.0.0/src/%{MODULE/./-}.html#%{NAME}/GHC.IO.Handle.Types.html#Handle"><span class="hs-identifier hs-type">Handle</span></a><span>                </span><span class="hs-comment">-- ^ Source handle</span><span>
</span><a name="line-894"></a><span>               </span><span class="hs-glyph">-&gt;</span><span> </span><a href="../base-4.10.0.0/src/%{MODULE/./-}.html#%{NAME}/GHC.IO.Handle.Types.html#Handle"><span class="hs-identifier hs-type">Handle</span></a><span>                </span><span class="hs-comment">-- ^ Destination handle</span><span>
</span><a name="line-895"></a><span>               </span><span class="hs-glyph">-&gt;</span><span> </span><span class="hs-identifier hs-type">IO</span><span> </span><span class="hs-special">(</span><span class="hs-special">)</span><span>
</span><a name="line-896"></a><a name="copyHandleData"><a href="System.Directory.html#copyHandleData"><span class="hs-identifier">copyHandleData</span></a></a><span> </span><a name="local-6989586621679042421"><a href="#local-6989586621679042421"><span class="hs-identifier">hFrom</span></a></a><span> </span><a name="local-6989586621679042422"><a href="#local-6989586621679042422"><span class="hs-identifier">hTo</span></a></a><span> </span><span class="hs-glyph">=</span><span>
</span><a name="line-897"></a><span>  </span><span class="hs-special">(</span><span class="hs-special">`</span><a href="System.Directory.html#ioeAddLocation"><span class="hs-identifier hs-var">ioeAddLocation</span></a><span class="hs-special">`</span><span> </span><span class="hs-string">&quot;copyData&quot;</span><span class="hs-special">)</span><span> </span><span class="hs-special">`</span><a href="../base-4.10.0.0/src/%{MODULE/./-}.html#%{NAME}/System.IO.Error.html#modifyIOError"><span class="hs-identifier hs-var">modifyIOError</span></a><span class="hs-special">`</span><span> </span><span class="hs-keyword">do</span><span>
</span><a name="line-898"></a><span>    </span><a href="../base-4.10.0.0/src/%{MODULE/./-}.html#%{NAME}/Foreign.Marshal.Alloc.html#allocaBytes"><span class="hs-identifier hs-var">allocaBytes</span></a><span> </span><a href="#local-6989586621679042423"><span class="hs-identifier hs-var">bufferSize</span></a><span> </span><a href="#local-6989586621679042424"><span class="hs-identifier hs-var">go</span></a><span>
</span><a name="line-899"></a><span>  </span><span class="hs-keyword">where</span><span>
</span><a name="line-900"></a><span>    </span><a name="local-6989586621679042423"><a href="#local-6989586621679042423"><span class="hs-identifier">bufferSize</span></a></a><span> </span><span class="hs-glyph">=</span><span> </span><span class="hs-number">131072</span><span> </span><span class="hs-comment">-- 128 KiB, as coreutils `cp` uses as of May 2014 (see ioblksize.h)</span><span>
</span><a name="line-901"></a><span>    </span><a name="local-6989586621679042424"><a href="#local-6989586621679042424"><span class="hs-identifier">go</span></a></a><span> </span><a name="local-6989586621679042425"><a href="#local-6989586621679042425"><span class="hs-identifier">buffer</span></a></a><span> </span><span class="hs-glyph">=</span><span> </span><span class="hs-keyword">do</span><span>
</span><a name="line-902"></a><span>      </span><a name="local-6989586621679042563"><a href="#local-6989586621679042563"><span class="hs-identifier">count</span></a></a><span> </span><span class="hs-glyph">&lt;-</span><span> </span><a href="../base-4.10.0.0/src/%{MODULE/./-}.html#%{NAME}/GHC.IO.Handle.Text.html#hGetBuf"><span class="hs-identifier hs-var">hGetBuf</span></a><span> </span><a href="#local-6989586621679042421"><span class="hs-identifier hs-var">hFrom</span></a><span> </span><a href="#local-6989586621679042425"><span class="hs-identifier hs-var">buffer</span></a><span> </span><a href="#local-6989586621679042423"><span class="hs-identifier hs-var">bufferSize</span></a><span>
</span><a name="line-903"></a><span>      </span><a href="../base-4.10.0.0/src/%{MODULE/./-}.html#%{NAME}/GHC.Base.html#when"><span class="hs-identifier hs-var">when</span></a><span> </span><span class="hs-special">(</span><a href="#local-6989586621679042563"><span class="hs-identifier hs-var">count</span></a><span> </span><span class="hs-operator hs-var">&gt;</span><span> </span><span class="hs-number">0</span><span class="hs-special">)</span><span> </span><a href="../base-4.10.0.0/src/%{MODULE/./-}.html#%{NAME}/GHC.Base.html#%24"><span class="hs-operator hs-var">$</span></a><span> </span><span class="hs-keyword">do</span><span>
</span><a name="line-904"></a><span>        </span><a href="../base-4.10.0.0/src/%{MODULE/./-}.html#%{NAME}/GHC.IO.Handle.Text.html#hPutBuf"><span class="hs-identifier hs-var">hPutBuf</span></a><span> </span><a href="#local-6989586621679042422"><span class="hs-identifier hs-var">hTo</span></a><span> </span><a href="#local-6989586621679042425"><span class="hs-identifier hs-var">buffer</span></a><span> </span><a href="#local-6989586621679042563"><span class="hs-identifier hs-var">count</span></a><span>
</span><a name="line-905"></a><span>        </span><a href="#local-6989586621679042424"><span class="hs-identifier hs-var">go</span></a><span> </span><a href="#local-6989586621679042425"><span class="hs-identifier hs-var">buffer</span></a><span>
</span><a name="line-906"></a><span>
</span><a name="line-907"></a><span class="hs-comment">-- | Copy a file with its associated metadata.  If the destination file</span><span>
</span><a name="line-908"></a><span class="hs-comment">-- already exists, it is overwritten.  There is no guarantee of atomicity in</span><span>
</span><a name="line-909"></a><span class="hs-comment">-- the replacement of the destination file.  Neither path may refer to an</span><span>
</span><a name="line-910"></a><span class="hs-comment">-- existing directory.  If the source and/or destination are symbolic links,</span><span>
</span><a name="line-911"></a><span class="hs-comment">-- the copy is performed on the targets of the links.</span><span>
</span><a name="line-912"></a><span class="hs-comment">--</span><span>
</span><a name="line-913"></a><span class="hs-comment">-- On Windows, it behaves like the Win32 function</span><span>
</span><a name="line-914"></a><span class="hs-comment">-- &lt;https://msdn.microsoft.com/en-us/library/windows/desktop/aa363851.aspx CopyFile&gt;,</span><span>
</span><a name="line-915"></a><span class="hs-comment">-- which copies various kinds of metadata including file attributes and</span><span>
</span><a name="line-916"></a><span class="hs-comment">-- security resource properties.</span><span>
</span><a name="line-917"></a><span class="hs-comment">--</span><span>
</span><a name="line-918"></a><span class="hs-comment">-- On Unix-like systems, permissions, access time, and modification time are</span><span>
</span><a name="line-919"></a><span class="hs-comment">-- preserved.  If possible, the owner and group are also preserved.  Note that</span><span>
</span><a name="line-920"></a><span class="hs-comment">-- the very act of copying can change the access time of the source file,</span><span>
</span><a name="line-921"></a><span class="hs-comment">-- hence the access times of the two files may differ after the operation</span><span>
</span><a name="line-922"></a><span class="hs-comment">-- completes.</span><span>
</span><a name="line-923"></a><span class="hs-comment">--</span><span>
</span><a name="line-924"></a><span class="hs-comment">-- @since 1.2.6.0</span><span>
</span><a name="line-925"></a><span class="hs-identifier">copyFileWithMetadata</span><span> </span><span class="hs-glyph">::</span><span> </span><a href="../base-4.10.0.0/src/%{MODULE/./-}.html#%{NAME}/GHC.IO.html#FilePath"><span class="hs-identifier hs-type">FilePath</span></a><span>        </span><span class="hs-comment">-- ^ Source file</span><span>
</span><a name="line-926"></a><span>                     </span><span class="hs-glyph">-&gt;</span><span> </span><a href="../base-4.10.0.0/src/%{MODULE/./-}.html#%{NAME}/GHC.IO.html#FilePath"><span class="hs-identifier hs-type">FilePath</span></a><span>        </span><span class="hs-comment">-- ^ Destination file</span><span>
</span><a name="line-927"></a><span>                     </span><span class="hs-glyph">-&gt;</span><span> </span><span class="hs-identifier hs-type">IO</span><span> </span><span class="hs-special">(</span><span class="hs-special">)</span><span>
</span><a name="line-928"></a><a name="copyFileWithMetadata"><a href="System.Directory.html#copyFileWithMetadata"><span class="hs-identifier">copyFileWithMetadata</span></a></a><span> </span><a name="local-6989586621679042564"><a href="#local-6989586621679042564"><span class="hs-identifier">src</span></a></a><span> </span><a name="local-6989586621679042565"><a href="#local-6989586621679042565"><span class="hs-identifier">dst</span></a></a><span> </span><span class="hs-glyph">=</span><span>
</span><a name="line-929"></a><span>  </span><span class="hs-special">(</span><span class="hs-special">`</span><a href="System.Directory.html#ioeAddLocation"><span class="hs-identifier hs-var">ioeAddLocation</span></a><span class="hs-special">`</span><span> </span><span class="hs-string">&quot;copyFileWithMetadata&quot;</span><span class="hs-special">)</span><span> </span><span class="hs-special">`</span><a href="../base-4.10.0.0/src/%{MODULE/./-}.html#%{NAME}/System.IO.Error.html#modifyIOError"><span class="hs-identifier hs-var">modifyIOError</span></a><span class="hs-special">`</span><span> </span><a href="#local-6989586621679042566"><span class="hs-identifier hs-var">doCopy</span></a><span>
</span><a name="line-930"></a><span>  </span><span class="hs-keyword">where</span><span>
</span><a name="line-931"></a><span class="hs-cpp">#ifdef mingw32_HOST_OS</span><span>
</span><a name="line-932"></a><span>    </span><span class="hs-identifier">doCopy</span><span> </span><span class="hs-glyph">=</span><span> </span><span class="hs-identifier">Win32</span><span class="hs-operator">.</span><span class="hs-identifier">copyFile</span><span> </span><span class="hs-identifier">src</span><span> </span><span class="hs-identifier">dst</span><span> </span><span class="hs-identifier">False</span><span>
</span><a name="line-933"></a><span class="hs-cpp">#else</span><span>
</span><a name="line-934"></a><span>    </span><a name="local-6989586621679042566"><a href="#local-6989586621679042566"><span class="hs-identifier">doCopy</span></a></a><span> </span><span class="hs-glyph">=</span><span> </span><span class="hs-keyword">do</span><span>
</span><a name="line-935"></a><span>      </span><a name="local-6989586621679042567"><a href="#local-6989586621679042567"><span class="hs-identifier">st</span></a></a><span> </span><span class="hs-glyph">&lt;-</span><span> </span><a href="../unix-2.7.2.1/src/%{MODULE/./-}.html#%{NAME}/System.Posix.Files.html#getFileStatus"><span class="hs-identifier hs-var">Posix</span><span class="hs-operator hs-var">.</span><span class="hs-identifier hs-var">getFileStatus</span></a><span> </span><a href="#local-6989586621679042564"><span class="hs-identifier hs-var">src</span></a><span>
</span><a name="line-936"></a><span>      </span><a href="System.Directory.html#copyFileContents"><span class="hs-identifier hs-var">copyFileContents</span></a><span> </span><a href="#local-6989586621679042564"><span class="hs-identifier hs-var">src</span></a><span> </span><a href="#local-6989586621679042565"><span class="hs-identifier hs-var">dst</span></a><span>
</span><a name="line-937"></a><span>      </span><a href="System.Directory.html#copyMetadataFromStatus"><span class="hs-identifier hs-var">copyMetadataFromStatus</span></a><span> </span><a href="#local-6989586621679042567"><span class="hs-identifier hs-var">st</span></a><span> </span><a href="#local-6989586621679042565"><span class="hs-identifier hs-var">dst</span></a><span>
</span><a name="line-938"></a><span class="hs-cpp">#endif</span><span>
</span><a name="line-939"></a><span>
</span><a name="line-940"></a><span class="hs-cpp">#ifndef mingw32_HOST_OS</span><span>
</span><a name="line-941"></a><span class="hs-identifier">copyMetadataFromStatus</span><span> </span><span class="hs-glyph">::</span><span> </span><a href="../unix-2.7.2.1/src/%{MODULE/./-}.html#%{NAME}/System.Posix.Files.Common.html#FileStatus"><span class="hs-identifier hs-type">Posix</span><span class="hs-operator hs-type">.</span><span class="hs-identifier hs-type">FileStatus</span></a><span> </span><span class="hs-glyph">-&gt;</span><span> </span><a href="../base-4.10.0.0/src/%{MODULE/./-}.html#%{NAME}/GHC.IO.html#FilePath"><span class="hs-identifier hs-type">FilePath</span></a><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="hs-identifier hs-type">IO</span><span> </span><span class="hs-special">(</span><span class="hs-special">)</span><span>
</span><a name="line-942"></a><a name="copyMetadataFromStatus"><a href="System.Directory.html#copyMetadataFromStatus"><span class="hs-identifier">copyMetadataFromStatus</span></a></a><span> </span><a name="local-6989586621679042568"><a href="#local-6989586621679042568"><span class="hs-identifier">st</span></a></a><span> </span><a name="local-6989586621679042569"><a href="#local-6989586621679042569"><span class="hs-identifier">dst</span></a></a><span> </span><span class="hs-glyph">=</span><span> </span><span class="hs-keyword">do</span><span>
</span><a name="line-943"></a><span>  </span><a href="System.Directory.html#tryCopyOwnerAndGroupFromStatus"><span class="hs-identifier hs-var">tryCopyOwnerAndGroupFromStatus</span></a><span> </span><a href="#local-6989586621679042568"><span class="hs-identifier hs-var">st</span></a><span> </span><a href="#local-6989586621679042569"><span class="hs-identifier hs-var">dst</span></a><span>
</span><a name="line-944"></a><span>  </span><a href="System.Directory.html#copyPermissionsFromStatus"><span class="hs-identifier hs-var">copyPermissionsFromStatus</span></a><span> </span><a href="#local-6989586621679042568"><span class="hs-identifier hs-var">st</span></a><span> </span><a href="#local-6989586621679042569"><span class="hs-identifier hs-var">dst</span></a><span>
</span><a name="line-945"></a><span>  </span><a href="System.Directory.html#copyFileTimesFromStatus"><span class="hs-identifier hs-var">copyFileTimesFromStatus</span></a><span> </span><a href="#local-6989586621679042568"><span class="hs-identifier hs-var">st</span></a><span> </span><a href="#local-6989586621679042569"><span class="hs-identifier hs-var">dst</span></a><span>
</span><a name="line-946"></a><span class="hs-cpp">#endif</span><span>
</span><a name="line-947"></a><span>
</span><a name="line-948"></a><span class="hs-cpp">#ifndef mingw32_HOST_OS</span><span>
</span><a name="line-949"></a><span class="hs-identifier">tryCopyOwnerAndGroupFromStatus</span><span> </span><span class="hs-glyph">::</span><span> </span><a href="../unix-2.7.2.1/src/%{MODULE/./-}.html#%{NAME}/System.Posix.Files.Common.html#FileStatus"><span class="hs-identifier hs-type">Posix</span><span class="hs-operator hs-type">.</span><span class="hs-identifier hs-type">FileStatus</span></a><span> </span><span class="hs-glyph">-&gt;</span><span> </span><a href="../base-4.10.0.0/src/%{MODULE/./-}.html#%{NAME}/GHC.IO.html#FilePath"><span class="hs-identifier hs-type">FilePath</span></a><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="hs-identifier hs-type">IO</span><span> </span><span class="hs-special">(</span><span class="hs-special">)</span><span>
</span><a name="line-950"></a><a name="tryCopyOwnerAndGroupFromStatus"><a href="System.Directory.html#tryCopyOwnerAndGroupFromStatus"><span class="hs-identifier">tryCopyOwnerAndGroupFromStatus</span></a></a><span> </span><a name="local-6989586621679042570"><a href="#local-6989586621679042570"><span class="hs-identifier">st</span></a></a><span> </span><a name="local-6989586621679042571"><a href="#local-6989586621679042571"><span class="hs-identifier">dst</span></a></a><span> </span><span class="hs-glyph">=</span><span> </span><span class="hs-keyword">do</span><span>
</span><a name="line-951"></a><span>  </span><a href="System.Directory.html#ignoreIOExceptions"><span class="hs-identifier hs-var">ignoreIOExceptions</span></a><span> </span><span class="hs-special">(</span><a href="System.Directory.html#copyOwnerFromStatus"><span class="hs-identifier hs-var">copyOwnerFromStatus</span></a><span> </span><a href="#local-6989586621679042570"><span class="hs-identifier hs-var">st</span></a><span> </span><a href="#local-6989586621679042571"><span class="hs-identifier hs-var">dst</span></a><span class="hs-special">)</span><span>
</span><a name="line-952"></a><span>  </span><a href="System.Directory.html#ignoreIOExceptions"><span class="hs-identifier hs-var">ignoreIOExceptions</span></a><span> </span><span class="hs-special">(</span><a href="System.Directory.html#copyGroupFromStatus"><span class="hs-identifier hs-var">copyGroupFromStatus</span></a><span> </span><a href="#local-6989586621679042570"><span class="hs-identifier hs-var">st</span></a><span> </span><a href="#local-6989586621679042571"><span class="hs-identifier hs-var">dst</span></a><span class="hs-special">)</span><span>
</span><a name="line-953"></a><span class="hs-cpp">#endif</span><span>
</span><a name="line-954"></a><span>
</span><a name="line-955"></a><span class="hs-cpp">#ifndef mingw32_HOST_OS</span><span>
</span><a name="line-956"></a><span class="hs-identifier">copyOwnerFromStatus</span><span> </span><span class="hs-glyph">::</span><span> </span><a href="../unix-2.7.2.1/src/%{MODULE/./-}.html#%{NAME}/System.Posix.Files.Common.html#FileStatus"><span class="hs-identifier hs-type">Posix</span><span class="hs-operator hs-type">.</span><span class="hs-identifier hs-type">FileStatus</span></a><span> </span><span class="hs-glyph">-&gt;</span><span> </span><a href="../base-4.10.0.0/src/%{MODULE/./-}.html#%{NAME}/GHC.IO.html#FilePath"><span class="hs-identifier hs-type">FilePath</span></a><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="hs-identifier hs-type">IO</span><span> </span><span class="hs-special">(</span><span class="hs-special">)</span><span>
</span><a name="line-957"></a><a name="copyOwnerFromStatus"><a href="System.Directory.html#copyOwnerFromStatus"><span class="hs-identifier">copyOwnerFromStatus</span></a></a><span> </span><a name="local-6989586621679042572"><a href="#local-6989586621679042572"><span class="hs-identifier">st</span></a></a><span> </span><a name="local-6989586621679042573"><a href="#local-6989586621679042573"><span class="hs-identifier">dst</span></a></a><span> </span><span class="hs-glyph">=</span><span> </span><span class="hs-keyword">do</span><span>
</span><a name="line-958"></a><span>  </span><a href="../unix-2.7.2.1/src/%{MODULE/./-}.html#%{NAME}/System.Posix.Files.html#setOwnerAndGroup"><span class="hs-identifier hs-var">Posix</span><span class="hs-operator hs-var">.</span><span class="hs-identifier hs-var">setOwnerAndGroup</span></a><span> </span><a href="#local-6989586621679042573"><span class="hs-identifier hs-var">dst</span></a><span> </span><span class="hs-special">(</span><a href="../unix-2.7.2.1/src/%{MODULE/./-}.html#%{NAME}/System.Posix.Files.Common.html#fileOwner"><span class="hs-identifier hs-var">Posix</span><span class="hs-operator hs-var">.</span><span class="hs-identifier hs-var">fileOwner</span></a><span> </span><a href="#local-6989586621679042572"><span class="hs-identifier hs-var">st</span></a><span class="hs-special">)</span><span> </span><span class="hs-special">(</span><span class="hs-glyph">-</span><span class="hs-number">1</span><span class="hs-special">)</span><span>
</span><a name="line-959"></a><span class="hs-cpp">#endif</span><span>
</span><a name="line-960"></a><span>
</span><a name="line-961"></a><span class="hs-cpp">#ifndef mingw32_HOST_OS</span><span>
</span><a name="line-962"></a><span class="hs-identifier">copyGroupFromStatus</span><span> </span><span class="hs-glyph">::</span><span> </span><a href="../unix-2.7.2.1/src/%{MODULE/./-}.html#%{NAME}/System.Posix.Files.Common.html#FileStatus"><span class="hs-identifier hs-type">Posix</span><span class="hs-operator hs-type">.</span><span class="hs-identifier hs-type">FileStatus</span></a><span> </span><span class="hs-glyph">-&gt;</span><span> </span><a href="../base-4.10.0.0/src/%{MODULE/./-}.html#%{NAME}/GHC.IO.html#FilePath"><span class="hs-identifier hs-type">FilePath</span></a><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="hs-identifier hs-type">IO</span><span> </span><span class="hs-special">(</span><span class="hs-special">)</span><span>
</span><a name="line-963"></a><a name="copyGroupFromStatus"><a href="System.Directory.html#copyGroupFromStatus"><span class="hs-identifier">copyGroupFromStatus</span></a></a><span> </span><a name="local-6989586621679042574"><a href="#local-6989586621679042574"><span class="hs-identifier">st</span></a></a><span> </span><a name="local-6989586621679042575"><a href="#local-6989586621679042575"><span class="hs-identifier">dst</span></a></a><span> </span><span class="hs-glyph">=</span><span> </span><span class="hs-keyword">do</span><span>
</span><a name="line-964"></a><span>  </span><a href="../unix-2.7.2.1/src/%{MODULE/./-}.html#%{NAME}/System.Posix.Files.html#setOwnerAndGroup"><span class="hs-identifier hs-var">Posix</span><span class="hs-operator hs-var">.</span><span class="hs-identifier hs-var">setOwnerAndGroup</span></a><span> </span><a href="#local-6989586621679042575"><span class="hs-identifier hs-var">dst</span></a><span> </span><span class="hs-special">(</span><span class="hs-glyph">-</span><span class="hs-number">1</span><span class="hs-special">)</span><span> </span><span class="hs-special">(</span><a href="../unix-2.7.2.1/src/%{MODULE/./-}.html#%{NAME}/System.Posix.Files.Common.html#fileGroup"><span class="hs-identifier hs-var">Posix</span><span class="hs-operator hs-var">.</span><span class="hs-identifier hs-var">fileGroup</span></a><span> </span><a href="#local-6989586621679042574"><span class="hs-identifier hs-var">st</span></a><span class="hs-special">)</span><span>
</span><a name="line-965"></a><span class="hs-cpp">#endif</span><span>
</span><a name="line-966"></a><span>
</span><a name="line-967"></a><span class="hs-cpp">#ifndef mingw32_HOST_OS</span><span>
</span><a name="line-968"></a><span class="hs-identifier">copyFileTimesFromStatus</span><span> </span><span class="hs-glyph">::</span><span> </span><a href="../unix-2.7.2.1/src/%{MODULE/./-}.html#%{NAME}/System.Posix.Files.Common.html#FileStatus"><span class="hs-identifier hs-type">Posix</span><span class="hs-operator hs-type">.</span><span class="hs-identifier hs-type">FileStatus</span></a><span> </span><span class="hs-glyph">-&gt;</span><span> </span><a href="../base-4.10.0.0/src/%{MODULE/./-}.html#%{NAME}/GHC.IO.html#FilePath"><span class="hs-identifier hs-type">FilePath</span></a><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="hs-identifier hs-type">IO</span><span> </span><span class="hs-special">(</span><span class="hs-special">)</span><span>
</span><a name="line-969"></a><a name="copyFileTimesFromStatus"><a href="System.Directory.html#copyFileTimesFromStatus"><span class="hs-identifier">copyFileTimesFromStatus</span></a></a><span> </span><a name="local-6989586621679042576"><a href="#local-6989586621679042576"><span class="hs-identifier">st</span></a></a><span> </span><a name="local-6989586621679042577"><a href="#local-6989586621679042577"><span class="hs-identifier">dst</span></a></a><span> </span><span class="hs-glyph">=</span><span> </span><span class="hs-keyword">do</span><span>
</span><a name="line-970"></a><span>  </span><span class="hs-keyword">let</span><span> </span><span class="hs-special">(</span><a name="local-6989586621679042578"><a href="#local-6989586621679042578"><span class="hs-identifier">atime</span></a></a><span class="hs-special">,</span><span> </span><a name="local-6989586621679042579"><a href="#local-6989586621679042579"><span class="hs-identifier">mtime</span></a></a><span class="hs-special">)</span><span> </span><span class="hs-glyph">=</span><span> </span><a href="System.Directory.html#fileTimesFromStatus"><span class="hs-identifier hs-var">fileTimesFromStatus</span></a><span> </span><a href="#local-6989586621679042576"><span class="hs-identifier hs-var">st</span></a><span>
</span><a name="line-971"></a><span>  </span><a href="System.Directory.html#setFileTimes"><span class="hs-identifier hs-var">setFileTimes</span></a><span> </span><a href="#local-6989586621679042577"><span class="hs-identifier hs-var">dst</span></a><span> </span><span class="hs-special">(</span><a href="../base-4.10.0.0/src/%{MODULE/./-}.html#%{NAME}/GHC.Base.html#Just"><span class="hs-identifier hs-var">Just</span></a><span> </span><a href="#local-6989586621679042578"><span class="hs-identifier hs-var">atime</span></a><span class="hs-special">,</span><span> </span><a href="../base-4.10.0.0/src/%{MODULE/./-}.html#%{NAME}/GHC.Base.html#Just"><span class="hs-identifier hs-var">Just</span></a><span> </span><a href="#local-6989586621679042579"><span class="hs-identifier hs-var">mtime</span></a><span class="hs-special">)</span><span>
</span><a name="line-972"></a><span class="hs-cpp">#endif</span><span>
</span><a name="line-973"></a><span>
</span><a name="line-974"></a><span class="hs-comment">-- | Make a path absolute, 'normalise' the path, and remove as many</span><span>
</span><a name="line-975"></a><span class="hs-comment">-- indirections from it as possible.  Any trailing path separators are</span><span>
</span><a name="line-976"></a><span class="hs-comment">-- discarded via 'dropTrailingPathSeparator'.  Additionally, on Windows the</span><span>
</span><a name="line-977"></a><span class="hs-comment">-- letter case of the path is canonicalized.</span><span>
</span><a name="line-978"></a><span class="hs-comment">--</span><span>
</span><a name="line-979"></a><span class="hs-comment">-- __Note__: This function is a very big hammer.  If you only need an absolute</span><span>
</span><a name="line-980"></a><span class="hs-comment">-- path, 'makeAbsolute' is sufficient for removing dependence on the current</span><span>
</span><a name="line-981"></a><span class="hs-comment">-- working directory.</span><span>
</span><a name="line-982"></a><span class="hs-comment">--</span><span>
</span><a name="line-983"></a><span class="hs-comment">-- Indirections include the two special directories @.@ and @..@, as well as</span><span>
</span><a name="line-984"></a><span class="hs-comment">-- any symbolic links.  The input path need not point to an existing file or</span><span>
</span><a name="line-985"></a><span class="hs-comment">-- directory.  Canonicalization is performed on the longest prefix of the path</span><span>
</span><a name="line-986"></a><span class="hs-comment">-- that points to an existing file or directory.  The remaining portion of the</span><span>
</span><a name="line-987"></a><span class="hs-comment">-- path that does not point to an existing file or directory will still</span><span>
</span><a name="line-988"></a><span class="hs-comment">-- undergo 'normalise', but case canonicalization and indirection removal are</span><span>
</span><a name="line-989"></a><span class="hs-comment">-- skipped as they are impossible to do on a nonexistent path.</span><span>
</span><a name="line-990"></a><span class="hs-comment">--</span><span>
</span><a name="line-991"></a><span class="hs-comment">-- Most programs should not worry about the canonicity of a path.  In</span><span>
</span><a name="line-992"></a><span class="hs-comment">-- particular, despite the name, the function does not truly guarantee</span><span>
</span><a name="line-993"></a><span class="hs-comment">-- canonicity of the returned path due to the presence of hard links, mount</span><span>
</span><a name="line-994"></a><span class="hs-comment">-- points, etc.</span><span>
</span><a name="line-995"></a><span class="hs-comment">--</span><span>
</span><a name="line-996"></a><span class="hs-comment">-- If the path points to an existing file or directory, then the output path</span><span>
</span><a name="line-997"></a><span class="hs-comment">-- shall also point to the same file or directory, subject to the condition</span><span>
</span><a name="line-998"></a><span class="hs-comment">-- that the relevant parts of the file system do not change while the function</span><span>
</span><a name="line-999"></a><span class="hs-comment">-- is still running.  In other words, the function is definitively not atomic.</span><span>
</span><a name="line-1000"></a><span class="hs-comment">-- The results can be utterly wrong if the portions of the path change while</span><span>
</span><a name="line-1001"></a><span class="hs-comment">-- this function is running.</span><span>
</span><a name="line-1002"></a><span class="hs-comment">--</span><span>
</span><a name="line-1003"></a><span class="hs-comment">-- Since symbolic links (and, on non-Windows systems, parent directories @..@)</span><span>
</span><a name="line-1004"></a><span class="hs-comment">-- are dependent on the state of the existing filesystem, the function can</span><span>
</span><a name="line-1005"></a><span class="hs-comment">-- only make a conservative attempt by removing such indirections from the</span><span>
</span><a name="line-1006"></a><span class="hs-comment">-- longest prefix of the path that still points to an existing file or</span><span>
</span><a name="line-1007"></a><span class="hs-comment">-- directory.</span><span>
</span><a name="line-1008"></a><span class="hs-comment">--</span><span>
</span><a name="line-1009"></a><span class="hs-comment">-- Note that on Windows parent directories @..@ are always fully expanded</span><span>
</span><a name="line-1010"></a><span class="hs-comment">-- before the symbolic links, as consistent with the rest of the Windows API</span><span>
</span><a name="line-1011"></a><span class="hs-comment">-- (such as @GetFullPathName@).  In contrast, on POSIX systems parent</span><span>
</span><a name="line-1012"></a><span class="hs-comment">-- directories @..@ are expanded alongside symbolic links from left to right.</span><span>
</span><a name="line-1013"></a><span class="hs-comment">-- To put this more concretely: if @L@ is a symbolic link for @R/P@, then on</span><span>
</span><a name="line-1014"></a><span class="hs-comment">-- Windows @L\\..@ refers to @.@, whereas on other operating systems @L/..@</span><span>
</span><a name="line-1015"></a><span class="hs-comment">-- refers to @R@.</span><span>
</span><a name="line-1016"></a><span class="hs-comment">--</span><span>
</span><a name="line-1017"></a><span class="hs-comment">-- Similar to 'normalise', passing an empty path is equivalent to passing the</span><span>
</span><a name="line-1018"></a><span class="hs-comment">-- current directory.</span><span>
</span><a name="line-1019"></a><span class="hs-comment">--</span><span>
</span><a name="line-1020"></a><span class="hs-comment">-- /Known bugs/: When the path contains an existing symbolic link, but the</span><span>
</span><a name="line-1021"></a><span class="hs-comment">-- target of the link does not exist, then the path is not dereferenced (bug</span><span>
</span><a name="line-1022"></a><span class="hs-comment">-- #64).  Symbolic link expansion is not performed on Windows XP or earlier</span><span>
</span><a name="line-1023"></a><span class="hs-comment">-- due to the absence of @GetFinalPathNameByHandle@.</span><span>
</span><a name="line-1024"></a><span class="hs-comment">--</span><span>
</span><a name="line-1025"></a><span class="hs-comment">-- /Changes since 1.2.3.0:/ The function has been altered to be more robust</span><span>
</span><a name="line-1026"></a><span class="hs-comment">-- and has the same exception behavior as 'makeAbsolute'.</span><span>
</span><a name="line-1027"></a><span class="hs-comment">--</span><span>
</span><a name="line-1028"></a><span class="hs-comment">-- /Changes since 1.3.0.0:/ The function no longer preserves the trailing path</span><span>
</span><a name="line-1029"></a><span class="hs-comment">-- separator.  File symbolic links that appear in the middle of a path are</span><span>
</span><a name="line-1030"></a><span class="hs-comment">-- properly dereferenced.  Case canonicalization and symbolic link expansion</span><span>
</span><a name="line-1031"></a><span class="hs-comment">-- are now performed on Windows.</span><span>
</span><a name="line-1032"></a><span class="hs-comment">--</span><span>
</span><a name="line-1033"></a><span class="hs-identifier">canonicalizePath</span><span> </span><span class="hs-glyph">::</span><span> </span><a href="../base-4.10.0.0/src/%{MODULE/./-}.html#%{NAME}/GHC.IO.html#FilePath"><span class="hs-identifier hs-type">FilePath</span></a><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="hs-identifier hs-type">IO</span><span> </span><a href="../base-4.10.0.0/src/%{MODULE/./-}.html#%{NAME}/GHC.IO.html#FilePath"><span class="hs-identifier hs-type">FilePath</span></a><span>
</span><a name="line-1034"></a><a name="canonicalizePath"><a href="System.Directory.html#canonicalizePath"><span class="hs-identifier">canonicalizePath</span></a></a><span> </span><span class="hs-glyph">=</span><span> </span><span class="hs-glyph">\</span><span> </span><a name="local-6989586621679042599"><a href="#local-6989586621679042599"><span class="hs-identifier">path</span></a></a><span> </span><span class="hs-glyph">-&gt;</span><span>
</span><a name="line-1035"></a><span>  </span><a href="../base-4.10.0.0/src/%{MODULE/./-}.html#%{NAME}/System.IO.Error.html#modifyIOError"><span class="hs-identifier hs-var">modifyIOError</span></a><span> </span><span class="hs-special">(</span><span class="hs-special">(</span><span class="hs-special">`</span><a href="System.Directory.html#ioeAddLocation"><span class="hs-identifier hs-var">ioeAddLocation</span></a><span class="hs-special">`</span><span> </span><span class="hs-string">&quot;canonicalizePath&quot;</span><span class="hs-special">)</span><span> </span><a href="../base-4.10.0.0/src/%{MODULE/./-}.html#%{NAME}/GHC.Base.html#."><span class="hs-operator hs-var">.</span></a><span>
</span><a name="line-1036"></a><span>                 </span><span class="hs-special">(</span><span class="hs-special">`</span><a href="../base-4.10.0.0/src/%{MODULE/./-}.html#%{NAME}/System.IO.Error.html#ioeSetFileName"><span class="hs-identifier hs-var">ioeSetFileName</span></a><span class="hs-special">`</span><span> </span><a href="#local-6989586621679042599"><span class="hs-identifier hs-var">path</span></a><span class="hs-special">)</span><span class="hs-special">)</span><span> </span><a href="../base-4.10.0.0/src/%{MODULE/./-}.html#%{NAME}/GHC.Base.html#%24"><span class="hs-operator hs-var">$</span></a><span>
</span><a name="line-1037"></a><span>  </span><span class="hs-comment">-- normalise does more stuff, like upper-casing the drive letter</span><span>
</span><a name="line-1038"></a><span>  </span><a href="../filepath-1.4.1.1/src/%{MODULE/./-}.html#%{NAME}/System.FilePath.Posix.html#dropTrailingPathSeparator"><span class="hs-identifier hs-var">dropTrailingPathSeparator</span></a><span> </span><a href="../base-4.10.0.0/src/%{MODULE/./-}.html#%{NAME}/GHC.Base.html#."><span class="hs-operator hs-var">.</span></a><span> </span><a href="../filepath-1.4.1.1/src/%{MODULE/./-}.html#%{NAME}/System.FilePath.Posix.html#normalise"><span class="hs-identifier hs-var">normalise</span></a><span> </span><a href="../base-4.10.0.0/src/%{MODULE/./-}.html#%{NAME}/Data.Functor.html#%3C%24%3E"><span class="hs-operator hs-var">&lt;$&gt;</span></a><span>
</span><a name="line-1039"></a><span>    </span><span class="hs-special">(</span><a href="#local-6989586621679042580"><span class="hs-identifier hs-var">transform</span></a><span> </span><a href="../base-4.10.0.0/src/%{MODULE/./-}.html#%{NAME}/GHC.Base.html#%3D%3C%3C"><span class="hs-operator hs-var">=&lt;&lt;</span></a><span> </span><a href="System.Directory.html#prependCurrentDirectory"><span class="hs-identifier hs-var">prependCurrentDirectory</span></a><span> </span><a href="#local-6989586621679042599"><span class="hs-identifier hs-var">path</span></a><span class="hs-special">)</span><span>
</span><a name="line-1040"></a><span>  </span><span class="hs-keyword">where</span><span>
</span><a name="line-1041"></a><span>
</span><a name="line-1042"></a><span class="hs-cpp">#if defined(mingw32_HOST_OS)</span><span>
</span><a name="line-1043"></a><span>    </span><span class="hs-identifier">transform</span><span> </span><span class="hs-identifier">path</span><span> </span><span class="hs-glyph">=</span><span>
</span><a name="line-1044"></a><span>      </span><span class="hs-identifier">attemptRealpath</span><span> </span><span class="hs-identifier">getFinalPathName</span><span> </span><span class="hs-operator">=&lt;&lt;</span><span>
</span><a name="line-1045"></a><span>        </span><span class="hs-special">(</span><span class="hs-identifier">Win32</span><span class="hs-operator">.</span><span class="hs-identifier">getFullPathName</span><span> </span><span class="hs-identifier">path</span><span> </span><span class="hs-special">`</span><span class="hs-identifier">catchIOError</span><span class="hs-special">`</span><span> </span><span class="hs-glyph">\</span><span> </span><span class="hs-identifier">_</span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="hs-identifier">return</span><span> </span><span class="hs-identifier">path</span><span class="hs-special">)</span><span>
</span><a name="line-1046"></a><span class="hs-cpp">#else</span><span>
</span><a name="line-1047"></a><span>    </span><a name="local-6989586621679042580"><a href="#local-6989586621679042580"><span class="hs-identifier">transform</span></a></a><span> </span><a name="local-6989586621679042583"><a href="#local-6989586621679042583"><span class="hs-identifier">path</span></a></a><span> </span><span class="hs-glyph">=</span><span> </span><span class="hs-keyword">do</span><span>
</span><a name="line-1048"></a><span>      </span><a name="local-6989586621679042584"><a href="#local-6989586621679042584"><span class="hs-identifier">encoding</span></a></a><span> </span><span class="hs-glyph">&lt;-</span><span> </span><a href="../base-4.10.0.0/src/%{MODULE/./-}.html#%{NAME}/GHC.IO.Encoding.html#getFileSystemEncoding"><span class="hs-identifier hs-var">getFileSystemEncoding</span></a><span>
</span><a name="line-1049"></a><span>      </span><span class="hs-keyword">let</span><span> </span><a name="local-6989586621679042585"><a href="#local-6989586621679042585"><span class="hs-identifier">realpath</span></a></a><span> </span><a name="local-6989586621679042586"><a href="#local-6989586621679042586"><span class="hs-identifier">path'</span></a></a><span> </span><span class="hs-glyph">=</span><span>
</span><a name="line-1050"></a><span>            </span><a href="../base-4.10.0.0/src/%{MODULE/./-}.html#%{NAME}/GHC.Foreign.html#withCString"><span class="hs-identifier hs-var">GHC</span><span class="hs-operator hs-var">.</span><span class="hs-identifier hs-var">withCString</span></a><span> </span><a href="#local-6989586621679042584"><span class="hs-identifier hs-var">encoding</span></a><span> </span><a href="#local-6989586621679042586"><span class="hs-identifier hs-var">path'</span></a><span>
</span><a name="line-1051"></a><span>              </span><span class="hs-special">(</span><span class="hs-special">`</span><a href="System.Directory.Internal.Posix.html#withRealpath"><span class="hs-identifier hs-var">withRealpath</span></a><span class="hs-special">`</span><span> </span><a href="../base-4.10.0.0/src/%{MODULE/./-}.html#%{NAME}/GHC.Foreign.html#peekCString"><span class="hs-identifier hs-var">GHC</span><span class="hs-operator hs-var">.</span><span class="hs-identifier hs-var">peekCString</span></a><span> </span><a href="#local-6989586621679042584"><span class="hs-identifier hs-var">encoding</span></a><span class="hs-special">)</span><span>
</span><a name="line-1052"></a><span>      </span><a href="#local-6989586621679042581"><span class="hs-identifier hs-var">attemptRealpath</span></a><span> </span><a href="#local-6989586621679042585"><span class="hs-identifier hs-var">realpath</span></a><span> </span><a href="#local-6989586621679042583"><span class="hs-identifier hs-var">path</span></a><span>
</span><a name="line-1053"></a><span class="hs-cpp">#endif</span><span>
</span><a name="line-1054"></a><span>
</span><a name="line-1055"></a><span>    </span><a name="local-6989586621679042581"><a href="#local-6989586621679042581"><span class="hs-identifier">attemptRealpath</span></a></a><span> </span><a name="local-6989586621679042587"><a href="#local-6989586621679042587"><span class="hs-identifier">realpath</span></a></a><span> </span><a name="local-6989586621679042588"><a href="#local-6989586621679042588"><span class="hs-identifier">path</span></a></a><span> </span><span class="hs-glyph">=</span><span>
</span><a name="line-1056"></a><span>      </span><a href="#local-6989586621679042582"><span class="hs-identifier hs-var">realpathPrefix</span></a><span> </span><a href="#local-6989586621679042587"><span class="hs-identifier hs-var">realpath</span></a><span> </span><span class="hs-special">(</span><a href="../base-4.10.0.0/src/%{MODULE/./-}.html#%{NAME}/GHC.List.html#reverse"><span class="hs-identifier hs-var">reverse</span></a><span> </span><span class="hs-special">(</span><a href="../base-4.10.0.0/src/%{MODULE/./-}.html#%{NAME}/GHC.List.html#zip"><span class="hs-identifier hs-var">zip</span></a><span> </span><a href="#local-6989586621679042590"><span class="hs-identifier hs-var">prefixes</span></a><span> </span><a href="#local-6989586621679042591"><span class="hs-identifier hs-var">suffixes</span></a><span class="hs-special">)</span><span class="hs-special">)</span><span> </span><a href="#local-6989586621679042588"><span class="hs-identifier hs-var">path</span></a><span>
</span><a name="line-1057"></a><span>      </span><span class="hs-keyword">where</span><span> </span><a name="local-6989586621679042589"><a href="#local-6989586621679042589"><span class="hs-identifier">segments</span></a></a><span> </span><span class="hs-glyph">=</span><span> </span><a href="../filepath-1.4.1.1/src/%{MODULE/./-}.html#%{NAME}/System.FilePath.Posix.html#splitDirectories"><span class="hs-identifier hs-var">splitDirectories</span></a><span> </span><a href="#local-6989586621679042588"><span class="hs-identifier hs-var">path</span></a><span>
</span><a name="line-1058"></a><span>            </span><a name="local-6989586621679042590"><a href="#local-6989586621679042590"><span class="hs-identifier">prefixes</span></a></a><span> </span><span class="hs-glyph">=</span><span> </span><a href="../base-4.10.0.0/src/%{MODULE/./-}.html#%{NAME}/GHC.List.html#scanl1"><span class="hs-identifier hs-var">scanl1</span></a><span> </span><span class="hs-special">(</span><a href="../filepath-1.4.1.1/src/%{MODULE/./-}.html#%{NAME}/System.FilePath.Posix.html#%3C%2F%3E"><span class="hs-operator hs-var">&lt;/&gt;</span></a><span class="hs-special">)</span><span> </span><a href="#local-6989586621679042589"><span class="hs-identifier hs-var">segments</span></a><span>
</span><a name="line-1059"></a><span>            </span><a name="local-6989586621679042591"><a href="#local-6989586621679042591"><span class="hs-identifier">suffixes</span></a></a><span> </span><span class="hs-glyph">=</span><span> </span><a href="../base-4.10.0.0/src/%{MODULE/./-}.html#%{NAME}/GHC.List.html#tail"><span class="hs-identifier hs-var">tail</span></a><span> </span><span class="hs-special">(</span><a href="../base-4.10.0.0/src/%{MODULE/./-}.html#%{NAME}/GHC.List.html#scanr"><span class="hs-identifier hs-var">scanr</span></a><span> </span><span class="hs-special">(</span><a href="../filepath-1.4.1.1/src/%{MODULE/./-}.html#%{NAME}/System.FilePath.Posix.html#%3C%2F%3E"><span class="hs-operator hs-var">&lt;/&gt;</span></a><span class="hs-special">)</span><span> </span><span class="hs-string">&quot;&quot;</span><span> </span><a href="#local-6989586621679042589"><span class="hs-identifier hs-var">segments</span></a><span class="hs-special">)</span><span>
</span><a name="line-1060"></a><span>
</span><a name="line-1061"></a><span>    </span><span class="hs-comment">-- call realpath on the largest possible prefix</span><span>
</span><a name="line-1062"></a><span>    </span><a name="local-6989586621679042582"><a href="#local-6989586621679042582"><span class="hs-identifier">realpathPrefix</span></a></a><span> </span><a name="local-6989586621679042592"><a href="#local-6989586621679042592"><span class="hs-identifier">realpath</span></a></a><span> </span><span class="hs-special">(</span><span class="hs-special">(</span><a name="local-6989586621679042593"><a href="#local-6989586621679042593"><span class="hs-identifier">prefix</span></a></a><span class="hs-special">,</span><span> </span><a name="local-6989586621679042594"><a href="#local-6989586621679042594"><span class="hs-identifier">suffix</span></a></a><span class="hs-special">)</span><span> </span><span class="hs-glyph">:</span><span> </span><a name="local-6989586621679042595"><a href="#local-6989586621679042595"><span class="hs-identifier">rest</span></a></a><span class="hs-special">)</span><span> </span><a name="local-6989586621679042596"><a href="#local-6989586621679042596"><span class="hs-identifier">path</span></a></a><span> </span><span class="hs-glyph">=</span><span> </span><span class="hs-keyword">do</span><span>
</span><a name="line-1063"></a><span>      </span><a name="local-6989586621679042597"><a href="#local-6989586621679042597"><span class="hs-identifier">exist</span></a></a><span> </span><span class="hs-glyph">&lt;-</span><span> </span><a href="System.Directory.html#doesPathExist"><span class="hs-identifier hs-var">doesPathExist</span></a><span> </span><a href="#local-6989586621679042593"><span class="hs-identifier hs-var">prefix</span></a><span>
</span><a name="line-1064"></a><span>      </span><span class="hs-keyword">if</span><span> </span><a href="#local-6989586621679042597"><span class="hs-identifier hs-var">exist</span></a><span> </span><span class="hs-comment">-- never call realpath on an inaccessible path</span><span>
</span><a name="line-1065"></a><span>        </span><span class="hs-keyword">then</span><span> </span><span class="hs-special">(</span><span class="hs-special">(</span><a href="../filepath-1.4.1.1/src/%{MODULE/./-}.html#%{NAME}/System.FilePath.Posix.html#%3C%2F%3E"><span class="hs-operator hs-var">&lt;/&gt;</span></a><span> </span><a href="#local-6989586621679042594"><span class="hs-identifier hs-var">suffix</span></a><span class="hs-special">)</span><span> </span><a href="../base-4.10.0.0/src/%{MODULE/./-}.html#%{NAME}/Data.Functor.html#%3C%24%3E"><span class="hs-operator hs-var">&lt;$&gt;</span></a><span> </span><a href="#local-6989586621679042592"><span class="hs-identifier hs-var">realpath</span></a><span> </span><a href="#local-6989586621679042593"><span class="hs-identifier hs-var">prefix</span></a><span class="hs-special">)</span><span>
</span><a name="line-1066"></a><span>             </span><span class="hs-special">`</span><a href="../base-4.10.0.0/src/%{MODULE/./-}.html#%{NAME}/System.IO.Error.html#catchIOError"><span class="hs-identifier hs-var">catchIOError</span></a><span class="hs-special">`</span><span> </span><span class="hs-glyph">\</span><span> </span><span class="hs-identifier">_</span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><a href="#local-6989586621679042582"><span class="hs-identifier hs-var">realpathPrefix</span></a><span> </span><a href="#local-6989586621679042592"><span class="hs-identifier hs-var">realpath</span></a><span> </span><a href="#local-6989586621679042595"><span class="hs-identifier hs-var">rest</span></a><span> </span><a href="#local-6989586621679042596"><span class="hs-identifier hs-var">path</span></a><span>
</span><a name="line-1067"></a><span>        </span><span class="hs-keyword">else</span><span> </span><a href="#local-6989586621679042582"><span class="hs-identifier hs-var">realpathPrefix</span></a><span> </span><a href="#local-6989586621679042592"><span class="hs-identifier hs-var">realpath</span></a><span> </span><a href="#local-6989586621679042595"><span class="hs-identifier hs-var">rest</span></a><span> </span><a href="#local-6989586621679042596"><span class="hs-identifier hs-var">path</span></a><span>
</span><a name="line-1068"></a><span>    </span><span class="hs-identifier">realpathPrefix</span><span> </span><span class="hs-identifier">_</span><span> </span><span class="hs-identifier">_</span><span> </span><a name="local-6989586621679042598"><a href="#local-6989586621679042598"><span class="hs-identifier">path</span></a></a><span> </span><span class="hs-glyph">=</span><span> </span><a href="../base-4.10.0.0/src/%{MODULE/./-}.html#%{NAME}/GHC.Base.html#return"><span class="hs-identifier hs-var">return</span></a><span> </span><a href="#local-6989586621679042598"><span class="hs-identifier hs-var">path</span></a><span>
</span><a name="line-1069"></a><span>
</span><a name="line-1070"></a><span class="hs-comment">-- | Convert a path into an absolute path.  If the given path is relative, the</span><span>
</span><a name="line-1071"></a><span class="hs-comment">-- current directory is prepended and then the combined result is</span><span>
</span><a name="line-1072"></a><span class="hs-comment">-- 'normalise'd.  If the path is already absolute, the path is simply</span><span>
</span><a name="line-1073"></a><span class="hs-comment">-- 'normalise'd.  The function preserves the presence or absence of the</span><span>
</span><a name="line-1074"></a><span class="hs-comment">-- trailing path separator unless the path refers to the root directory @/@.</span><span>
</span><a name="line-1075"></a><span class="hs-comment">--</span><span>
</span><a name="line-1076"></a><span class="hs-comment">-- If the path is already absolute, the operation never fails.  Otherwise, the</span><span>
</span><a name="line-1077"></a><span class="hs-comment">-- operation may fail with the same exceptions as 'getCurrentDirectory'.</span><span>
</span><a name="line-1078"></a><span class="hs-comment">--</span><span>
</span><a name="line-1079"></a><span class="hs-comment">-- @since 1.2.2.0</span><span>
</span><a name="line-1080"></a><span class="hs-comment">--</span><span>
</span><a name="line-1081"></a><span class="hs-identifier">makeAbsolute</span><span> </span><span class="hs-glyph">::</span><span> </span><a href="../base-4.10.0.0/src/%{MODULE/./-}.html#%{NAME}/GHC.IO.html#FilePath"><span class="hs-identifier hs-type">FilePath</span></a><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="hs-identifier hs-type">IO</span><span> </span><a href="../base-4.10.0.0/src/%{MODULE/./-}.html#%{NAME}/GHC.IO.html#FilePath"><span class="hs-identifier hs-type">FilePath</span></a><span>
</span><a name="line-1082"></a><a name="makeAbsolute"><a href="System.Directory.html#makeAbsolute"><span class="hs-identifier">makeAbsolute</span></a></a><span> </span><a name="local-6989586621679042600"><a href="#local-6989586621679042600"><span class="hs-identifier">path</span></a></a><span> </span><span class="hs-glyph">=</span><span>
</span><a name="line-1083"></a><span>  </span><a href="../base-4.10.0.0/src/%{MODULE/./-}.html#%{NAME}/System.IO.Error.html#modifyIOError"><span class="hs-identifier hs-var">modifyIOError</span></a><span> </span><span class="hs-special">(</span><span class="hs-special">(</span><span class="hs-special">`</span><a href="System.Directory.html#ioeAddLocation"><span class="hs-identifier hs-var">ioeAddLocation</span></a><span class="hs-special">`</span><span> </span><span class="hs-string">&quot;makeAbsolute&quot;</span><span class="hs-special">)</span><span> </span><a href="../base-4.10.0.0/src/%{MODULE/./-}.html#%{NAME}/GHC.Base.html#."><span class="hs-operator hs-var">.</span></a><span>
</span><a name="line-1084"></a><span>                 </span><span class="hs-special">(</span><span class="hs-special">`</span><a href="../base-4.10.0.0/src/%{MODULE/./-}.html#%{NAME}/System.IO.Error.html#ioeSetFileName"><span class="hs-identifier hs-var">ioeSetFileName</span></a><span class="hs-special">`</span><span> </span><a href="#local-6989586621679042600"><span class="hs-identifier hs-var">path</span></a><span class="hs-special">)</span><span class="hs-special">)</span><span> </span><a href="../base-4.10.0.0/src/%{MODULE/./-}.html#%{NAME}/GHC.Base.html#%24"><span class="hs-operator hs-var">$</span></a><span>
</span><a name="line-1085"></a><span>  </span><a href="System.Directory.html#matchTrailingSeparator"><span class="hs-identifier hs-var">matchTrailingSeparator</span></a><span> </span><a href="#local-6989586621679042600"><span class="hs-identifier hs-var">path</span></a><span> </span><a href="../base-4.10.0.0/src/%{MODULE/./-}.html#%{NAME}/GHC.Base.html#."><span class="hs-operator hs-var">.</span></a><span> </span><a href="../filepath-1.4.1.1/src/%{MODULE/./-}.html#%{NAME}/System.FilePath.Posix.html#normalise"><span class="hs-identifier hs-var">normalise</span></a><span> </span><a href="../base-4.10.0.0/src/%{MODULE/./-}.html#%{NAME}/Data.Functor.html#%3C%24%3E"><span class="hs-operator hs-var">&lt;$&gt;</span></a><span> </span><a href="System.Directory.html#prependCurrentDirectory"><span class="hs-identifier hs-var">prependCurrentDirectory</span></a><span> </span><a href="#local-6989586621679042600"><span class="hs-identifier hs-var">path</span></a><span>
</span><a name="line-1086"></a><span>
</span><a name="line-1087"></a><span class="hs-comment">-- | Convert a path into an absolute path.  If the given path is relative, the</span><span>
</span><a name="line-1088"></a><span class="hs-comment">-- current directory is prepended.  If the path is already absolute, the path</span><span>
</span><a name="line-1089"></a><span class="hs-comment">-- is returned unchanged.  The function preserves the presence or absence of</span><span>
</span><a name="line-1090"></a><span class="hs-comment">-- the trailing path separator.</span><span>
</span><a name="line-1091"></a><span class="hs-comment">--</span><span>
</span><a name="line-1092"></a><span class="hs-comment">-- If the path is already absolute, the operation never fails.  Otherwise, the</span><span>
</span><a name="line-1093"></a><span class="hs-comment">-- operation may fail with the same exceptions as 'getCurrentDirectory'.</span><span>
</span><a name="line-1094"></a><span class="hs-comment">--</span><span>
</span><a name="line-1095"></a><span class="hs-comment">-- (internal API)</span><span>
</span><a name="line-1096"></a><span class="hs-identifier">prependCurrentDirectory</span><span> </span><span class="hs-glyph">::</span><span> </span><a href="../base-4.10.0.0/src/%{MODULE/./-}.html#%{NAME}/GHC.IO.html#FilePath"><span class="hs-identifier hs-type">FilePath</span></a><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="hs-identifier hs-type">IO</span><span> </span><a href="../base-4.10.0.0/src/%{MODULE/./-}.html#%{NAME}/GHC.IO.html#FilePath"><span class="hs-identifier hs-type">FilePath</span></a><span>
</span><a name="line-1097"></a><a name="prependCurrentDirectory"><a href="System.Directory.html#prependCurrentDirectory"><span class="hs-identifier">prependCurrentDirectory</span></a></a><span> </span><a name="local-6989586621679042601"><a href="#local-6989586621679042601"><span class="hs-identifier">path</span></a></a><span> </span><span class="hs-glyph">=</span><span>
</span><a name="line-1098"></a><span>  </span><a href="../base-4.10.0.0/src/%{MODULE/./-}.html#%{NAME}/System.IO.Error.html#modifyIOError"><span class="hs-identifier hs-var">modifyIOError</span></a><span> </span><span class="hs-special">(</span><span class="hs-special">(</span><span class="hs-special">`</span><a href="System.Directory.html#ioeAddLocation"><span class="hs-identifier hs-var">ioeAddLocation</span></a><span class="hs-special">`</span><span> </span><span class="hs-string">&quot;prependCurrentDirectory&quot;</span><span class="hs-special">)</span><span> </span><a href="../base-4.10.0.0/src/%{MODULE/./-}.html#%{NAME}/GHC.Base.html#."><span class="hs-operator hs-var">.</span></a><span>
</span><a name="line-1099"></a><span>                 </span><span class="hs-special">(</span><span class="hs-special">`</span><a href="../base-4.10.0.0/src/%{MODULE/./-}.html#%{NAME}/System.IO.Error.html#ioeSetFileName"><span class="hs-identifier hs-var">ioeSetFileName</span></a><span class="hs-special">`</span><span> </span><a href="#local-6989586621679042601"><span class="hs-identifier hs-var">path</span></a><span class="hs-special">)</span><span class="hs-special">)</span><span> </span><a href="../base-4.10.0.0/src/%{MODULE/./-}.html#%{NAME}/GHC.Base.html#%24"><span class="hs-operator hs-var">$</span></a><span>
</span><a name="line-1100"></a><span>  </span><span class="hs-keyword">if</span><span> </span><a href="../filepath-1.4.1.1/src/%{MODULE/./-}.html#%{NAME}/System.FilePath.Posix.html#isRelative"><span class="hs-identifier hs-var">isRelative</span></a><span> </span><a href="#local-6989586621679042601"><span class="hs-identifier hs-var">path</span></a><span> </span><span class="hs-comment">-- avoid the call to `getCurrentDirectory` if we can</span><span>
</span><a name="line-1101"></a><span>  </span><span class="hs-keyword">then</span><span> </span><span class="hs-special">(</span><a href="../filepath-1.4.1.1/src/%{MODULE/./-}.html#%{NAME}/System.FilePath.Posix.html#%3C%2F%3E"><span class="hs-operator hs-var">&lt;/&gt;</span></a><span> </span><a href="#local-6989586621679042601"><span class="hs-identifier hs-var">path</span></a><span class="hs-special">)</span><span> </span><a href="../base-4.10.0.0/src/%{MODULE/./-}.html#%{NAME}/Data.Functor.html#%3C%24%3E"><span class="hs-operator hs-var">&lt;$&gt;</span></a><span> </span><a href="System.Directory.html#getCurrentDirectory"><span class="hs-identifier hs-var">getCurrentDirectory</span></a><span>
</span><a name="line-1102"></a><span>  </span><span class="hs-keyword">else</span><span> </span><a href="../base-4.10.0.0/src/%{MODULE/./-}.html#%{NAME}/GHC.Base.html#return"><span class="hs-identifier hs-var">return</span></a><span> </span><a href="#local-6989586621679042601"><span class="hs-identifier hs-var">path</span></a><span>
</span><a name="line-1103"></a><span>
</span><a name="line-1104"></a><span class="hs-comment">-- | Add or remove the trailing path separator in the second path so as to</span><span>
</span><a name="line-1105"></a><span class="hs-comment">-- match its presence in the first path.</span><span>
</span><a name="line-1106"></a><span class="hs-comment">--</span><span>
</span><a name="line-1107"></a><span class="hs-comment">-- (internal API)</span><span>
</span><a name="line-1108"></a><span class="hs-identifier">matchTrailingSeparator</span><span> </span><span class="hs-glyph">::</span><span> </span><a href="../base-4.10.0.0/src/%{MODULE/./-}.html#%{NAME}/GHC.IO.html#FilePath"><span class="hs-identifier hs-type">FilePath</span></a><span> </span><span class="hs-glyph">-&gt;</span><span> </span><a href="../base-4.10.0.0/src/%{MODULE/./-}.html#%{NAME}/GHC.IO.html#FilePath"><span class="hs-identifier hs-type">FilePath</span></a><span> </span><span class="hs-glyph">-&gt;</span><span> </span><a href="../base-4.10.0.0/src/%{MODULE/./-}.html#%{NAME}/GHC.IO.html#FilePath"><span class="hs-identifier hs-type">FilePath</span></a><span>
</span><a name="line-1109"></a><a name="matchTrailingSeparator"><a href="System.Directory.html#matchTrailingSeparator"><span class="hs-identifier">matchTrailingSeparator</span></a></a><span> </span><a name="local-6989586621679042602"><a href="#local-6989586621679042602"><span class="hs-identifier">path</span></a></a><span>
</span><a name="line-1110"></a><span>  </span><span class="hs-glyph">|</span><span> </span><a href="../filepath-1.4.1.1/src/%{MODULE/./-}.html#%{NAME}/System.FilePath.Posix.html#hasTrailingPathSeparator"><span class="hs-identifier hs-var">hasTrailingPathSeparator</span></a><span> </span><a href="#local-6989586621679042602"><span class="hs-identifier hs-var">path</span></a><span> </span><span class="hs-glyph">=</span><span> </span><a href="../filepath-1.4.1.1/src/%{MODULE/./-}.html#%{NAME}/System.FilePath.Posix.html#addTrailingPathSeparator"><span class="hs-identifier hs-var">addTrailingPathSeparator</span></a><span>
</span><a name="line-1111"></a><span>  </span><span class="hs-glyph">|</span><span> </span><a href="../base-4.10.0.0/src/%{MODULE/./-}.html#%{NAME}/GHC.Base.html#otherwise"><span class="hs-identifier hs-var">otherwise</span></a><span>                     </span><span class="hs-glyph">=</span><span> </span><a href="../filepath-1.4.1.1/src/%{MODULE/./-}.html#%{NAME}/System.FilePath.Posix.html#dropTrailingPathSeparator"><span class="hs-identifier hs-var">dropTrailingPathSeparator</span></a><span>
</span><a name="line-1112"></a><span>
</span><a name="line-1113"></a><span class="hs-comment">-- | Construct a path relative to the current directory, similar to</span><span>
</span><a name="line-1114"></a><span class="hs-comment">-- 'makeRelative'.</span><span>
</span><a name="line-1115"></a><span class="hs-comment">--</span><span>
</span><a name="line-1116"></a><span class="hs-comment">-- The operation may fail with the same exceptions as 'getCurrentDirectory'.</span><span>
</span><a name="line-1117"></a><span class="hs-identifier">makeRelativeToCurrentDirectory</span><span> </span><span class="hs-glyph">::</span><span> </span><a href="../base-4.10.0.0/src/%{MODULE/./-}.html#%{NAME}/GHC.IO.html#FilePath"><span class="hs-identifier hs-type">FilePath</span></a><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="hs-identifier hs-type">IO</span><span> </span><a href="../base-4.10.0.0/src/%{MODULE/./-}.html#%{NAME}/GHC.IO.html#FilePath"><span class="hs-identifier hs-type">FilePath</span></a><span>
</span><a name="line-1118"></a><a name="makeRelativeToCurrentDirectory"><a href="System.Directory.html#makeRelativeToCurrentDirectory"><span class="hs-identifier">makeRelativeToCurrentDirectory</span></a></a><span> </span><a name="local-6989586621679042603"><a href="#local-6989586621679042603"><span class="hs-identifier">x</span></a></a><span> </span><span class="hs-glyph">=</span><span> </span><span class="hs-keyword">do</span><span>
</span><a name="line-1119"></a><span>    </span><a name="local-6989586621679042604"><a href="#local-6989586621679042604"><span class="hs-identifier">cur</span></a></a><span> </span><span class="hs-glyph">&lt;-</span><span> </span><a href="System.Directory.html#getCurrentDirectory"><span class="hs-identifier hs-var">getCurrentDirectory</span></a><span>
</span><a name="line-1120"></a><span>    </span><a href="../base-4.10.0.0/src/%{MODULE/./-}.html#%{NAME}/GHC.Base.html#return"><span class="hs-identifier hs-var">return</span></a><span> </span><a href="../base-4.10.0.0/src/%{MODULE/./-}.html#%{NAME}/GHC.Base.html#%24"><span class="hs-operator hs-var">$</span></a><span> </span><a href="../filepath-1.4.1.1/src/%{MODULE/./-}.html#%{NAME}/System.FilePath.Posix.html#makeRelative"><span class="hs-identifier hs-var">makeRelative</span></a><span> </span><a href="#local-6989586621679042604"><span class="hs-identifier hs-var">cur</span></a><span> </span><a href="#local-6989586621679042603"><span class="hs-identifier hs-var">x</span></a><span>
</span><a name="line-1121"></a><span>
</span><a name="line-1122"></a><span class="hs-comment">-- | Given an executable file name, searches for such file in the</span><span>
</span><a name="line-1123"></a><span class="hs-comment">-- directories listed in system PATH. The returned value is the path</span><span>
</span><a name="line-1124"></a><span class="hs-comment">-- to the found executable or Nothing if an executable with the given</span><span>
</span><a name="line-1125"></a><span class="hs-comment">-- name was not found. For example (findExecutable \&quot;ghc\&quot;) gives you</span><span>
</span><a name="line-1126"></a><span class="hs-comment">-- the path to GHC.</span><span>
</span><a name="line-1127"></a><span class="hs-comment">--</span><span>
</span><a name="line-1128"></a><span class="hs-comment">-- The path returned by 'findExecutable' corresponds to the</span><span>
</span><a name="line-1129"></a><span class="hs-comment">-- program that would be executed by 'System.Process.createProcess'</span><span>
</span><a name="line-1130"></a><span class="hs-comment">-- when passed the same string (as a RawCommand, not a ShellCommand).</span><span>
</span><a name="line-1131"></a><span class="hs-comment">--</span><span>
</span><a name="line-1132"></a><span class="hs-comment">-- On Windows, 'findExecutable' calls the Win32 function 'SearchPath',</span><span>
</span><a name="line-1133"></a><span class="hs-comment">-- which may search other places before checking the directories in</span><span>
</span><a name="line-1134"></a><span class="hs-comment">-- @PATH@.  Where it actually searches depends on registry settings,</span><span>
</span><a name="line-1135"></a><span class="hs-comment">-- but notably includes the directory containing the current</span><span>
</span><a name="line-1136"></a><span class="hs-comment">-- executable. See</span><span>
</span><a name="line-1137"></a><span class="hs-comment">-- &lt;http://msdn.microsoft.com/en-us/library/aa365527.aspx&gt; for more</span><span>
</span><a name="line-1138"></a><span class="hs-comment">-- details.</span><span>
</span><a name="line-1139"></a><span class="hs-comment">--</span><span>
</span><a name="line-1140"></a><span class="hs-identifier">findExecutable</span><span> </span><span class="hs-glyph">::</span><span> </span><a href="../base-4.10.0.0/src/%{MODULE/./-}.html#%{NAME}/GHC.Base.html#String"><span class="hs-identifier hs-type">String</span></a><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="hs-identifier hs-type">IO</span><span> </span><span class="hs-special">(</span><a href="../base-4.10.0.0/src/%{MODULE/./-}.html#%{NAME}/GHC.Base.html#Maybe"><span class="hs-identifier hs-type">Maybe</span></a><span> </span><a href="../base-4.10.0.0/src/%{MODULE/./-}.html#%{NAME}/GHC.IO.html#FilePath"><span class="hs-identifier hs-type">FilePath</span></a><span class="hs-special">)</span><span>
</span><a name="line-1141"></a><a name="findExecutable"><a href="System.Directory.html#findExecutable"><span class="hs-identifier">findExecutable</span></a></a><span> </span><a name="local-6989586621679042605"><a href="#local-6989586621679042605"><span class="hs-identifier">binary</span></a></a><span> </span><span class="hs-glyph">=</span><span> </span><span class="hs-keyword">do</span><span>
</span><a name="line-1142"></a><span class="hs-cpp">#if defined(mingw32_HOST_OS)</span><span>
</span><a name="line-1143"></a><span>    </span><span class="hs-identifier">Win32</span><span class="hs-operator">.</span><span class="hs-identifier">searchPath</span><span> </span><span class="hs-identifier">Nothing</span><span> </span><span class="hs-identifier">binary</span><span> </span><span class="hs-identifier">exeExtension</span><span>
</span><a name="line-1144"></a><span class="hs-cpp">#else</span><span>
</span><a name="line-1145"></a><span>    </span><a name="local-6989586621679042606"><a href="#local-6989586621679042606"><span class="hs-identifier">path</span></a></a><span> </span><span class="hs-glyph">&lt;-</span><span> </span><a href="System.Directory.html#getPath"><span class="hs-identifier hs-var">getPath</span></a><span>
</span><a name="line-1146"></a><span>    </span><a href="System.Directory.html#findFileWith"><span class="hs-identifier hs-var">findFileWith</span></a><span> </span><a href="System.Directory.html#isExecutable"><span class="hs-identifier hs-var">isExecutable</span></a><span> </span><a href="#local-6989586621679042606"><span class="hs-identifier hs-var">path</span></a><span> </span><span class="hs-special">(</span><a href="#local-6989586621679042605"><span class="hs-identifier hs-var">binary</span></a><span> </span><a href="../filepath-1.4.1.1/src/%{MODULE/./-}.html#%{NAME}/System.FilePath.Posix.html#%3C.%3E"><span class="hs-operator hs-var">&lt;.&gt;</span></a><span> </span><a href="System.Directory.Internal.Config.html#exeExtension"><span class="hs-identifier hs-var">exeExtension</span></a><span class="hs-special">)</span><span>
</span><a name="line-1147"></a><span class="hs-cpp">#endif</span><span>
</span><a name="line-1148"></a><span>
</span><a name="line-1149"></a><span class="hs-comment">-- | Given a file name, searches for the file and returns a list of all</span><span>
</span><a name="line-1150"></a><span class="hs-comment">-- occurences that are executable.</span><span>
</span><a name="line-1151"></a><span class="hs-comment">--</span><span>
</span><a name="line-1152"></a><span class="hs-comment">-- On Windows, this only returns the first ocurrence, if any.  It uses the</span><span>
</span><a name="line-1153"></a><span class="hs-comment">-- @SearchPath@ from the Win32 API, so the caveats noted in 'findExecutable'</span><span>
</span><a name="line-1154"></a><span class="hs-comment">-- apply here as well.</span><span>
</span><a name="line-1155"></a><span class="hs-comment">--</span><span>
</span><a name="line-1156"></a><span class="hs-comment">-- @since 1.2.2.0</span><span>
</span><a name="line-1157"></a><span class="hs-identifier">findExecutables</span><span> </span><span class="hs-glyph">::</span><span> </span><a href="../base-4.10.0.0/src/%{MODULE/./-}.html#%{NAME}/GHC.Base.html#String"><span class="hs-identifier hs-type">String</span></a><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="hs-identifier hs-type">IO</span><span> </span><span class="hs-special">[</span><a href="../base-4.10.0.0/src/%{MODULE/./-}.html#%{NAME}/GHC.IO.html#FilePath"><span class="hs-identifier hs-type">FilePath</span></a><span class="hs-special">]</span><span>
</span><a name="line-1158"></a><a name="findExecutables"><a href="System.Directory.html#findExecutables"><span class="hs-identifier">findExecutables</span></a></a><span> </span><a name="local-6989586621679042607"><a href="#local-6989586621679042607"><span class="hs-identifier">binary</span></a></a><span> </span><span class="hs-glyph">=</span><span> </span><span class="hs-keyword">do</span><span>
</span><a name="line-1159"></a><span class="hs-cpp">#if defined(mingw32_HOST_OS)</span><span>
</span><a name="line-1160"></a><span>    </span><span class="hs-identifier">file</span><span> </span><span class="hs-glyph">&lt;-</span><span> </span><span class="hs-identifier">findExecutable</span><span> </span><span class="hs-identifier">binary</span><span>
</span><a name="line-1161"></a><span>    </span><span class="hs-identifier">return</span><span> </span><span class="hs-operator">$</span><span> </span><span class="hs-identifier">maybeToList</span><span> </span><span class="hs-identifier">file</span><span>
</span><a name="line-1162"></a><span class="hs-cpp">#else</span><span>
</span><a name="line-1163"></a><span>    </span><a name="local-6989586621679042608"><a href="#local-6989586621679042608"><span class="hs-identifier">path</span></a></a><span> </span><span class="hs-glyph">&lt;-</span><span> </span><a href="System.Directory.html#getPath"><span class="hs-identifier hs-var">getPath</span></a><span>
</span><a name="line-1164"></a><span>    </span><a href="System.Directory.html#findExecutablesInDirectories"><span class="hs-identifier hs-var">findExecutablesInDirectories</span></a><span> </span><a href="#local-6989586621679042608"><span class="hs-identifier hs-var">path</span></a><span> </span><a href="#local-6989586621679042607"><span class="hs-identifier hs-var">binary</span></a><span>
</span><a name="line-1165"></a><span class="hs-cpp">#endif</span><span>
</span><a name="line-1166"></a><span>
</span><a name="line-1167"></a><span class="hs-cpp">#ifndef mingw32_HOST_OS</span><span>
</span><a name="line-1168"></a><span class="hs-comment">-- | Get the contents of the @PATH@ environment variable.</span><span>
</span><a name="line-1169"></a><span class="hs-identifier">getPath</span><span> </span><span class="hs-glyph">::</span><span> </span><span class="hs-identifier hs-type">IO</span><span> </span><span class="hs-special">[</span><a href="../base-4.10.0.0/src/%{MODULE/./-}.html#%{NAME}/GHC.IO.html#FilePath"><span class="hs-identifier hs-type">FilePath</span></a><span class="hs-special">]</span><span>
</span><a name="line-1170"></a><a name="getPath"><a href="System.Directory.html#getPath"><span class="hs-identifier">getPath</span></a></a><span> </span><span class="hs-glyph">=</span><span> </span><span class="hs-keyword">do</span><span>
</span><a name="line-1171"></a><span>    </span><a name="local-6989586621679042609"><a href="#local-6989586621679042609"><span class="hs-identifier">path</span></a></a><span> </span><span class="hs-glyph">&lt;-</span><span> </span><a href="../base-4.10.0.0/src/%{MODULE/./-}.html#%{NAME}/System.Environment.html#getEnv"><span class="hs-identifier hs-var">getEnv</span></a><span> </span><span class="hs-string">&quot;PATH&quot;</span><span>
</span><a name="line-1172"></a><span>    </span><a href="../base-4.10.0.0/src/%{MODULE/./-}.html#%{NAME}/GHC.Base.html#return"><span class="hs-identifier hs-var">return</span></a><span> </span><span class="hs-special">(</span><a href="../filepath-1.4.1.1/src/%{MODULE/./-}.html#%{NAME}/System.FilePath.Posix.html#splitSearchPath"><span class="hs-identifier hs-var">splitSearchPath</span></a><span> </span><a href="#local-6989586621679042609"><span class="hs-identifier hs-var">path</span></a><span class="hs-special">)</span><span>
</span><a name="line-1173"></a><span class="hs-cpp">#endif</span><span>
</span><a name="line-1174"></a><span>
</span><a name="line-1175"></a><span class="hs-comment">-- | Given a file name, searches for the file on the given paths and returns a</span><span>
</span><a name="line-1176"></a><span class="hs-comment">-- list of all occurences that are executable.</span><span>
</span><a name="line-1177"></a><span class="hs-comment">--</span><span>
</span><a name="line-1178"></a><span class="hs-comment">-- @since 1.2.4.0</span><span>
</span><a name="line-1179"></a><span class="hs-identifier">findExecutablesInDirectories</span><span> </span><span class="hs-glyph">::</span><span> </span><span class="hs-special">[</span><a href="../base-4.10.0.0/src/%{MODULE/./-}.html#%{NAME}/GHC.IO.html#FilePath"><span class="hs-identifier hs-type">FilePath</span></a><span class="hs-special">]</span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><a href="../base-4.10.0.0/src/%{MODULE/./-}.html#%{NAME}/GHC.Base.html#String"><span class="hs-identifier hs-type">String</span></a><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="hs-identifier hs-type">IO</span><span> </span><span class="hs-special">[</span><a href="../base-4.10.0.0/src/%{MODULE/./-}.html#%{NAME}/GHC.IO.html#FilePath"><span class="hs-identifier hs-type">FilePath</span></a><span class="hs-special">]</span><span>
</span><a name="line-1180"></a><a name="findExecutablesInDirectories"><a href="System.Directory.html#findExecutablesInDirectories"><span class="hs-identifier">findExecutablesInDirectories</span></a></a><span> </span><a name="local-6989586621679042610"><a href="#local-6989586621679042610"><span class="hs-identifier">path</span></a></a><span> </span><a name="local-6989586621679042611"><a href="#local-6989586621679042611"><span class="hs-identifier">binary</span></a></a><span> </span><span class="hs-glyph">=</span><span>
</span><a name="line-1181"></a><span>    </span><a href="System.Directory.html#findFilesWith"><span class="hs-identifier hs-var">findFilesWith</span></a><span> </span><a href="System.Directory.html#isExecutable"><span class="hs-identifier hs-var">isExecutable</span></a><span> </span><a href="#local-6989586621679042610"><span class="hs-identifier hs-var">path</span></a><span> </span><span class="hs-special">(</span><a href="#local-6989586621679042611"><span class="hs-identifier hs-var">binary</span></a><span> </span><a href="../filepath-1.4.1.1/src/%{MODULE/./-}.html#%{NAME}/System.FilePath.Posix.html#%3C.%3E"><span class="hs-operator hs-var">&lt;.&gt;</span></a><span> </span><a href="System.Directory.Internal.Config.html#exeExtension"><span class="hs-identifier hs-var">exeExtension</span></a><span class="hs-special">)</span><span>
</span><a name="line-1182"></a><span>
</span><a name="line-1183"></a><span class="hs-comment">-- | Test whether a file is executable.</span><span>
</span><a name="line-1184"></a><span class="hs-identifier">isExecutable</span><span> </span><span class="hs-glyph">::</span><span> </span><a href="../base-4.10.0.0/src/%{MODULE/./-}.html#%{NAME}/GHC.IO.html#FilePath"><span class="hs-identifier hs-type">FilePath</span></a><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="hs-identifier hs-type">IO</span><span> </span><span class="hs-identifier hs-type">Bool</span><span>
</span><a name="line-1185"></a><a name="isExecutable"><a href="System.Directory.html#isExecutable"><span class="hs-identifier">isExecutable</span></a></a><span> </span><a name="local-6989586621679042612"><a href="#local-6989586621679042612"><span class="hs-identifier">file</span></a></a><span> </span><span class="hs-glyph">=</span><span> </span><span class="hs-keyword">do</span><span>
</span><a name="line-1186"></a><span>    </span><a name="local-6989586621679042613"><a href="#local-6989586621679042613"><span class="hs-identifier">perms</span></a></a><span> </span><span class="hs-glyph">&lt;-</span><span> </span><a href="System.Directory.html#getPermissions"><span class="hs-identifier hs-var">getPermissions</span></a><span> </span><a href="#local-6989586621679042612"><span class="hs-identifier hs-var">file</span></a><span>
</span><a name="line-1187"></a><span>    </span><a href="../base-4.10.0.0/src/%{MODULE/./-}.html#%{NAME}/GHC.Base.html#return"><span class="hs-identifier hs-var">return</span></a><span> </span><span class="hs-special">(</span><span class="hs-identifier">executable</span><span> </span><a href="#local-6989586621679042613"><span class="hs-identifier hs-var">perms</span></a><span class="hs-special">)</span><span>
</span><a name="line-1188"></a><span>
</span><a name="line-1189"></a><span class="hs-comment">-- | Search through the given set of directories for the given file.</span><span>
</span><a name="line-1190"></a><span class="hs-identifier">findFile</span><span> </span><span class="hs-glyph">::</span><span> </span><span class="hs-special">[</span><a href="../base-4.10.0.0/src/%{MODULE/./-}.html#%{NAME}/GHC.IO.html#FilePath"><span class="hs-identifier hs-type">FilePath</span></a><span class="hs-special">]</span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><a href="../base-4.10.0.0/src/%{MODULE/./-}.html#%{NAME}/GHC.Base.html#String"><span class="hs-identifier hs-type">String</span></a><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="hs-identifier hs-type">IO</span><span> </span><span class="hs-special">(</span><a href="../base-4.10.0.0/src/%{MODULE/./-}.html#%{NAME}/GHC.Base.html#Maybe"><span class="hs-identifier hs-type">Maybe</span></a><span> </span><a href="../base-4.10.0.0/src/%{MODULE/./-}.html#%{NAME}/GHC.IO.html#FilePath"><span class="hs-identifier hs-type">FilePath</span></a><span class="hs-special">)</span><span>
</span><a name="line-1191"></a><a name="findFile"><a href="System.Directory.html#findFile"><span class="hs-identifier">findFile</span></a></a><span> </span><span class="hs-glyph">=</span><span> </span><a href="System.Directory.html#findFileWith"><span class="hs-identifier hs-var">findFileWith</span></a><span> </span><span class="hs-special">(</span><span class="hs-glyph">\</span><span class="hs-identifier">_</span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><a href="../base-4.10.0.0/src/%{MODULE/./-}.html#%{NAME}/GHC.Base.html#return"><span class="hs-identifier hs-var">return</span></a><span> </span><span class="hs-identifier hs-var">True</span><span class="hs-special">)</span><span>
</span><a name="line-1192"></a><span>
</span><a name="line-1193"></a><span class="hs-comment">-- | Search through the given set of directories for the given file and</span><span>
</span><a name="line-1194"></a><span class="hs-comment">-- returns a list of paths where the given file exists.</span><span>
</span><a name="line-1195"></a><span class="hs-comment">--</span><span>
</span><a name="line-1196"></a><span class="hs-comment">-- @since 1.2.1.0</span><span>
</span><a name="line-1197"></a><span class="hs-identifier">findFiles</span><span> </span><span class="hs-glyph">::</span><span> </span><span class="hs-special">[</span><a href="../base-4.10.0.0/src/%{MODULE/./-}.html#%{NAME}/GHC.IO.html#FilePath"><span class="hs-identifier hs-type">FilePath</span></a><span class="hs-special">]</span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><a href="../base-4.10.0.0/src/%{MODULE/./-}.html#%{NAME}/GHC.Base.html#String"><span class="hs-identifier hs-type">String</span></a><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="hs-identifier hs-type">IO</span><span> </span><span class="hs-special">[</span><a href="../base-4.10.0.0/src/%{MODULE/./-}.html#%{NAME}/GHC.IO.html#FilePath"><span class="hs-identifier hs-type">FilePath</span></a><span class="hs-special">]</span><span>
</span><a name="line-1198"></a><a name="findFiles"><a href="System.Directory.html#findFiles"><span class="hs-identifier">findFiles</span></a></a><span> </span><span class="hs-glyph">=</span><span> </span><a href="System.Directory.html#findFilesWith"><span class="hs-identifier hs-var">findFilesWith</span></a><span> </span><span class="hs-special">(</span><span class="hs-glyph">\</span><span class="hs-identifier">_</span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><a href="../base-4.10.0.0/src/%{MODULE/./-}.html#%{NAME}/GHC.Base.html#return"><span class="hs-identifier hs-var">return</span></a><span> </span><span class="hs-identifier hs-var">True</span><span class="hs-special">)</span><span>
</span><a name="line-1199"></a><span>
</span><a name="line-1200"></a><span class="hs-comment">-- | Search through the given set of directories for the given file and</span><span>
</span><a name="line-1201"></a><span class="hs-comment">-- with the given property (usually permissions) and returns the file path</span><span>
</span><a name="line-1202"></a><span class="hs-comment">-- where the given file exists and has the property.</span><span>
</span><a name="line-1203"></a><span class="hs-comment">--</span><span>
</span><a name="line-1204"></a><span class="hs-comment">-- @since 1.2.6.0</span><span>
</span><a name="line-1205"></a><span class="hs-identifier">findFileWith</span><span> </span><span class="hs-glyph">::</span><span> </span><span class="hs-special">(</span><a href="../base-4.10.0.0/src/%{MODULE/./-}.html#%{NAME}/GHC.IO.html#FilePath"><span class="hs-identifier hs-type">FilePath</span></a><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="hs-identifier hs-type">IO</span><span> </span><span class="hs-identifier hs-type">Bool</span><span class="hs-special">)</span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="hs-special">[</span><a href="../base-4.10.0.0/src/%{MODULE/./-}.html#%{NAME}/GHC.IO.html#FilePath"><span class="hs-identifier hs-type">FilePath</span></a><span class="hs-special">]</span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><a href="../base-4.10.0.0/src/%{MODULE/./-}.html#%{NAME}/GHC.Base.html#String"><span class="hs-identifier hs-type">String</span></a><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="hs-identifier hs-type">IO</span><span> </span><span class="hs-special">(</span><a href="../base-4.10.0.0/src/%{MODULE/./-}.html#%{NAME}/GHC.Base.html#Maybe"><span class="hs-identifier hs-type">Maybe</span></a><span> </span><a href="../base-4.10.0.0/src/%{MODULE/./-}.html#%{NAME}/GHC.IO.html#FilePath"><span class="hs-identifier hs-type">FilePath</span></a><span class="hs-special">)</span><span>
</span><a name="line-1206"></a><a name="findFileWith"><a href="System.Directory.html#findFileWith"><span class="hs-identifier">findFileWith</span></a></a><span> </span><a name="local-6989586621679042614"><a href="#local-6989586621679042614"><span class="hs-identifier">f</span></a></a><span> </span><a name="local-6989586621679042615"><a href="#local-6989586621679042615"><span class="hs-identifier">ds</span></a></a><span> </span><a name="local-6989586621679042616"><a href="#local-6989586621679042616"><span class="hs-identifier">name</span></a></a><span> </span><span class="hs-glyph">=</span><span> </span><a href="System.Directory.html#asumMaybeT"><span class="hs-identifier hs-var">asumMaybeT</span></a><span> </span><span class="hs-special">(</span><a href="../base-4.10.0.0/src/%{MODULE/./-}.html#%{NAME}/GHC.Base.html#map"><span class="hs-identifier hs-var">map</span></a><span> </span><span class="hs-special">(</span><a href="System.Directory.html#findFileWithIn"><span class="hs-identifier hs-var">findFileWithIn</span></a><span> </span><a href="#local-6989586621679042614"><span class="hs-identifier hs-var">f</span></a><span> </span><a href="#local-6989586621679042616"><span class="hs-identifier hs-var">name</span></a><span class="hs-special">)</span><span> </span><a href="#local-6989586621679042615"><span class="hs-identifier hs-var">ds</span></a><span class="hs-special">)</span><span>
</span><a name="line-1207"></a><span>
</span><a name="line-1208"></a><span class="hs-comment">-- | 'Data.Foldable.asum' for 'Control.Monad.Trans.Maybe.MaybeT', essentially.</span><span>
</span><a name="line-1209"></a><span class="hs-comment">--</span><span>
</span><a name="line-1210"></a><span class="hs-comment">-- Returns the first 'Just' in the list or 'Nothing' if there aren't any.</span><span>
</span><a name="line-1211"></a><span class="hs-identifier">asumMaybeT</span><span> </span><span class="hs-glyph">::</span><span> </span><a href="../base-4.10.0.0/src/%{MODULE/./-}.html#%{NAME}/GHC.Base.html#Monad"><span class="hs-identifier hs-type">Monad</span></a><span> </span><a href="#local-6989586621679040784"><span class="hs-identifier hs-type">m</span></a><span> </span><span class="hs-glyph">=&gt;</span><span> </span><span class="hs-special">[</span><a href="#local-6989586621679040784"><span class="hs-identifier hs-type">m</span></a><span> </span><span class="hs-special">(</span><a href="../base-4.10.0.0/src/%{MODULE/./-}.html#%{NAME}/GHC.Base.html#Maybe"><span class="hs-identifier hs-type">Maybe</span></a><span> </span><a href="#local-6989586621679040785"><span class="hs-identifier hs-type">a</span></a><span class="hs-special">)</span><span class="hs-special">]</span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><a href="#local-6989586621679040784"><span class="hs-identifier hs-type">m</span></a><span> </span><span class="hs-special">(</span><a href="../base-4.10.0.0/src/%{MODULE/./-}.html#%{NAME}/GHC.Base.html#Maybe"><span class="hs-identifier hs-type">Maybe</span></a><span> </span><a href="#local-6989586621679040785"><span class="hs-identifier hs-type">a</span></a><span class="hs-special">)</span><span>
</span><a name="line-1212"></a><a name="asumMaybeT"><a href="System.Directory.html#asumMaybeT"><span class="hs-identifier">asumMaybeT</span></a></a><span> </span><span class="hs-glyph">=</span><span> </span><a href="../base-4.10.0.0/src/%{MODULE/./-}.html#%{NAME}/Data.Foldable.html#foldr"><span class="hs-identifier hs-var">foldr</span></a><span> </span><a href="#local-6989586621679042617"><span class="hs-identifier hs-var">attempt</span></a><span> </span><span class="hs-special">(</span><a href="../base-4.10.0.0/src/%{MODULE/./-}.html#%{NAME}/GHC.Base.html#return"><span class="hs-identifier hs-var">return</span></a><span> </span><a href="../base-4.10.0.0/src/%{MODULE/./-}.html#%{NAME}/GHC.Base.html#Nothing"><span class="hs-identifier hs-var">Nothing</span></a><span class="hs-special">)</span><span>
</span><a name="line-1213"></a><span>  </span><span class="hs-keyword">where</span><span>
</span><a name="line-1214"></a><span>    </span><a name="local-6989586621679042617"><a href="#local-6989586621679042617"><span class="hs-identifier">attempt</span></a></a><span> </span><a name="local-6989586621679042618"><a href="#local-6989586621679042618"><span class="hs-identifier">mmx</span></a></a><span> </span><a name="local-6989586621679042619"><a href="#local-6989586621679042619"><span class="hs-identifier">mx'</span></a></a><span> </span><span class="hs-glyph">=</span><span> </span><span class="hs-keyword">do</span><span>
</span><a name="line-1215"></a><span>        </span><a name="local-6989586621679042620"><a href="#local-6989586621679042620"><span class="hs-identifier">mx</span></a></a><span> </span><span class="hs-glyph">&lt;-</span><span> </span><a href="#local-6989586621679042618"><span class="hs-identifier hs-var">mmx</span></a><span>
</span><a name="line-1216"></a><span>        </span><span class="hs-keyword">case</span><span> </span><a href="#local-6989586621679042620"><span class="hs-identifier hs-var">mx</span></a><span> </span><span class="hs-keyword">of</span><span>
</span><a name="line-1217"></a><span>            </span><a href="../base-4.10.0.0/src/%{MODULE/./-}.html#%{NAME}/GHC.Base.html#Nothing"><span class="hs-identifier hs-var">Nothing</span></a><span> </span><span class="hs-glyph">-&gt;</span><span> </span><a href="#local-6989586621679042619"><span class="hs-identifier hs-var">mx'</span></a><span>
</span><a name="line-1218"></a><span>            </span><a href="../base-4.10.0.0/src/%{MODULE/./-}.html#%{NAME}/GHC.Base.html#Just"><span class="hs-identifier hs-var">Just</span></a><span> </span><span class="hs-identifier">_</span><span>  </span><span class="hs-glyph">-&gt;</span><span> </span><a href="../base-4.10.0.0/src/%{MODULE/./-}.html#%{NAME}/GHC.Base.html#return"><span class="hs-identifier hs-var">return</span></a><span> </span><a href="#local-6989586621679042620"><span class="hs-identifier hs-var">mx</span></a><span>
</span><a name="line-1219"></a><span>
</span><a name="line-1220"></a><span class="hs-comment">-- | Search through the given set of directories for the given file and</span><span>
</span><a name="line-1221"></a><span class="hs-comment">-- with the given property (usually permissions) and returns a list of</span><span>
</span><a name="line-1222"></a><span class="hs-comment">-- paths where the given file exists and has the property.</span><span>
</span><a name="line-1223"></a><span class="hs-comment">--</span><span>
</span><a name="line-1224"></a><span class="hs-comment">-- @since 1.2.1.0</span><span>
</span><a name="line-1225"></a><span class="hs-identifier">findFilesWith</span><span> </span><span class="hs-glyph">::</span><span> </span><span class="hs-special">(</span><a href="../base-4.10.0.0/src/%{MODULE/./-}.html#%{NAME}/GHC.IO.html#FilePath"><span class="hs-identifier hs-type">FilePath</span></a><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="hs-identifier hs-type">IO</span><span> </span><span class="hs-identifier hs-type">Bool</span><span class="hs-special">)</span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="hs-special">[</span><a href="../base-4.10.0.0/src/%{MODULE/./-}.html#%{NAME}/GHC.IO.html#FilePath"><span class="hs-identifier hs-type">FilePath</span></a><span class="hs-special">]</span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><a href="../base-4.10.0.0/src/%{MODULE/./-}.html#%{NAME}/GHC.Base.html#String"><span class="hs-identifier hs-type">String</span></a><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="hs-identifier hs-type">IO</span><span> </span><span class="hs-special">[</span><a href="../base-4.10.0.0/src/%{MODULE/./-}.html#%{NAME}/GHC.IO.html#FilePath"><span class="hs-identifier hs-type">FilePath</span></a><span class="hs-special">]</span><span>
</span><a name="line-1226"></a><a name="findFilesWith"><a href="System.Directory.html#findFilesWith"><span class="hs-identifier">findFilesWith</span></a></a><span> </span><a name="local-6989586621679042621"><a href="#local-6989586621679042621"><span class="hs-identifier">f</span></a></a><span> </span><a name="local-6989586621679042622"><a href="#local-6989586621679042622"><span class="hs-identifier">ds</span></a></a><span> </span><a name="local-6989586621679042623"><a href="#local-6989586621679042623"><span class="hs-identifier">name</span></a></a><span> </span><span class="hs-glyph">=</span><span> </span><span class="hs-keyword">do</span><span>
</span><a name="line-1227"></a><span>    </span><a name="local-6989586621679042624"><a href="#local-6989586621679042624"><span class="hs-identifier">mfiles</span></a></a><span> </span><span class="hs-glyph">&lt;-</span><span> </span><a href="../base-4.10.0.0/src/%{MODULE/./-}.html#%{NAME}/Data.Traversable.html#mapM"><span class="hs-identifier hs-var">mapM</span></a><span> </span><span class="hs-special">(</span><a href="System.Directory.html#findFileWithIn"><span class="hs-identifier hs-var">findFileWithIn</span></a><span> </span><a href="#local-6989586621679042621"><span class="hs-identifier hs-var">f</span></a><span> </span><a href="#local-6989586621679042623"><span class="hs-identifier hs-var">name</span></a><span class="hs-special">)</span><span> </span><a href="#local-6989586621679042622"><span class="hs-identifier hs-var">ds</span></a><span>
</span><a name="line-1228"></a><span>    </span><a href="../base-4.10.0.0/src/%{MODULE/./-}.html#%{NAME}/GHC.Base.html#return"><span class="hs-identifier hs-var">return</span></a><span> </span><span class="hs-special">(</span><a href="../base-4.10.0.0/src/%{MODULE/./-}.html#%{NAME}/Data.Maybe.html#catMaybes"><span class="hs-identifier hs-var">catMaybes</span></a><span> </span><a href="#local-6989586621679042624"><span class="hs-identifier hs-var">mfiles</span></a><span class="hs-special">)</span><span>
</span><a name="line-1229"></a><span>
</span><a name="line-1230"></a><span class="hs-comment">-- | Like 'findFileWith', but searches only a single directory.</span><span>
</span><a name="line-1231"></a><span class="hs-identifier">findFileWithIn</span><span> </span><span class="hs-glyph">::</span><span> </span><span class="hs-special">(</span><a href="../base-4.10.0.0/src/%{MODULE/./-}.html#%{NAME}/GHC.IO.html#FilePath"><span class="hs-identifier hs-type">FilePath</span></a><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="hs-identifier hs-type">IO</span><span> </span><span class="hs-identifier hs-type">Bool</span><span class="hs-special">)</span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><a href="../base-4.10.0.0/src/%{MODULE/./-}.html#%{NAME}/GHC.Base.html#String"><span class="hs-identifier hs-type">String</span></a><span> </span><span class="hs-glyph">-&gt;</span><span> </span><a href="../base-4.10.0.0/src/%{MODULE/./-}.html#%{NAME}/GHC.IO.html#FilePath"><span class="hs-identifier hs-type">FilePath</span></a><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="hs-identifier hs-type">IO</span><span> </span><span class="hs-special">(</span><a href="../base-4.10.0.0/src/%{MODULE/./-}.html#%{NAME}/GHC.Base.html#Maybe"><span class="hs-identifier hs-type">Maybe</span></a><span> </span><a href="../base-4.10.0.0/src/%{MODULE/./-}.html#%{NAME}/GHC.IO.html#FilePath"><span class="hs-identifier hs-type">FilePath</span></a><span class="hs-special">)</span><span>
</span><a name="line-1232"></a><a name="findFileWithIn"><a href="System.Directory.html#findFileWithIn"><span class="hs-identifier">findFileWithIn</span></a></a><span> </span><a name="local-6989586621679042625"><a href="#local-6989586621679042625"><span class="hs-identifier">f</span></a></a><span> </span><a name="local-6989586621679042626"><a href="#local-6989586621679042626"><span class="hs-identifier">name</span></a></a><span> </span><a name="local-6989586621679042627"><a href="#local-6989586621679042627"><span class="hs-identifier">d</span></a></a><span> </span><span class="hs-glyph">=</span><span> </span><span class="hs-keyword">do</span><span>
</span><a name="line-1233"></a><span>    </span><span class="hs-keyword">let</span><span> </span><a name="local-6989586621679042628"><a href="#local-6989586621679042628"><span class="hs-identifier">path</span></a></a><span> </span><span class="hs-glyph">=</span><span> </span><a href="#local-6989586621679042627"><span class="hs-identifier hs-var">d</span></a><span> </span><a href="../filepath-1.4.1.1/src/%{MODULE/./-}.html#%{NAME}/System.FilePath.Posix.html#%3C%2F%3E"><span class="hs-operator hs-var">&lt;/&gt;</span></a><span> </span><a href="#local-6989586621679042626"><span class="hs-identifier hs-var">name</span></a><span>
</span><a name="line-1234"></a><span>    </span><a name="local-6989586621679042629"><a href="#local-6989586621679042629"><span class="hs-identifier">exist</span></a></a><span> </span><span class="hs-glyph">&lt;-</span><span> </span><a href="System.Directory.html#doesFileExist"><span class="hs-identifier hs-var">doesFileExist</span></a><span> </span><a href="#local-6989586621679042628"><span class="hs-identifier hs-var">path</span></a><span>
</span><a name="line-1235"></a><span>    </span><span class="hs-keyword">if</span><span> </span><a href="#local-6989586621679042629"><span class="hs-identifier hs-var">exist</span></a><span>
</span><a name="line-1236"></a><span>        </span><span class="hs-keyword">then</span><span> </span><span class="hs-keyword">do</span><span>
</span><a name="line-1237"></a><span>            </span><a name="local-6989586621679042630"><a href="#local-6989586621679042630"><span class="hs-identifier">ok</span></a></a><span> </span><span class="hs-glyph">&lt;-</span><span> </span><a href="#local-6989586621679042625"><span class="hs-identifier hs-var">f</span></a><span> </span><a href="#local-6989586621679042628"><span class="hs-identifier hs-var">path</span></a><span>
</span><a name="line-1238"></a><span>            </span><span class="hs-keyword">if</span><span> </span><a href="#local-6989586621679042630"><span class="hs-identifier hs-var">ok</span></a><span>
</span><a name="line-1239"></a><span>                </span><span class="hs-keyword">then</span><span> </span><a href="../base-4.10.0.0/src/%{MODULE/./-}.html#%{NAME}/GHC.Base.html#return"><span class="hs-identifier hs-var">return</span></a><span> </span><span class="hs-special">(</span><a href="../base-4.10.0.0/src/%{MODULE/./-}.html#%{NAME}/GHC.Base.html#Just"><span class="hs-identifier hs-var">Just</span></a><span> </span><a href="#local-6989586621679042628"><span class="hs-identifier hs-var">path</span></a><span class="hs-special">)</span><span>
</span><a name="line-1240"></a><span>                </span><span class="hs-keyword">else</span><span> </span><a href="../base-4.10.0.0/src/%{MODULE/./-}.html#%{NAME}/GHC.Base.html#return"><span class="hs-identifier hs-var">return</span></a><span> </span><a href="../base-4.10.0.0/src/%{MODULE/./-}.html#%{NAME}/GHC.Base.html#Nothing"><span class="hs-identifier hs-var">Nothing</span></a><span>
</span><a name="line-1241"></a><span>        </span><span class="hs-keyword">else</span><span> </span><a href="../base-4.10.0.0/src/%{MODULE/./-}.html#%{NAME}/GHC.Base.html#return"><span class="hs-identifier hs-var">return</span></a><span> </span><a href="../base-4.10.0.0/src/%{MODULE/./-}.html#%{NAME}/GHC.Base.html#Nothing"><span class="hs-identifier hs-var">Nothing</span></a><span>
</span><a name="line-1242"></a><span>
</span><a name="line-1243"></a><span class="hs-comment">-- | Similar to 'listDirectory', but always includes the special entries (@.@</span><span>
</span><a name="line-1244"></a><span class="hs-comment">-- and @..@).  (This applies to Windows as well.)</span><span>
</span><a name="line-1245"></a><span class="hs-comment">--</span><span>
</span><a name="line-1246"></a><span class="hs-comment">-- The operation may fail with the same exceptions as 'listDirectory'.</span><span>
</span><a name="line-1247"></a><span class="hs-identifier">getDirectoryContents</span><span> </span><span class="hs-glyph">::</span><span> </span><a href="../base-4.10.0.0/src/%{MODULE/./-}.html#%{NAME}/GHC.IO.html#FilePath"><span class="hs-identifier hs-type">FilePath</span></a><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="hs-identifier hs-type">IO</span><span> </span><span class="hs-special">[</span><a href="../base-4.10.0.0/src/%{MODULE/./-}.html#%{NAME}/GHC.IO.html#FilePath"><span class="hs-identifier hs-type">FilePath</span></a><span class="hs-special">]</span><span>
</span><a name="line-1248"></a><a name="getDirectoryContents"><a href="System.Directory.html#getDirectoryContents"><span class="hs-identifier">getDirectoryContents</span></a></a><span> </span><a name="local-6989586621679042631"><a href="#local-6989586621679042631"><span class="hs-identifier">path</span></a></a><span> </span><span class="hs-glyph">=</span><span>
</span><a name="line-1249"></a><span>  </span><a href="../base-4.10.0.0/src/%{MODULE/./-}.html#%{NAME}/System.IO.Error.html#modifyIOError"><span class="hs-identifier hs-var">modifyIOError</span></a><span> </span><span class="hs-special">(</span><span class="hs-special">(</span><span class="hs-special">`</span><a href="../base-4.10.0.0/src/%{MODULE/./-}.html#%{NAME}/System.IO.Error.html#ioeSetFileName"><span class="hs-identifier hs-var">ioeSetFileName</span></a><span class="hs-special">`</span><span> </span><a href="#local-6989586621679042631"><span class="hs-identifier hs-var">path</span></a><span class="hs-special">)</span><span> </span><a href="../base-4.10.0.0/src/%{MODULE/./-}.html#%{NAME}/GHC.Base.html#."><span class="hs-operator hs-var">.</span></a><span>
</span><a name="line-1250"></a><span>                 </span><span class="hs-special">(</span><span class="hs-special">`</span><a href="System.Directory.html#ioeAddLocation"><span class="hs-identifier hs-var">ioeAddLocation</span></a><span class="hs-special">`</span><span> </span><span class="hs-string">&quot;getDirectoryContents&quot;</span><span class="hs-special">)</span><span class="hs-special">)</span><span> </span><a href="../base-4.10.0.0/src/%{MODULE/./-}.html#%{NAME}/GHC.Base.html#%24"><span class="hs-operator hs-var">$</span></a><span> </span><span class="hs-keyword">do</span><span>
</span><a name="line-1251"></a><span class="hs-cpp">#ifndef mingw32_HOST_OS</span><span>
</span><a name="line-1252"></a><span>    </span><a href="../base-4.10.0.0/src/%{MODULE/./-}.html#%{NAME}/Control.Exception.Base.html#bracket"><span class="hs-identifier hs-var">bracket</span></a><span>
</span><a name="line-1253"></a><span>      </span><span class="hs-special">(</span><a href="../unix-2.7.2.1/src/%{MODULE/./-}.html#%{NAME}/System.Posix.Directory.html#openDirStream"><span class="hs-identifier hs-var">Posix</span><span class="hs-operator hs-var">.</span><span class="hs-identifier hs-var">openDirStream</span></a><span> </span><a href="#local-6989586621679042631"><span class="hs-identifier hs-var">path</span></a><span class="hs-special">)</span><span>
</span><a name="line-1254"></a><span>      </span><a href="../unix-2.7.2.1/src/%{MODULE/./-}.html#%{NAME}/System.Posix.Directory.Common.html#closeDirStream"><span class="hs-identifier hs-var">Posix</span><span class="hs-operator hs-var">.</span><span class="hs-identifier hs-var">closeDirStream</span></a><span>
</span><a name="line-1255"></a><span>      </span><a href="#local-6989586621679042632"><span class="hs-identifier hs-var">start</span></a><span>
</span><a name="line-1256"></a><span> </span><span class="hs-keyword">where</span><span>
</span><a name="line-1257"></a><span>  </span><a name="local-6989586621679042632"><a href="#local-6989586621679042632"><span class="hs-identifier">start</span></a></a><span> </span><a name="local-6989586621679042633"><a href="#local-6989586621679042633"><span class="hs-identifier">dirp</span></a></a><span> </span><span class="hs-glyph">=</span><span>
</span><a name="line-1258"></a><span>      </span><a href="#local-6989586621679042634"><span class="hs-identifier hs-var">loop</span></a><span> </span><a href="../base-4.10.0.0/src/%{MODULE/./-}.html#%{NAME}/GHC.Base.html#id"><span class="hs-identifier hs-var">id</span></a><span>
</span><a name="line-1259"></a><span>    </span><span class="hs-keyword">where</span><span>
</span><a name="line-1260"></a><span>      </span><a name="local-6989586621679042634"><a href="#local-6989586621679042634"><span class="hs-identifier">loop</span></a></a><span> </span><a name="local-6989586621679042635"><a href="#local-6989586621679042635"><span class="hs-identifier">acc</span></a></a><span> </span><span class="hs-glyph">=</span><span> </span><span class="hs-keyword">do</span><span>
</span><a name="line-1261"></a><span>        </span><a name="local-6989586621679042636"><a href="#local-6989586621679042636"><span class="hs-identifier">e</span></a></a><span> </span><span class="hs-glyph">&lt;-</span><span> </span><a href="../unix-2.7.2.1/src/%{MODULE/./-}.html#%{NAME}/System.Posix.Directory.html#readDirStream"><span class="hs-identifier hs-var">Posix</span><span class="hs-operator hs-var">.</span><span class="hs-identifier hs-var">readDirStream</span></a><span> </span><a href="#local-6989586621679042633"><span class="hs-identifier hs-var">dirp</span></a><span>
</span><a name="line-1262"></a><span>        </span><span class="hs-keyword">if</span><span> </span><a href="../base-4.10.0.0/src/%{MODULE/./-}.html#%{NAME}/Data.Foldable.html#null"><span class="hs-identifier hs-var">null</span></a><span> </span><a href="#local-6989586621679042636"><span class="hs-identifier hs-var">e</span></a><span>
</span><a name="line-1263"></a><span>          </span><span class="hs-keyword">then</span><span> </span><a href="../base-4.10.0.0/src/%{MODULE/./-}.html#%{NAME}/GHC.Base.html#return"><span class="hs-identifier hs-var">return</span></a><span> </span><span class="hs-special">(</span><a href="#local-6989586621679042635"><span class="hs-identifier hs-var">acc</span></a><span> </span><span class="hs-special">[</span><span class="hs-special">]</span><span class="hs-special">)</span><span>
</span><a name="line-1264"></a><span>          </span><span class="hs-keyword">else</span><span> </span><a href="#local-6989586621679042634"><span class="hs-identifier hs-var">loop</span></a><span> </span><span class="hs-special">(</span><a href="#local-6989586621679042635"><span class="hs-identifier hs-var">acc</span></a><span> </span><a href="../base-4.10.0.0/src/%{MODULE/./-}.html#%{NAME}/GHC.Base.html#."><span class="hs-operator hs-var">.</span></a><span> </span><span class="hs-special">(</span><a href="#local-6989586621679042636"><span class="hs-identifier hs-var">e</span></a><span class="hs-glyph">:</span><span class="hs-special">)</span><span class="hs-special">)</span><span>
</span><a name="line-1265"></a><span class="hs-cpp">#else</span><span>
</span><a name="line-1266"></a><span>  </span><span class="hs-identifier">bracket</span><span>
</span><a name="line-1267"></a><span>     </span><span class="hs-special">(</span><span class="hs-identifier">Win32</span><span class="hs-operator">.</span><span class="hs-identifier">findFirstFile</span><span> </span><span class="hs-special">(</span><span class="hs-identifier">path</span><span> </span><span class="hs-operator">&lt;/&gt;</span><span> </span><span class="hs-string">&quot;*&quot;</span><span class="hs-special">)</span><span class="hs-special">)</span><span>
</span><a name="line-1268"></a><span>     </span><span class="hs-special">(</span><span class="hs-glyph">\</span><span class="hs-special">(</span><span class="hs-identifier">h</span><span class="hs-special">,</span><span class="hs-identifier">_</span><span class="hs-special">)</span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="hs-identifier">Win32</span><span class="hs-operator">.</span><span class="hs-identifier">findClose</span><span> </span><span class="hs-identifier">h</span><span class="hs-special">)</span><span>
</span><a name="line-1269"></a><span>     </span><span class="hs-special">(</span><span class="hs-glyph">\</span><span class="hs-special">(</span><span class="hs-identifier">h</span><span class="hs-special">,</span><span class="hs-identifier">fdat</span><span class="hs-special">)</span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="hs-identifier">loop</span><span> </span><span class="hs-identifier">h</span><span> </span><span class="hs-identifier">fdat</span><span> </span><span class="hs-special">[</span><span class="hs-special">]</span><span class="hs-special">)</span><span>
</span><a name="line-1270"></a><span>  </span><span class="hs-keyword">where</span><span>
</span><a name="line-1271"></a><span>        </span><span class="hs-comment">-- we needn't worry about empty directories: adirectory always</span><span>
</span><a name="line-1272"></a><span>        </span><span class="hs-comment">-- has at least &quot;.&quot; and &quot;..&quot; entries</span><span>
</span><a name="line-1273"></a><span>    </span><span class="hs-identifier">loop</span><span> </span><span class="hs-glyph">::</span><span> </span><span class="hs-identifier">Win32</span><span class="hs-operator">.</span><span class="hs-identifier">HANDLE</span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="hs-identifier">Win32</span><span class="hs-operator">.</span><span class="hs-identifier">FindData</span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="hs-special">[</span><span class="hs-identifier">FilePath</span><span class="hs-special">]</span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="hs-identifier">IO</span><span> </span><span class="hs-special">[</span><span class="hs-identifier">FilePath</span><span class="hs-special">]</span><span>
</span><a name="line-1274"></a><span>    </span><span class="hs-identifier">loop</span><span> </span><span class="hs-identifier">h</span><span> </span><span class="hs-identifier">fdat</span><span> </span><span class="hs-identifier">acc</span><span> </span><span class="hs-glyph">=</span><span> </span><span class="hs-keyword">do</span><span>
</span><a name="line-1275"></a><span>       </span><span class="hs-identifier">filename</span><span> </span><span class="hs-glyph">&lt;-</span><span> </span><span class="hs-identifier">Win32</span><span class="hs-operator">.</span><span class="hs-identifier">getFindDataFileName</span><span> </span><span class="hs-identifier">fdat</span><span>
</span><a name="line-1276"></a><span>       </span><span class="hs-identifier">more</span><span> </span><span class="hs-glyph">&lt;-</span><span> </span><span class="hs-identifier">Win32</span><span class="hs-operator">.</span><span class="hs-identifier">findNextFile</span><span> </span><span class="hs-identifier">h</span><span> </span><span class="hs-identifier">fdat</span><span>
</span><a name="line-1277"></a><span>       </span><span class="hs-keyword">if</span><span> </span><span class="hs-identifier">more</span><span>
</span><a name="line-1278"></a><span>          </span><span class="hs-keyword">then</span><span> </span><span class="hs-identifier">loop</span><span> </span><span class="hs-identifier">h</span><span> </span><span class="hs-identifier">fdat</span><span> </span><span class="hs-special">(</span><span class="hs-identifier">filename</span><span class="hs-glyph">:</span><span class="hs-identifier">acc</span><span class="hs-special">)</span><span>
</span><a name="line-1279"></a><span>          </span><span class="hs-keyword">else</span><span> </span><span class="hs-identifier">return</span><span> </span><span class="hs-special">(</span><span class="hs-identifier">filename</span><span class="hs-glyph">:</span><span class="hs-identifier">acc</span><span class="hs-special">)</span><span>
</span><a name="line-1280"></a><span>                 </span><span class="hs-comment">-- no need to reverse, ordering is undefined</span><span>
</span><a name="line-1281"></a><span class="hs-cpp">#endif /* mingw32 */</span><span>
</span><a name="line-1282"></a><span>
</span><a name="line-1283"></a><span class="hs-comment">-- | @'listDirectory' dir@ returns a list of /all/ entries in /dir/ without</span><span>
</span><a name="line-1284"></a><span class="hs-comment">-- the special entries (@.@ and @..@).</span><span>
</span><a name="line-1285"></a><span class="hs-comment">--</span><span>
</span><a name="line-1286"></a><span class="hs-comment">-- The operation may fail with:</span><span>
</span><a name="line-1287"></a><span class="hs-comment">--</span><span>
</span><a name="line-1288"></a><span class="hs-comment">-- * 'HardwareFault'</span><span>
</span><a name="line-1289"></a><span class="hs-comment">--   A physical I\/O error has occurred.</span><span>
</span><a name="line-1290"></a><span class="hs-comment">--   @[EIO]@</span><span>
</span><a name="line-1291"></a><span class="hs-comment">--</span><span>
</span><a name="line-1292"></a><span class="hs-comment">-- * 'InvalidArgument'</span><span>
</span><a name="line-1293"></a><span class="hs-comment">--   The operand is not a valid directory name.</span><span>
</span><a name="line-1294"></a><span class="hs-comment">--   @[ENAMETOOLONG, ELOOP]@</span><span>
</span><a name="line-1295"></a><span class="hs-comment">--</span><span>
</span><a name="line-1296"></a><span class="hs-comment">-- * 'isDoesNotExistError' \/ 'NoSuchThing'</span><span>
</span><a name="line-1297"></a><span class="hs-comment">--   The directory does not exist.</span><span>
</span><a name="line-1298"></a><span class="hs-comment">--   @[ENOENT, ENOTDIR]@</span><span>
</span><a name="line-1299"></a><span class="hs-comment">--</span><span>
</span><a name="line-1300"></a><span class="hs-comment">-- * 'isPermissionError' \/ 'PermissionDenied'</span><span>
</span><a name="line-1301"></a><span class="hs-comment">--   The process has insufficient privileges to perform the operation.</span><span>
</span><a name="line-1302"></a><span class="hs-comment">--   @[EACCES]@</span><span>
</span><a name="line-1303"></a><span class="hs-comment">--</span><span>
</span><a name="line-1304"></a><span class="hs-comment">-- * 'ResourceExhausted'</span><span>
</span><a name="line-1305"></a><span class="hs-comment">--   Insufficient resources are available to perform the operation.</span><span>
</span><a name="line-1306"></a><span class="hs-comment">--   @[EMFILE, ENFILE]@</span><span>
</span><a name="line-1307"></a><span class="hs-comment">--</span><span>
</span><a name="line-1308"></a><span class="hs-comment">-- * 'InappropriateType'</span><span>
</span><a name="line-1309"></a><span class="hs-comment">--   The path refers to an existing non-directory object.</span><span>
</span><a name="line-1310"></a><span class="hs-comment">--   @[ENOTDIR]@</span><span>
</span><a name="line-1311"></a><span class="hs-comment">--</span><span>
</span><a name="line-1312"></a><span class="hs-comment">-- @since 1.2.5.0</span><span>
</span><a name="line-1313"></a><span class="hs-comment">--</span><span>
</span><a name="line-1314"></a><span class="hs-identifier">listDirectory</span><span> </span><span class="hs-glyph">::</span><span> </span><a href="../base-4.10.0.0/src/%{MODULE/./-}.html#%{NAME}/GHC.IO.html#FilePath"><span class="hs-identifier hs-type">FilePath</span></a><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="hs-identifier hs-type">IO</span><span> </span><span class="hs-special">[</span><a href="../base-4.10.0.0/src/%{MODULE/./-}.html#%{NAME}/GHC.IO.html#FilePath"><span class="hs-identifier hs-type">FilePath</span></a><span class="hs-special">]</span><span>
</span><a name="line-1315"></a><a name="listDirectory"><a href="System.Directory.html#listDirectory"><span class="hs-identifier">listDirectory</span></a></a><span> </span><a name="local-6989586621679042722"><a href="#local-6989586621679042722"><span class="hs-identifier">path</span></a></a><span> </span><span class="hs-glyph">=</span><span>
</span><a name="line-1316"></a><span>  </span><span class="hs-special">(</span><a href="../base-4.10.0.0/src/%{MODULE/./-}.html#%{NAME}/GHC.List.html#filter"><span class="hs-identifier hs-var">filter</span></a><span> </span><a href="#local-6989586621679042723"><span class="hs-identifier hs-var">f</span></a><span class="hs-special">)</span><span> </span><a href="../base-4.10.0.0/src/%{MODULE/./-}.html#%{NAME}/Data.Functor.html#%3C%24%3E"><span class="hs-operator hs-var">&lt;$&gt;</span></a><span> </span><span class="hs-special">(</span><a href="System.Directory.html#getDirectoryContents"><span class="hs-identifier hs-var">getDirectoryContents</span></a><span> </span><a href="#local-6989586621679042722"><span class="hs-identifier hs-var">path</span></a><span class="hs-special">)</span><span>
</span><a name="line-1317"></a><span>  </span><span class="hs-keyword">where</span><span> </span><a name="local-6989586621679042723"><a href="#local-6989586621679042723"><span class="hs-identifier">f</span></a></a><span> </span><a name="local-6989586621679042724"><a href="#local-6989586621679042724"><span class="hs-identifier">filename</span></a></a><span> </span><span class="hs-glyph">=</span><span> </span><a href="#local-6989586621679042724"><span class="hs-identifier hs-var">filename</span></a><span> </span><span class="hs-operator hs-var">/=</span><span> </span><span class="hs-string">&quot;.&quot;</span><span> </span><span class="hs-operator hs-var">&amp;&amp;</span><span> </span><a href="#local-6989586621679042724"><span class="hs-identifier hs-var">filename</span></a><span> </span><span class="hs-operator hs-var">/=</span><span> </span><span class="hs-string">&quot;..&quot;</span><span>
</span><a name="line-1318"></a><span>
</span><a name="line-1319"></a><span class="hs-comment">-- | Obtain the current working directory as an absolute path.</span><span>
</span><a name="line-1320"></a><span class="hs-comment">--</span><span>
</span><a name="line-1321"></a><span class="hs-comment">-- In a multithreaded program, the current working directory is a global state</span><span>
</span><a name="line-1322"></a><span class="hs-comment">-- shared among all threads of the process.  Therefore, when performing</span><span>
</span><a name="line-1323"></a><span class="hs-comment">-- filesystem operations from multiple threads, it is highly recommended to</span><span>
</span><a name="line-1324"></a><span class="hs-comment">-- use absolute rather than relative paths (see: 'makeAbsolute').</span><span>
</span><a name="line-1325"></a><span class="hs-comment">--</span><span>
</span><a name="line-1326"></a><span class="hs-comment">-- The operation may fail with:</span><span>
</span><a name="line-1327"></a><span class="hs-comment">--</span><span>
</span><a name="line-1328"></a><span class="hs-comment">-- * 'HardwareFault'</span><span>
</span><a name="line-1329"></a><span class="hs-comment">-- A physical I\/O error has occurred.</span><span>
</span><a name="line-1330"></a><span class="hs-comment">-- @[EIO]@</span><span>
</span><a name="line-1331"></a><span class="hs-comment">--</span><span>
</span><a name="line-1332"></a><span class="hs-comment">-- * 'isDoesNotExistError' or 'NoSuchThing'</span><span>
</span><a name="line-1333"></a><span class="hs-comment">-- There is no path referring to the working directory.</span><span>
</span><a name="line-1334"></a><span class="hs-comment">-- @[EPERM, ENOENT, ESTALE...]@</span><span>
</span><a name="line-1335"></a><span class="hs-comment">--</span><span>
</span><a name="line-1336"></a><span class="hs-comment">-- * 'isPermissionError' or 'PermissionDenied'</span><span>
</span><a name="line-1337"></a><span class="hs-comment">-- The process has insufficient privileges to perform the operation.</span><span>
</span><a name="line-1338"></a><span class="hs-comment">-- @[EACCES]@</span><span>
</span><a name="line-1339"></a><span class="hs-comment">--</span><span>
</span><a name="line-1340"></a><span class="hs-comment">-- * 'ResourceExhausted'</span><span>
</span><a name="line-1341"></a><span class="hs-comment">-- Insufficient resources are available to perform the operation.</span><span>
</span><a name="line-1342"></a><span class="hs-comment">--</span><span>
</span><a name="line-1343"></a><span class="hs-comment">-- * 'UnsupportedOperation'</span><span>
</span><a name="line-1344"></a><span class="hs-comment">-- The operating system has no notion of current working directory.</span><span>
</span><a name="line-1345"></a><span class="hs-comment">--</span><span>
</span><a name="line-1346"></a><span class="hs-identifier">getCurrentDirectory</span><span> </span><span class="hs-glyph">::</span><span> </span><span class="hs-identifier hs-type">IO</span><span> </span><a href="../base-4.10.0.0/src/%{MODULE/./-}.html#%{NAME}/GHC.IO.html#FilePath"><span class="hs-identifier hs-type">FilePath</span></a><span>
</span><a name="line-1347"></a><a name="getCurrentDirectory"><a href="System.Directory.html#getCurrentDirectory"><span class="hs-identifier">getCurrentDirectory</span></a></a><span> </span><span class="hs-glyph">=</span><span>
</span><a name="line-1348"></a><span>  </span><a href="../base-4.10.0.0/src/%{MODULE/./-}.html#%{NAME}/System.IO.Error.html#modifyIOError"><span class="hs-identifier hs-var">modifyIOError</span></a><span> </span><span class="hs-special">(</span><span class="hs-special">`</span><a href="System.Directory.html#ioeAddLocation"><span class="hs-identifier hs-var">ioeAddLocation</span></a><span class="hs-special">`</span><span> </span><span class="hs-string">&quot;getCurrentDirectory&quot;</span><span class="hs-special">)</span><span> </span><a href="../base-4.10.0.0/src/%{MODULE/./-}.html#%{NAME}/GHC.Base.html#%24"><span class="hs-operator hs-var">$</span></a><span>
</span><a name="line-1349"></a><span>  </span><a href="System.Directory.html#specializeErrorString"><span class="hs-identifier hs-var">specializeErrorString</span></a><span>
</span><a name="line-1350"></a><span>    </span><span class="hs-string">&quot;Current working directory no longer exists&quot;</span><span>
</span><a name="line-1351"></a><span>    </span><a href="../base-4.10.0.0/src/%{MODULE/./-}.html#%{NAME}/System.IO.Error.html#isDoesNotExistError"><span class="hs-identifier hs-var">isDoesNotExistError</span></a><span>
</span><a name="line-1352"></a><span>    </span><a href="#local-6989586621679042725"><span class="hs-identifier hs-var">getCwd</span></a><span>
</span><a name="line-1353"></a><span>  </span><span class="hs-keyword">where</span><span>
</span><a name="line-1354"></a><span class="hs-cpp">#ifdef mingw32_HOST_OS</span><span>
</span><a name="line-1355"></a><span>    </span><span class="hs-identifier">getCwd</span><span> </span><span class="hs-glyph">=</span><span> </span><span class="hs-identifier">Win32</span><span class="hs-operator">.</span><span class="hs-identifier">getCurrentDirectory</span><span>
</span><a name="line-1356"></a><span class="hs-cpp">#else</span><span>
</span><a name="line-1357"></a><span>    </span><a name="local-6989586621679042725"><a href="#local-6989586621679042725"><span class="hs-identifier">getCwd</span></a></a><span> </span><span class="hs-glyph">=</span><span> </span><a href="../unix-2.7.2.1/src/%{MODULE/./-}.html#%{NAME}/System.Posix.Directory.html#getWorkingDirectory"><span class="hs-identifier hs-var">Posix</span><span class="hs-operator hs-var">.</span><span class="hs-identifier hs-var">getWorkingDirectory</span></a><span>
</span><a name="line-1358"></a><span class="hs-cpp">#endif</span><span>
</span><a name="line-1359"></a><span>
</span><a name="line-1360"></a><span class="hs-comment">-- | Change the working directory to the given path.</span><span>
</span><a name="line-1361"></a><span class="hs-comment">--</span><span>
</span><a name="line-1362"></a><span class="hs-comment">-- In a multithreaded program, the current working directory is a global state</span><span>
</span><a name="line-1363"></a><span class="hs-comment">-- shared among all threads of the process.  Therefore, when performing</span><span>
</span><a name="line-1364"></a><span class="hs-comment">-- filesystem operations from multiple threads, it is highly recommended to</span><span>
</span><a name="line-1365"></a><span class="hs-comment">-- use absolute rather than relative paths (see: 'makeAbsolute').</span><span>
</span><a name="line-1366"></a><span class="hs-comment">--</span><span>
</span><a name="line-1367"></a><span class="hs-comment">-- The operation may fail with:</span><span>
</span><a name="line-1368"></a><span class="hs-comment">--</span><span>
</span><a name="line-1369"></a><span class="hs-comment">-- * 'HardwareFault'</span><span>
</span><a name="line-1370"></a><span class="hs-comment">-- A physical I\/O error has occurred.</span><span>
</span><a name="line-1371"></a><span class="hs-comment">-- @[EIO]@</span><span>
</span><a name="line-1372"></a><span class="hs-comment">--</span><span>
</span><a name="line-1373"></a><span class="hs-comment">-- * 'InvalidArgument'</span><span>
</span><a name="line-1374"></a><span class="hs-comment">-- The operand is not a valid directory name.</span><span>
</span><a name="line-1375"></a><span class="hs-comment">-- @[ENAMETOOLONG, ELOOP]@</span><span>
</span><a name="line-1376"></a><span class="hs-comment">--</span><span>
</span><a name="line-1377"></a><span class="hs-comment">-- * 'isDoesNotExistError' or 'NoSuchThing'</span><span>
</span><a name="line-1378"></a><span class="hs-comment">-- The directory does not exist.</span><span>
</span><a name="line-1379"></a><span class="hs-comment">-- @[ENOENT, ENOTDIR]@</span><span>
</span><a name="line-1380"></a><span class="hs-comment">--</span><span>
</span><a name="line-1381"></a><span class="hs-comment">-- * 'isPermissionError' or 'PermissionDenied'</span><span>
</span><a name="line-1382"></a><span class="hs-comment">-- The process has insufficient privileges to perform the operation.</span><span>
</span><a name="line-1383"></a><span class="hs-comment">-- @[EACCES]@</span><span>
</span><a name="line-1384"></a><span class="hs-comment">--</span><span>
</span><a name="line-1385"></a><span class="hs-comment">-- * 'UnsupportedOperation'</span><span>
</span><a name="line-1386"></a><span class="hs-comment">-- The operating system has no notion of current working directory, or the</span><span>
</span><a name="line-1387"></a><span class="hs-comment">-- working directory cannot be dynamically changed.</span><span>
</span><a name="line-1388"></a><span class="hs-comment">--</span><span>
</span><a name="line-1389"></a><span class="hs-comment">-- * 'InappropriateType'</span><span>
</span><a name="line-1390"></a><span class="hs-comment">-- The path refers to an existing non-directory object.</span><span>
</span><a name="line-1391"></a><span class="hs-comment">-- @[ENOTDIR]@</span><span>
</span><a name="line-1392"></a><span class="hs-comment">--</span><span>
</span><a name="line-1393"></a><span class="hs-identifier">setCurrentDirectory</span><span> </span><span class="hs-glyph">::</span><span> </span><a href="../base-4.10.0.0/src/%{MODULE/./-}.html#%{NAME}/GHC.IO.html#FilePath"><span class="hs-identifier hs-type">FilePath</span></a><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="hs-identifier hs-type">IO</span><span> </span><span class="hs-special">(</span><span class="hs-special">)</span><span>
</span><a name="line-1394"></a><a name="setCurrentDirectory"><a href="System.Directory.html#setCurrentDirectory"><span class="hs-identifier">setCurrentDirectory</span></a></a><span> </span><span class="hs-glyph">=</span><span>
</span><a name="line-1395"></a><span class="hs-cpp">#ifdef mingw32_HOST_OS</span><span>
</span><a name="line-1396"></a><span>  </span><span class="hs-identifier">Win32</span><span class="hs-operator">.</span><span class="hs-identifier">setCurrentDirectory</span><span>
</span><a name="line-1397"></a><span class="hs-cpp">#else</span><span>
</span><a name="line-1398"></a><span>  </span><a href="../unix-2.7.2.1/src/%{MODULE/./-}.html#%{NAME}/System.Posix.Directory.html#changeWorkingDirectory"><span class="hs-identifier hs-var">Posix</span><span class="hs-operator hs-var">.</span><span class="hs-identifier hs-var">changeWorkingDirectory</span></a><span>
</span><a name="line-1399"></a><span class="hs-cpp">#endif</span><span>
</span><a name="line-1400"></a><span>
</span><a name="line-1401"></a><span class="hs-comment">-- | Run an 'IO' action with the given working directory and restore the</span><span>
</span><a name="line-1402"></a><span class="hs-comment">-- original working directory afterwards, even if the given action fails due</span><span>
</span><a name="line-1403"></a><span class="hs-comment">-- to an exception.</span><span>
</span><a name="line-1404"></a><span class="hs-comment">--</span><span>
</span><a name="line-1405"></a><span class="hs-comment">-- The operation may fail with the same exceptions as 'getCurrentDirectory'</span><span>
</span><a name="line-1406"></a><span class="hs-comment">-- and 'setCurrentDirectory'.</span><span>
</span><a name="line-1407"></a><span class="hs-comment">--</span><span>
</span><a name="line-1408"></a><span class="hs-comment">-- @since 1.2.3.0</span><span>
</span><a name="line-1409"></a><span class="hs-comment">--</span><span>
</span><a name="line-1410"></a><span class="hs-identifier">withCurrentDirectory</span><span> </span><span class="hs-glyph">::</span><span> </span><a href="../base-4.10.0.0/src/%{MODULE/./-}.html#%{NAME}/GHC.IO.html#FilePath"><span class="hs-identifier hs-type">FilePath</span></a><span>  </span><span class="hs-comment">-- ^ Directory to execute in</span><span>
</span><a name="line-1411"></a><span>                     </span><span class="hs-glyph">-&gt;</span><span> </span><span class="hs-identifier hs-type">IO</span><span> </span><a href="#local-6989586621679040783"><span class="hs-identifier hs-type">a</span></a><span>      </span><span class="hs-comment">-- ^ Action to be executed</span><span>
</span><a name="line-1412"></a><span>                     </span><span class="hs-glyph">-&gt;</span><span> </span><span class="hs-identifier hs-type">IO</span><span> </span><a href="#local-6989586621679040783"><span class="hs-identifier hs-type">a</span></a><span>
</span><a name="line-1413"></a><a name="withCurrentDirectory"><a href="System.Directory.html#withCurrentDirectory"><span class="hs-identifier">withCurrentDirectory</span></a></a><span> </span><a name="local-6989586621679042726"><a href="#local-6989586621679042726"><span class="hs-identifier">dir</span></a></a><span> </span><a name="local-6989586621679042727"><a href="#local-6989586621679042727"><span class="hs-identifier">action</span></a></a><span> </span><span class="hs-glyph">=</span><span>
</span><a name="line-1414"></a><span>  </span><a href="../base-4.10.0.0/src/%{MODULE/./-}.html#%{NAME}/Control.Exception.Base.html#bracket"><span class="hs-identifier hs-var">bracket</span></a><span> </span><a href="System.Directory.html#getCurrentDirectory"><span class="hs-identifier hs-var">getCurrentDirectory</span></a><span> </span><a href="System.Directory.html#setCurrentDirectory"><span class="hs-identifier hs-var">setCurrentDirectory</span></a><span> </span><a href="../base-4.10.0.0/src/%{MODULE/./-}.html#%{NAME}/GHC.Base.html#%24"><span class="hs-operator hs-var">$</span></a><span> </span><span class="hs-glyph">\</span><span> </span><span class="hs-identifier">_</span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="hs-keyword">do</span><span>
</span><a name="line-1415"></a><span>    </span><a href="System.Directory.html#setCurrentDirectory"><span class="hs-identifier hs-var">setCurrentDirectory</span></a><span> </span><a href="#local-6989586621679042726"><span class="hs-identifier hs-var">dir</span></a><span>
</span><a name="line-1416"></a><span>    </span><a href="#local-6989586621679042727"><span class="hs-identifier hs-var">action</span></a><span>
</span><a name="line-1417"></a><span>
</span><a name="line-1418"></a><span class="hs-comment">-- | Obtain the size of a file in bytes.</span><span>
</span><a name="line-1419"></a><span class="hs-comment">--</span><span>
</span><a name="line-1420"></a><span class="hs-comment">-- @since 1.2.7.0</span><span>
</span><a name="line-1421"></a><span class="hs-identifier">getFileSize</span><span> </span><span class="hs-glyph">::</span><span> </span><a href="../base-4.10.0.0/src/%{MODULE/./-}.html#%{NAME}/GHC.IO.html#FilePath"><span class="hs-identifier hs-type">FilePath</span></a><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="hs-identifier hs-type">IO</span><span> </span><span class="hs-identifier hs-type">Integer</span><span>
</span><a name="line-1422"></a><a name="getFileSize"><a href="System.Directory.html#getFileSize"><span class="hs-identifier">getFileSize</span></a></a><span> </span><a name="local-6989586621679042728"><a href="#local-6989586621679042728"><span class="hs-identifier">path</span></a></a><span> </span><span class="hs-glyph">=</span><span>
</span><a name="line-1423"></a><span>  </span><span class="hs-special">(</span><span class="hs-special">`</span><a href="System.Directory.html#ioeAddLocation"><span class="hs-identifier hs-var">ioeAddLocation</span></a><span class="hs-special">`</span><span> </span><span class="hs-string">&quot;getFileSize&quot;</span><span class="hs-special">)</span><span> </span><span class="hs-special">`</span><a href="../base-4.10.0.0/src/%{MODULE/./-}.html#%{NAME}/System.IO.Error.html#modifyIOError"><span class="hs-identifier hs-var">modifyIOError</span></a><span class="hs-special">`</span><span> </span><span class="hs-keyword">do</span><span>
</span><a name="line-1424"></a><span class="hs-cpp">#ifdef mingw32_HOST_OS</span><span>
</span><a name="line-1425"></a><span>    </span><span class="hs-identifier">fromIntegral</span><span> </span><span class="hs-operator">&lt;$&gt;</span><span> </span><span class="hs-identifier">withFileStatus</span><span> </span><span class="hs-string">&quot;&quot;</span><span> </span><span class="hs-identifier">path</span><span> </span><span class="hs-identifier">st_size</span><span>
</span><a name="line-1426"></a><span class="hs-cpp">#else</span><span>
</span><a name="line-1427"></a><span>    </span><a href="../base-4.10.0.0/src/%{MODULE/./-}.html#%{NAME}/GHC.Real.html#fromIntegral"><span class="hs-identifier hs-var">fromIntegral</span></a><span> </span><a href="../base-4.10.0.0/src/%{MODULE/./-}.html#%{NAME}/GHC.Base.html#."><span class="hs-operator hs-var">.</span></a><span> </span><a href="../unix-2.7.2.1/src/%{MODULE/./-}.html#%{NAME}/System.Posix.Files.Common.html#fileSize"><span class="hs-identifier hs-var">Posix</span><span class="hs-operator hs-var">.</span><span class="hs-identifier hs-var">fileSize</span></a><span> </span><a href="../base-4.10.0.0/src/%{MODULE/./-}.html#%{NAME}/Data.Functor.html#%3C%24%3E"><span class="hs-operator hs-var">&lt;$&gt;</span></a><span> </span><a href="../unix-2.7.2.1/src/%{MODULE/./-}.html#%{NAME}/System.Posix.Files.html#getFileStatus"><span class="hs-identifier hs-var">Posix</span><span class="hs-operator hs-var">.</span><span class="hs-identifier hs-var">getFileStatus</span></a><span> </span><a href="#local-6989586621679042728"><span class="hs-identifier hs-var">path</span></a><span>
</span><a name="line-1428"></a><span class="hs-cpp">#endif</span><span>
</span><a name="line-1429"></a><span>
</span><a name="line-1430"></a><span class="hs-comment">-- | Test whether the given path points to an existing filesystem object.  If</span><span>
</span><a name="line-1431"></a><span class="hs-comment">-- the user lacks necessary permissions to search the parent directories, this</span><span>
</span><a name="line-1432"></a><span class="hs-comment">-- function may return false even if the file does actually exist.</span><span>
</span><a name="line-1433"></a><span class="hs-comment">--</span><span>
</span><a name="line-1434"></a><span class="hs-comment">-- @since 1.2.7.0</span><span>
</span><a name="line-1435"></a><span class="hs-identifier">doesPathExist</span><span> </span><span class="hs-glyph">::</span><span> </span><a href="../base-4.10.0.0/src/%{MODULE/./-}.html#%{NAME}/GHC.IO.html#FilePath"><span class="hs-identifier hs-type">FilePath</span></a><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="hs-identifier hs-type">IO</span><span> </span><span class="hs-identifier hs-type">Bool</span><span>
</span><a name="line-1436"></a><a name="doesPathExist"><a href="System.Directory.html#doesPathExist"><span class="hs-identifier">doesPathExist</span></a></a><span> </span><a name="local-6989586621679042729"><a href="#local-6989586621679042729"><span class="hs-identifier">path</span></a></a><span> </span><span class="hs-glyph">=</span><span>
</span><a name="line-1437"></a><span class="hs-cpp">#ifdef mingw32_HOST_OS</span><span>
</span><a name="line-1438"></a><span>  </span><span class="hs-special">(</span><span class="hs-identifier">withFileStatus</span><span> </span><span class="hs-string">&quot;&quot;</span><span> </span><span class="hs-identifier">path</span><span> </span><span class="hs-operator">$</span><span> </span><span class="hs-glyph">\</span><span> </span><span class="hs-identifier">_</span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="hs-identifier">return</span><span> </span><span class="hs-identifier">True</span><span class="hs-special">)</span><span>
</span><a name="line-1439"></a><span class="hs-cpp">#else</span><span>
</span><a name="line-1440"></a><span>  </span><span class="hs-special">(</span><a href="../unix-2.7.2.1/src/%{MODULE/./-}.html#%{NAME}/System.Posix.Files.html#getFileStatus"><span class="hs-identifier hs-var">Posix</span><span class="hs-operator hs-var">.</span><span class="hs-identifier hs-var">getFileStatus</span></a><span> </span><a href="#local-6989586621679042729"><span class="hs-identifier hs-var">path</span></a><span> </span><a href="../base-4.10.0.0/src/%{MODULE/./-}.html#%{NAME}/GHC.Base.html#%3E%3E"><span class="hs-operator hs-var">&gt;&gt;</span></a><span> </span><a href="../base-4.10.0.0/src/%{MODULE/./-}.html#%{NAME}/GHC.Base.html#return"><span class="hs-identifier hs-var">return</span></a><span> </span><span class="hs-identifier hs-var">True</span><span class="hs-special">)</span><span>
</span><a name="line-1441"></a><span class="hs-cpp">#endif</span><span>
</span><a name="line-1442"></a><span>  </span><span class="hs-special">`</span><a href="../base-4.10.0.0/src/%{MODULE/./-}.html#%{NAME}/System.IO.Error.html#catchIOError"><span class="hs-identifier hs-var">catchIOError</span></a><span class="hs-special">`</span><span> </span><span class="hs-glyph">\</span><span> </span><span class="hs-identifier">_</span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><a href="../base-4.10.0.0/src/%{MODULE/./-}.html#%{NAME}/GHC.Base.html#return"><span class="hs-identifier hs-var">return</span></a><span> </span><span class="hs-identifier hs-var">False</span><span>
</span><a name="line-1443"></a><span>
</span><a name="line-1444"></a><span class="hs-comment">{- |The operation 'doesDirectoryExist' returns 'True' if the argument file
exists and is either a directory or a symbolic link to a directory,
and 'False' otherwise.
-}</span><span>
</span><a name="line-1448"></a><span>
</span><a name="line-1449"></a><span class="hs-identifier">doesDirectoryExist</span><span> </span><span class="hs-glyph">::</span><span> </span><a href="../base-4.10.0.0/src/%{MODULE/./-}.html#%{NAME}/GHC.IO.html#FilePath"><span class="hs-identifier hs-type">FilePath</span></a><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="hs-identifier hs-type">IO</span><span> </span><span class="hs-identifier hs-type">Bool</span><span>
</span><a name="line-1450"></a><a name="doesDirectoryExist"><a href="System.Directory.html#doesDirectoryExist"><span class="hs-identifier">doesDirectoryExist</span></a></a><span> </span><a name="local-6989586621679042730"><a href="#local-6989586621679042730"><span class="hs-identifier">name</span></a></a><span> </span><span class="hs-glyph">=</span><span>
</span><a name="line-1451"></a><span class="hs-cpp">#ifdef mingw32_HOST_OS</span><span>
</span><a name="line-1452"></a><span>   </span><span class="hs-special">(</span><span class="hs-identifier">withFileStatus</span><span> </span><span class="hs-string">&quot;doesDirectoryExist&quot;</span><span> </span><span class="hs-identifier">name</span><span> </span><span class="hs-operator">$</span><span> </span><span class="hs-glyph">\</span><span class="hs-identifier">st</span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="hs-identifier">isDirectory</span><span> </span><span class="hs-identifier">st</span><span class="hs-special">)</span><span>
</span><a name="line-1453"></a><span class="hs-cpp">#else</span><span>
</span><a name="line-1454"></a><span>   </span><span class="hs-special">(</span><span class="hs-keyword">do</span><span> </span><a name="local-6989586621679042731"><a href="#local-6989586621679042731"><span class="hs-identifier">stat</span></a></a><span> </span><span class="hs-glyph">&lt;-</span><span> </span><a href="../unix-2.7.2.1/src/%{MODULE/./-}.html#%{NAME}/System.Posix.Files.html#getFileStatus"><span class="hs-identifier hs-var">Posix</span><span class="hs-operator hs-var">.</span><span class="hs-identifier hs-var">getFileStatus</span></a><span> </span><a href="#local-6989586621679042730"><span class="hs-identifier hs-var">name</span></a><span>
</span><a name="line-1455"></a><span>       </span><a href="../base-4.10.0.0/src/%{MODULE/./-}.html#%{NAME}/GHC.Base.html#return"><span class="hs-identifier hs-var">return</span></a><span> </span><span class="hs-special">(</span><a href="../unix-2.7.2.1/src/%{MODULE/./-}.html#%{NAME}/System.Posix.Files.Common.html#isDirectory"><span class="hs-identifier hs-var">Posix</span><span class="hs-operator hs-var">.</span><span class="hs-identifier hs-var">isDirectory</span></a><span> </span><a href="#local-6989586621679042731"><span class="hs-identifier hs-var">stat</span></a><span class="hs-special">)</span><span class="hs-special">)</span><span>
</span><a name="line-1456"></a><span class="hs-cpp">#endif</span><span>
</span><a name="line-1457"></a><span>   </span><span class="hs-special">`</span><a href="../base-4.10.0.0/src/%{MODULE/./-}.html#%{NAME}/System.IO.Error.html#catchIOError"><span class="hs-identifier hs-var">catchIOError</span></a><span class="hs-special">`</span><span> </span><span class="hs-glyph">\</span><span> </span><span class="hs-identifier">_</span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><a href="../base-4.10.0.0/src/%{MODULE/./-}.html#%{NAME}/GHC.Base.html#return"><span class="hs-identifier hs-var">return</span></a><span> </span><span class="hs-identifier hs-var">False</span><span>
</span><a name="line-1458"></a><span>
</span><a name="line-1459"></a><span class="hs-comment">{- |The operation 'doesFileExist' returns 'True'
if the argument file exists and is not a directory, and 'False' otherwise.
-}</span><span>
</span><a name="line-1462"></a><span>
</span><a name="line-1463"></a><span class="hs-identifier">doesFileExist</span><span> </span><span class="hs-glyph">::</span><span> </span><a href="../base-4.10.0.0/src/%{MODULE/./-}.html#%{NAME}/GHC.IO.html#FilePath"><span class="hs-identifier hs-type">FilePath</span></a><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="hs-identifier hs-type">IO</span><span> </span><span class="hs-identifier hs-type">Bool</span><span>
</span><a name="line-1464"></a><a name="doesFileExist"><a href="System.Directory.html#doesFileExist"><span class="hs-identifier">doesFileExist</span></a></a><span> </span><a name="local-6989586621679042732"><a href="#local-6989586621679042732"><span class="hs-identifier">name</span></a></a><span> </span><span class="hs-glyph">=</span><span>
</span><a name="line-1465"></a><span class="hs-cpp">#ifdef mingw32_HOST_OS</span><span>
</span><a name="line-1466"></a><span>   </span><span class="hs-special">(</span><span class="hs-identifier">withFileStatus</span><span> </span><span class="hs-string">&quot;doesFileExist&quot;</span><span> </span><span class="hs-identifier">name</span><span> </span><span class="hs-operator">$</span><span> </span><span class="hs-glyph">\</span><span class="hs-identifier">st</span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="hs-keyword">do</span><span> </span><span class="hs-identifier">b</span><span> </span><span class="hs-glyph">&lt;-</span><span> </span><span class="hs-identifier">isDirectory</span><span> </span><span class="hs-identifier">st</span><span class="hs-special">;</span><span> </span><span class="hs-identifier">return</span><span> </span><span class="hs-special">(</span><span class="hs-identifier">not</span><span> </span><span class="hs-identifier">b</span><span class="hs-special">)</span><span class="hs-special">)</span><span>
</span><a name="line-1467"></a><span class="hs-cpp">#else</span><span>
</span><a name="line-1468"></a><span>   </span><span class="hs-special">(</span><span class="hs-keyword">do</span><span> </span><a name="local-6989586621679042733"><a href="#local-6989586621679042733"><span class="hs-identifier">stat</span></a></a><span> </span><span class="hs-glyph">&lt;-</span><span> </span><a href="../unix-2.7.2.1/src/%{MODULE/./-}.html#%{NAME}/System.Posix.Files.html#getFileStatus"><span class="hs-identifier hs-var">Posix</span><span class="hs-operator hs-var">.</span><span class="hs-identifier hs-var">getFileStatus</span></a><span> </span><a href="#local-6989586621679042732"><span class="hs-identifier hs-var">name</span></a><span>
</span><a name="line-1469"></a><span>       </span><a href="../base-4.10.0.0/src/%{MODULE/./-}.html#%{NAME}/GHC.Base.html#return"><span class="hs-identifier hs-var">return</span></a><span> </span><span class="hs-special">(</span><span class="hs-identifier hs-var">not</span><span> </span><span class="hs-special">(</span><a href="../unix-2.7.2.1/src/%{MODULE/./-}.html#%{NAME}/System.Posix.Files.Common.html#isDirectory"><span class="hs-identifier hs-var">Posix</span><span class="hs-operator hs-var">.</span><span class="hs-identifier hs-var">isDirectory</span></a><span> </span><a href="#local-6989586621679042733"><span class="hs-identifier hs-var">stat</span></a><span class="hs-special">)</span><span class="hs-special">)</span><span class="hs-special">)</span><span>
</span><a name="line-1470"></a><span class="hs-cpp">#endif</span><span>
</span><a name="line-1471"></a><span>   </span><span class="hs-special">`</span><a href="../base-4.10.0.0/src/%{MODULE/./-}.html#%{NAME}/System.IO.Error.html#catchIOError"><span class="hs-identifier hs-var">catchIOError</span></a><span class="hs-special">`</span><span> </span><span class="hs-glyph">\</span><span> </span><span class="hs-identifier">_</span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><a href="../base-4.10.0.0/src/%{MODULE/./-}.html#%{NAME}/GHC.Base.html#return"><span class="hs-identifier hs-var">return</span></a><span> </span><span class="hs-identifier hs-var">False</span><span>
</span><a name="line-1472"></a><span>
</span><a name="line-1473"></a><span class="hs-comment">-- | Check whether the path refers to a symbolic link.  On Windows, this tests</span><span>
</span><a name="line-1474"></a><span class="hs-comment">-- for @FILE_ATTRIBUTE_REPARSE_POINT@.</span><span>
</span><a name="line-1475"></a><span class="hs-comment">--</span><span>
</span><a name="line-1476"></a><span class="hs-comment">-- @since 1.3.0.0</span><span>
</span><a name="line-1477"></a><span class="hs-identifier">pathIsSymbolicLink</span><span> </span><span class="hs-glyph">::</span><span> </span><a href="../base-4.10.0.0/src/%{MODULE/./-}.html#%{NAME}/GHC.IO.html#FilePath"><span class="hs-identifier hs-type">FilePath</span></a><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="hs-identifier hs-type">IO</span><span> </span><span class="hs-identifier hs-type">Bool</span><span>
</span><a name="line-1478"></a><a name="pathIsSymbolicLink"><a href="System.Directory.html#pathIsSymbolicLink"><span class="hs-identifier">pathIsSymbolicLink</span></a></a><span> </span><a name="local-6989586621679042734"><a href="#local-6989586621679042734"><span class="hs-identifier">path</span></a></a><span> </span><span class="hs-glyph">=</span><span>
</span><a name="line-1479"></a><span>  </span><span class="hs-special">(</span><span class="hs-special">`</span><a href="System.Directory.html#ioeAddLocation"><span class="hs-identifier hs-var">ioeAddLocation</span></a><span class="hs-special">`</span><span> </span><span class="hs-string">&quot;getDirectoryType&quot;</span><span class="hs-special">)</span><span> </span><span class="hs-special">`</span><a href="../base-4.10.0.0/src/%{MODULE/./-}.html#%{NAME}/System.IO.Error.html#modifyIOError"><span class="hs-identifier hs-var">modifyIOError</span></a><span class="hs-special">`</span><span> </span><span class="hs-keyword">do</span><span>
</span><a name="line-1480"></a><span class="hs-cpp">#ifdef mingw32_HOST_OS</span><span>
</span><a name="line-1481"></a><span>    </span><span class="hs-identifier">isReparsePoint</span><span> </span><span class="hs-operator">&lt;$&gt;</span><span> </span><span class="hs-identifier">Win32</span><span class="hs-operator">.</span><span class="hs-identifier">getFileAttributes</span><span> </span><span class="hs-identifier">path</span><span>
</span><a name="line-1482"></a><span>  </span><span class="hs-keyword">where</span><span>
</span><a name="line-1483"></a><span>    </span><span class="hs-identifier">isReparsePoint</span><span> </span><span class="hs-identifier">attr</span><span> </span><span class="hs-glyph">=</span><span> </span><span class="hs-identifier">attr</span><span> </span><span class="hs-operator">.&amp;.</span><span> </span><span class="hs-identifier">win32_fILE_ATTRIBUTE_REPARSE_POINT</span><span> </span><span class="hs-operator">/=</span><span> </span><span class="hs-number">0</span><span>
</span><a name="line-1484"></a><span class="hs-cpp">#else</span><span>
</span><a name="line-1485"></a><span>    </span><a href="../unix-2.7.2.1/src/%{MODULE/./-}.html#%{NAME}/System.Posix.Files.Common.html#isSymbolicLink"><span class="hs-identifier hs-var">Posix</span><span class="hs-operator hs-var">.</span><span class="hs-identifier hs-var">isSymbolicLink</span></a><span> </span><a href="../base-4.10.0.0/src/%{MODULE/./-}.html#%{NAME}/Data.Functor.html#%3C%24%3E"><span class="hs-operator hs-var">&lt;$&gt;</span></a><span> </span><a href="../unix-2.7.2.1/src/%{MODULE/./-}.html#%{NAME}/System.Posix.Files.html#getSymbolicLinkStatus"><span class="hs-identifier hs-var">Posix</span><span class="hs-operator hs-var">.</span><span class="hs-identifier hs-var">getSymbolicLinkStatus</span></a><span> </span><a href="#local-6989586621679042734"><span class="hs-identifier hs-var">path</span></a><span>
</span><a name="line-1486"></a><span class="hs-cpp">#endif</span><span>
</span><a name="line-1487"></a><span>
</span><a name="line-1488"></a><span class="hs-pragma">{-# DEPRECATED isSymbolicLink &quot;Use 'pathIsSymbolicLink' instead&quot; #-}</span><span>
</span><a name="line-1489"></a><span class="hs-identifier">isSymbolicLink</span><span> </span><span class="hs-glyph">::</span><span> </span><a href="../base-4.10.0.0/src/%{MODULE/./-}.html#%{NAME}/GHC.IO.html#FilePath"><span class="hs-identifier hs-type">FilePath</span></a><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="hs-identifier hs-type">IO</span><span> </span><span class="hs-identifier hs-type">Bool</span><span>
</span><a name="line-1490"></a><a name="isSymbolicLink"><a href="System.Directory.html#isSymbolicLink"><span class="hs-identifier">isSymbolicLink</span></a></a><span> </span><span class="hs-glyph">=</span><span> </span><a href="System.Directory.html#pathIsSymbolicLink"><span class="hs-identifier hs-var">pathIsSymbolicLink</span></a><span>
</span><a name="line-1491"></a><span>
</span><a name="line-1492"></a><span class="hs-cpp">#ifdef mingw32_HOST_OS</span><span>
</span><a name="line-1493"></a><span class="hs-comment">-- | Open the handle of an existing file or directory.</span><span>
</span><a name="line-1494"></a><span class="hs-identifier">openFileHandle</span><span> </span><span class="hs-glyph">::</span><span> </span><span class="hs-identifier">String</span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="hs-identifier">Win32</span><span class="hs-operator">.</span><span class="hs-identifier">AccessMode</span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="hs-identifier">IO</span><span> </span><span class="hs-identifier">Win32</span><span class="hs-operator">.</span><span class="hs-identifier">HANDLE</span><span>
</span><a name="line-1495"></a><span class="hs-identifier">openFileHandle</span><span> </span><span class="hs-identifier">path</span><span> </span><span class="hs-identifier">mode</span><span> </span><span class="hs-glyph">=</span><span> </span><span class="hs-identifier">Win32</span><span class="hs-operator">.</span><span class="hs-identifier">createFile</span><span> </span><span class="hs-identifier">path</span><span> </span><span class="hs-identifier">mode</span><span> </span><span class="hs-identifier">share</span><span> </span><span class="hs-identifier">Nothing</span><span>
</span><a name="line-1496"></a><span>                                            </span><span class="hs-identifier">Win32</span><span class="hs-operator">.</span><span class="hs-identifier">oPEN_EXISTING</span><span> </span><span class="hs-identifier">flags</span><span> </span><span class="hs-identifier">Nothing</span><span>
</span><a name="line-1497"></a><span>  </span><span class="hs-keyword">where</span><span> </span><span class="hs-identifier">share</span><span> </span><span class="hs-glyph">=</span><span>  </span><span class="hs-identifier">win32_fILE_SHARE_DELETE</span><span>
</span><a name="line-1498"></a><span>             </span><span class="hs-operator">.|.</span><span> </span><span class="hs-identifier">Win32</span><span class="hs-operator">.</span><span class="hs-identifier">fILE_SHARE_READ</span><span>
</span><a name="line-1499"></a><span>             </span><span class="hs-operator">.|.</span><span> </span><span class="hs-identifier">Win32</span><span class="hs-operator">.</span><span class="hs-identifier">fILE_SHARE_WRITE</span><span>
</span><a name="line-1500"></a><span>        </span><span class="hs-identifier">flags</span><span> </span><span class="hs-glyph">=</span><span>  </span><span class="hs-identifier">Win32</span><span class="hs-operator">.</span><span class="hs-identifier">fILE_ATTRIBUTE_NORMAL</span><span>
</span><a name="line-1501"></a><span>             </span><span class="hs-operator">.|.</span><span> </span><span class="hs-identifier">Win32</span><span class="hs-operator">.</span><span class="hs-identifier">fILE_FLAG_BACKUP_SEMANTICS</span><span> </span><span class="hs-comment">-- required for directories</span><span>
</span><a name="line-1502"></a><span class="hs-cpp">#endif</span><span>
</span><a name="line-1503"></a><span>
</span><a name="line-1504"></a><span class="hs-comment">-- | Obtain the time at which the file or directory was last accessed.</span><span>
</span><a name="line-1505"></a><span class="hs-comment">--</span><span>
</span><a name="line-1506"></a><span class="hs-comment">-- The operation may fail with:</span><span>
</span><a name="line-1507"></a><span class="hs-comment">--</span><span>
</span><a name="line-1508"></a><span class="hs-comment">-- * 'isPermissionError' if the user is not permitted to read</span><span>
</span><a name="line-1509"></a><span class="hs-comment">--   the access time; or</span><span>
</span><a name="line-1510"></a><span class="hs-comment">--</span><span>
</span><a name="line-1511"></a><span class="hs-comment">-- * 'isDoesNotExistError' if the file or directory does not exist.</span><span>
</span><a name="line-1512"></a><span class="hs-comment">--</span><span>
</span><a name="line-1513"></a><span class="hs-comment">-- Caveat for POSIX systems: This function returns a timestamp with sub-second</span><span>
</span><a name="line-1514"></a><span class="hs-comment">-- resolution only if this package is compiled against @unix-2.6.0.0@ or later</span><span>
</span><a name="line-1515"></a><span class="hs-comment">-- and the underlying filesystem supports them.</span><span>
</span><a name="line-1516"></a><span class="hs-comment">--</span><span>
</span><a name="line-1517"></a><span class="hs-comment">-- @since 1.2.3.0</span><span>
</span><a name="line-1518"></a><span class="hs-comment">--</span><span>
</span><a name="line-1519"></a><span class="hs-identifier">getAccessTime</span><span> </span><span class="hs-glyph">::</span><span> </span><a href="../base-4.10.0.0/src/%{MODULE/./-}.html#%{NAME}/GHC.IO.html#FilePath"><span class="hs-identifier hs-type">FilePath</span></a><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="hs-identifier hs-type">IO</span><span> </span><a href="../time-1.8.0.1/src/%{MODULE/./-}.html#%{NAME}/Data.Time.Clock.Internal.UTCTime.html#UTCTime"><span class="hs-identifier hs-type">UTCTime</span></a><span>
</span><a name="line-1520"></a><a name="getAccessTime"><a href="System.Directory.html#getAccessTime"><span class="hs-identifier">getAccessTime</span></a></a><span> </span><span class="hs-glyph">=</span><span> </span><a href="../base-4.10.0.0/src/%{MODULE/./-}.html#%{NAME}/System.IO.Error.html#modifyIOError"><span class="hs-identifier hs-var">modifyIOError</span></a><span> </span><span class="hs-special">(</span><span class="hs-special">`</span><a href="System.Directory.html#ioeAddLocation"><span class="hs-identifier hs-var">ioeAddLocation</span></a><span class="hs-special">`</span><span> </span><span class="hs-string">&quot;getAccessTime&quot;</span><span class="hs-special">)</span><span> </span><a href="../base-4.10.0.0/src/%{MODULE/./-}.html#%{NAME}/GHC.Base.html#."><span class="hs-operator hs-var">.</span></a><span>
</span><a name="line-1521"></a><span>                </span><span class="hs-special">(</span><a href="../base-4.10.0.0/src/%{MODULE/./-}.html#%{NAME}/Data.Tuple.html#fst"><span class="hs-identifier hs-var">fst</span></a><span> </span><a href="../base-4.10.0.0/src/%{MODULE/./-}.html#%{NAME}/Data.Functor.html#%3C%24%3E"><span class="hs-operator hs-var">&lt;$&gt;</span></a><span class="hs-special">)</span><span> </span><a href="../base-4.10.0.0/src/%{MODULE/./-}.html#%{NAME}/GHC.Base.html#."><span class="hs-operator hs-var">.</span></a><span> </span><a href="System.Directory.html#getFileTimes"><span class="hs-identifier hs-var">getFileTimes</span></a><span>
</span><a name="line-1522"></a><span>
</span><a name="line-1523"></a><span class="hs-comment">-- | Obtain the time at which the file or directory was last modified.</span><span>
</span><a name="line-1524"></a><span class="hs-comment">--</span><span>
</span><a name="line-1525"></a><span class="hs-comment">-- The operation may fail with:</span><span>
</span><a name="line-1526"></a><span class="hs-comment">--</span><span>
</span><a name="line-1527"></a><span class="hs-comment">-- * 'isPermissionError' if the user is not permitted to read</span><span>
</span><a name="line-1528"></a><span class="hs-comment">--   the modification time; or</span><span>
</span><a name="line-1529"></a><span class="hs-comment">--</span><span>
</span><a name="line-1530"></a><span class="hs-comment">-- * 'isDoesNotExistError' if the file or directory does not exist.</span><span>
</span><a name="line-1531"></a><span class="hs-comment">--</span><span>
</span><a name="line-1532"></a><span class="hs-comment">-- Caveat for POSIX systems: This function returns a timestamp with sub-second</span><span>
</span><a name="line-1533"></a><span class="hs-comment">-- resolution only if this package is compiled against @unix-2.6.0.0@ or later</span><span>
</span><a name="line-1534"></a><span class="hs-comment">-- and the underlying filesystem supports them.</span><span>
</span><a name="line-1535"></a><span class="hs-comment">--</span><span>
</span><a name="line-1536"></a><span class="hs-identifier">getModificationTime</span><span> </span><span class="hs-glyph">::</span><span> </span><a href="../base-4.10.0.0/src/%{MODULE/./-}.html#%{NAME}/GHC.IO.html#FilePath"><span class="hs-identifier hs-type">FilePath</span></a><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="hs-identifier hs-type">IO</span><span> </span><a href="../time-1.8.0.1/src/%{MODULE/./-}.html#%{NAME}/Data.Time.Clock.Internal.UTCTime.html#UTCTime"><span class="hs-identifier hs-type">UTCTime</span></a><span>
</span><a name="line-1537"></a><a name="getModificationTime"><a href="System.Directory.html#getModificationTime"><span class="hs-identifier">getModificationTime</span></a></a><span> </span><span class="hs-glyph">=</span><span> </span><a href="../base-4.10.0.0/src/%{MODULE/./-}.html#%{NAME}/System.IO.Error.html#modifyIOError"><span class="hs-identifier hs-var">modifyIOError</span></a><span> </span><span class="hs-special">(</span><span class="hs-special">`</span><a href="System.Directory.html#ioeAddLocation"><span class="hs-identifier hs-var">ioeAddLocation</span></a><span class="hs-special">`</span><span> </span><span class="hs-string">&quot;getModificationTime&quot;</span><span class="hs-special">)</span><span> </span><a href="../base-4.10.0.0/src/%{MODULE/./-}.html#%{NAME}/GHC.Base.html#."><span class="hs-operator hs-var">.</span></a><span>
</span><a name="line-1538"></a><span>                      </span><span class="hs-special">(</span><a href="../base-4.10.0.0/src/%{MODULE/./-}.html#%{NAME}/Data.Tuple.html#snd"><span class="hs-identifier hs-var">snd</span></a><span> </span><a href="../base-4.10.0.0/src/%{MODULE/./-}.html#%{NAME}/Data.Functor.html#%3C%24%3E"><span class="hs-operator hs-var">&lt;$&gt;</span></a><span class="hs-special">)</span><span> </span><a href="../base-4.10.0.0/src/%{MODULE/./-}.html#%{NAME}/GHC.Base.html#."><span class="hs-operator hs-var">.</span></a><span> </span><a href="System.Directory.html#getFileTimes"><span class="hs-identifier hs-var">getFileTimes</span></a><span>
</span><a name="line-1539"></a><span>
</span><a name="line-1540"></a><span class="hs-identifier">getFileTimes</span><span> </span><span class="hs-glyph">::</span><span> </span><a href="../base-4.10.0.0/src/%{MODULE/./-}.html#%{NAME}/GHC.IO.html#FilePath"><span class="hs-identifier hs-type">FilePath</span></a><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="hs-identifier hs-type">IO</span><span> </span><span class="hs-special">(</span><a href="../time-1.8.0.1/src/%{MODULE/./-}.html#%{NAME}/Data.Time.Clock.Internal.UTCTime.html#UTCTime"><span class="hs-identifier hs-type">UTCTime</span></a><span class="hs-special">,</span><span> </span><a href="../time-1.8.0.1/src/%{MODULE/./-}.html#%{NAME}/Data.Time.Clock.Internal.UTCTime.html#UTCTime"><span class="hs-identifier hs-type">UTCTime</span></a><span class="hs-special">)</span><span>
</span><a name="line-1541"></a><a name="getFileTimes"><a href="System.Directory.html#getFileTimes"><span class="hs-identifier">getFileTimes</span></a></a><span> </span><a name="local-6989586621679042750"><a href="#local-6989586621679042750"><span class="hs-identifier">path</span></a></a><span> </span><span class="hs-glyph">=</span><span>
</span><a name="line-1542"></a><span>  </span><a href="../base-4.10.0.0/src/%{MODULE/./-}.html#%{NAME}/System.IO.Error.html#modifyIOError"><span class="hs-identifier hs-var">modifyIOError</span></a><span> </span><span class="hs-special">(</span><span class="hs-special">`</span><a href="System.Directory.html#ioeAddLocation"><span class="hs-identifier hs-var">ioeAddLocation</span></a><span class="hs-special">`</span><span> </span><span class="hs-string">&quot;getFileTimes&quot;</span><span class="hs-special">)</span><span> </span><a href="../base-4.10.0.0/src/%{MODULE/./-}.html#%{NAME}/GHC.Base.html#."><span class="hs-operator hs-var">.</span></a><span>
</span><a name="line-1543"></a><span>  </span><a href="../base-4.10.0.0/src/%{MODULE/./-}.html#%{NAME}/System.IO.Error.html#modifyIOError"><span class="hs-identifier hs-var">modifyIOError</span></a><span> </span><span class="hs-special">(</span><span class="hs-special">`</span><a href="../base-4.10.0.0/src/%{MODULE/./-}.html#%{NAME}/System.IO.Error.html#ioeSetFileName"><span class="hs-identifier hs-var">ioeSetFileName</span></a><span class="hs-special">`</span><span> </span><a href="#local-6989586621679042750"><span class="hs-identifier hs-var">path</span></a><span class="hs-special">)</span><span> </span><a href="../base-4.10.0.0/src/%{MODULE/./-}.html#%{NAME}/GHC.Base.html#%24"><span class="hs-operator hs-var">$</span></a><span>
</span><a name="line-1544"></a><span>    </span><a href="#local-6989586621679042752"><span class="hs-identifier hs-var">getTimes</span></a><span>
</span><a name="line-1545"></a><span>  </span><span class="hs-keyword">where</span><span>
</span><a name="line-1546"></a><span>    </span><a name="local-6989586621679042751"><a href="#local-6989586621679042751"><span class="hs-identifier">path'</span></a></a><span> </span><span class="hs-glyph">=</span><span> </span><a href="../filepath-1.4.1.1/src/%{MODULE/./-}.html#%{NAME}/System.FilePath.Posix.html#normalise"><span class="hs-identifier hs-var">normalise</span></a><span> </span><a href="#local-6989586621679042750"><span class="hs-identifier hs-var">path</span></a><span>              </span><span class="hs-comment">-- handle empty paths</span><span>
</span><a name="line-1547"></a><span class="hs-cpp">#ifdef mingw32_HOST_OS</span><span>
</span><a name="line-1548"></a><span>    </span><span class="hs-identifier">getTimes</span><span> </span><span class="hs-glyph">=</span><span>
</span><a name="line-1549"></a><span>      </span><span class="hs-identifier">bracket</span><span> </span><span class="hs-special">(</span><span class="hs-identifier">openFileHandle</span><span> </span><span class="hs-identifier">path'</span><span> </span><span class="hs-identifier">Win32</span><span class="hs-operator">.</span><span class="hs-identifier">gENERIC_READ</span><span class="hs-special">)</span><span>
</span><a name="line-1550"></a><span>              </span><span class="hs-identifier">Win32</span><span class="hs-operator">.</span><span class="hs-identifier">closeHandle</span><span> </span><span class="hs-operator">$</span><span> </span><span class="hs-glyph">\</span><span> </span><span class="hs-identifier">handle</span><span> </span><span class="hs-glyph">-&gt;</span><span>
</span><a name="line-1551"></a><span>      </span><span class="hs-identifier">alloca</span><span> </span><span class="hs-operator">$</span><span> </span><span class="hs-glyph">\</span><span> </span><span class="hs-identifier">atime</span><span> </span><span class="hs-glyph">-&gt;</span><span>
</span><a name="line-1552"></a><span>      </span><span class="hs-identifier">alloca</span><span> </span><span class="hs-operator">$</span><span> </span><span class="hs-glyph">\</span><span> </span><span class="hs-identifier">mtime</span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="hs-keyword">do</span><span>
</span><a name="line-1553"></a><span>        </span><span class="hs-identifier">Win32</span><span class="hs-operator">.</span><span class="hs-identifier">failIf_</span><span> </span><span class="hs-identifier">not</span><span> </span><span class="hs-string">&quot;&quot;</span><span> </span><span class="hs-operator">$</span><span>
</span><a name="line-1554"></a><span>          </span><span class="hs-identifier">Win32</span><span class="hs-operator">.</span><span class="hs-identifier">c_GetFileTime</span><span> </span><span class="hs-identifier">handle</span><span> </span><span class="hs-identifier">nullPtr</span><span> </span><span class="hs-identifier">atime</span><span> </span><span class="hs-identifier">mtime</span><span>
</span><a name="line-1555"></a><span>        </span><span class="hs-special">(</span><span class="hs-special">(</span><span class="hs-special">,</span><span class="hs-special">)</span><span> </span><span class="hs-special">`</span><span class="hs-identifier">on</span><span class="hs-special">`</span><span> </span><span class="hs-identifier">posixSecondsToUTCTime</span><span> </span><span class="hs-operator">.</span><span> </span><span class="hs-identifier">windowsToPosixTime</span><span class="hs-special">)</span><span>
</span><a name="line-1556"></a><span>          </span><span class="hs-operator">&lt;$&gt;</span><span> </span><span class="hs-identifier">peek</span><span> </span><span class="hs-identifier">atime</span><span>
</span><a name="line-1557"></a><span>          </span><span class="hs-operator">&lt;*&gt;</span><span> </span><span class="hs-identifier">peek</span><span> </span><span class="hs-identifier">mtime</span><span>
</span><a name="line-1558"></a><span class="hs-cpp">#else</span><span>
</span><a name="line-1559"></a><span>    </span><a name="local-6989586621679042752"><a href="#local-6989586621679042752"><span class="hs-identifier">getTimes</span></a></a><span> </span><span class="hs-glyph">=</span><span> </span><a href="System.Directory.html#fileTimesFromStatus"><span class="hs-identifier hs-var">fileTimesFromStatus</span></a><span> </span><a href="../base-4.10.0.0/src/%{MODULE/./-}.html#%{NAME}/Data.Functor.html#%3C%24%3E"><span class="hs-operator hs-var">&lt;$&gt;</span></a><span> </span><a href="../unix-2.7.2.1/src/%{MODULE/./-}.html#%{NAME}/System.Posix.Files.html#getFileStatus"><span class="hs-identifier hs-var">Posix</span><span class="hs-operator hs-var">.</span><span class="hs-identifier hs-var">getFileStatus</span></a><span> </span><a href="#local-6989586621679042751"><span class="hs-identifier hs-var">path'</span></a><span>
</span><a name="line-1560"></a><span class="hs-cpp">#endif</span><span>
</span><a name="line-1561"></a><span>
</span><a name="line-1562"></a><span class="hs-cpp">#ifndef mingw32_HOST_OS</span><span>
</span><a name="line-1563"></a><span class="hs-identifier">fileTimesFromStatus</span><span> </span><span class="hs-glyph">::</span><span> </span><a href="../unix-2.7.2.1/src/%{MODULE/./-}.html#%{NAME}/System.Posix.Files.Common.html#FileStatus"><span class="hs-identifier hs-type">Posix</span><span class="hs-operator hs-type">.</span><span class="hs-identifier hs-type">FileStatus</span></a><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="hs-special">(</span><a href="../time-1.8.0.1/src/%{MODULE/./-}.html#%{NAME}/Data.Time.Clock.Internal.UTCTime.html#UTCTime"><span class="hs-identifier hs-type">UTCTime</span></a><span class="hs-special">,</span><span> </span><a href="../time-1.8.0.1/src/%{MODULE/./-}.html#%{NAME}/Data.Time.Clock.Internal.UTCTime.html#UTCTime"><span class="hs-identifier hs-type">UTCTime</span></a><span class="hs-special">)</span><span>
</span><a name="line-1564"></a><a name="fileTimesFromStatus"><a href="System.Directory.html#fileTimesFromStatus"><span class="hs-identifier">fileTimesFromStatus</span></a></a><span> </span><a name="local-6989586621679042753"><a href="#local-6989586621679042753"><span class="hs-identifier">st</span></a></a><span> </span><span class="hs-glyph">=</span><span>
</span><a name="line-1565"></a><span class="hs-cpp"># if MIN_VERSION_unix(2, 6, 0)</span><span>
</span><a name="line-1566"></a><span>  </span><span class="hs-special">(</span><span> </span><a href="../time-1.8.0.1/src/%{MODULE/./-}.html#%{NAME}/Data.Time.Clock.POSIX.html#posixSecondsToUTCTime"><span class="hs-identifier hs-var">posixSecondsToUTCTime</span></a><span> </span><span class="hs-special">(</span><a href="../unix-2.7.2.1/src/%{MODULE/./-}.html#%{NAME}/System.Posix.Files.Common.html#accessTimeHiRes"><span class="hs-identifier hs-var">Posix</span><span class="hs-operator hs-var">.</span><span class="hs-identifier hs-var">accessTimeHiRes</span></a><span> </span><a href="#local-6989586621679042753"><span class="hs-identifier hs-var">st</span></a><span class="hs-special">)</span><span>
</span><a name="line-1567"></a><span>  </span><span class="hs-special">,</span><span> </span><a href="../time-1.8.0.1/src/%{MODULE/./-}.html#%{NAME}/Data.Time.Clock.POSIX.html#posixSecondsToUTCTime"><span class="hs-identifier hs-var">posixSecondsToUTCTime</span></a><span> </span><span class="hs-special">(</span><a href="../unix-2.7.2.1/src/%{MODULE/./-}.html#%{NAME}/System.Posix.Files.Common.html#modificationTimeHiRes"><span class="hs-identifier hs-var">Posix</span><span class="hs-operator hs-var">.</span><span class="hs-identifier hs-var">modificationTimeHiRes</span></a><span> </span><a href="#local-6989586621679042753"><span class="hs-identifier hs-var">st</span></a><span class="hs-special">)</span><span> </span><span class="hs-special">)</span><span>
</span><a name="line-1568"></a><span class="hs-cpp"># else</span><span>
</span><a name="line-1569"></a><span>  </span><span class="hs-special">(</span><span> </span><span class="hs-identifier">posixSecondsToUTCTime</span><span> </span><span class="hs-special">(</span><span class="hs-identifier">realToFrac</span><span> </span><span class="hs-special">(</span><span class="hs-identifier">Posix</span><span class="hs-operator">.</span><span class="hs-identifier">accessTime</span><span> </span><span class="hs-identifier">st</span><span class="hs-special">)</span><span class="hs-special">)</span><span>
</span><a name="line-1570"></a><span>  </span><span class="hs-special">,</span><span> </span><span class="hs-identifier">posixSecondsToUTCTime</span><span> </span><span class="hs-special">(</span><span class="hs-identifier">realToFrac</span><span> </span><span class="hs-special">(</span><span class="hs-identifier">Posix</span><span class="hs-operator">.</span><span class="hs-identifier">modificationTime</span><span> </span><span class="hs-identifier">st</span><span class="hs-special">)</span><span class="hs-special">)</span><span> </span><span class="hs-special">)</span><span>
</span><a name="line-1571"></a><span class="hs-cpp"># endif</span><span>
</span><a name="line-1572"></a><span class="hs-cpp">#endif</span><span>
</span><a name="line-1573"></a><span>
</span><a name="line-1574"></a><span class="hs-comment">-- | Change the time at which the file or directory was last accessed.</span><span>
</span><a name="line-1575"></a><span class="hs-comment">--</span><span>
</span><a name="line-1576"></a><span class="hs-comment">-- The operation may fail with:</span><span>
</span><a name="line-1577"></a><span class="hs-comment">--</span><span>
</span><a name="line-1578"></a><span class="hs-comment">-- * 'isPermissionError' if the user is not permitted to alter the</span><span>
</span><a name="line-1579"></a><span class="hs-comment">--   access time; or</span><span>
</span><a name="line-1580"></a><span class="hs-comment">--</span><span>
</span><a name="line-1581"></a><span class="hs-comment">-- * 'isDoesNotExistError' if the file or directory does not exist.</span><span>
</span><a name="line-1582"></a><span class="hs-comment">--</span><span>
</span><a name="line-1583"></a><span class="hs-comment">-- Some caveats for POSIX systems:</span><span>
</span><a name="line-1584"></a><span class="hs-comment">--</span><span>
</span><a name="line-1585"></a><span class="hs-comment">-- * Not all systems support @utimensat@, in which case the function can only</span><span>
</span><a name="line-1586"></a><span class="hs-comment">--   emulate the behavior by reading the modification time and then setting</span><span>
</span><a name="line-1587"></a><span class="hs-comment">--   both the access and modification times together.  On systems where</span><span>
</span><a name="line-1588"></a><span class="hs-comment">--   @utimensat@ is supported, the access time is set atomically with</span><span>
</span><a name="line-1589"></a><span class="hs-comment">--   nanosecond precision.</span><span>
</span><a name="line-1590"></a><span class="hs-comment">--</span><span>
</span><a name="line-1591"></a><span class="hs-comment">-- * If compiled against a version of @unix@ prior to @2.7.0.0@, the function</span><span>
</span><a name="line-1592"></a><span class="hs-comment">--   would not be able to set timestamps with sub-second resolution.  In this</span><span>
</span><a name="line-1593"></a><span class="hs-comment">--   case, there would also be loss of precision in the modification time.</span><span>
</span><a name="line-1594"></a><span class="hs-comment">--</span><span>
</span><a name="line-1595"></a><span class="hs-comment">-- @since 1.2.3.0</span><span>
</span><a name="line-1596"></a><span class="hs-comment">--</span><span>
</span><a name="line-1597"></a><span class="hs-identifier">setAccessTime</span><span> </span><span class="hs-glyph">::</span><span> </span><a href="../base-4.10.0.0/src/%{MODULE/./-}.html#%{NAME}/GHC.IO.html#FilePath"><span class="hs-identifier hs-type">FilePath</span></a><span> </span><span class="hs-glyph">-&gt;</span><span> </span><a href="../time-1.8.0.1/src/%{MODULE/./-}.html#%{NAME}/Data.Time.Clock.Internal.UTCTime.html#UTCTime"><span class="hs-identifier hs-type">UTCTime</span></a><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="hs-identifier hs-type">IO</span><span> </span><span class="hs-special">(</span><span class="hs-special">)</span><span>
</span><a name="line-1598"></a><a name="setAccessTime"><a href="System.Directory.html#setAccessTime"><span class="hs-identifier">setAccessTime</span></a></a><span> </span><a name="local-6989586621679042754"><a href="#local-6989586621679042754"><span class="hs-identifier">path</span></a></a><span> </span><a name="local-6989586621679042755"><a href="#local-6989586621679042755"><span class="hs-identifier">atime</span></a></a><span> </span><span class="hs-glyph">=</span><span>
</span><a name="line-1599"></a><span>  </span><a href="../base-4.10.0.0/src/%{MODULE/./-}.html#%{NAME}/System.IO.Error.html#modifyIOError"><span class="hs-identifier hs-var">modifyIOError</span></a><span> </span><span class="hs-special">(</span><span class="hs-special">`</span><a href="System.Directory.html#ioeAddLocation"><span class="hs-identifier hs-var">ioeAddLocation</span></a><span class="hs-special">`</span><span> </span><span class="hs-string">&quot;setAccessTime&quot;</span><span class="hs-special">)</span><span> </span><a href="../base-4.10.0.0/src/%{MODULE/./-}.html#%{NAME}/GHC.Base.html#%24"><span class="hs-operator hs-var">$</span></a><span>
</span><a name="line-1600"></a><span>    </span><a href="System.Directory.html#setFileTimes"><span class="hs-identifier hs-var">setFileTimes</span></a><span> </span><a href="#local-6989586621679042754"><span class="hs-identifier hs-var">path</span></a><span> </span><span class="hs-special">(</span><a href="../base-4.10.0.0/src/%{MODULE/./-}.html#%{NAME}/GHC.Base.html#Just"><span class="hs-identifier hs-var">Just</span></a><span> </span><a href="#local-6989586621679042755"><span class="hs-identifier hs-var">atime</span></a><span class="hs-special">,</span><span> </span><a href="../base-4.10.0.0/src/%{MODULE/./-}.html#%{NAME}/GHC.Base.html#Nothing"><span class="hs-identifier hs-var">Nothing</span></a><span class="hs-special">)</span><span>
</span><a name="line-1601"></a><span>
</span><a name="line-1602"></a><span class="hs-comment">-- | Change the time at which the file or directory was last modified.</span><span>
</span><a name="line-1603"></a><span class="hs-comment">--</span><span>
</span><a name="line-1604"></a><span class="hs-comment">-- The operation may fail with:</span><span>
</span><a name="line-1605"></a><span class="hs-comment">--</span><span>
</span><a name="line-1606"></a><span class="hs-comment">-- * 'isPermissionError' if the user is not permitted to alter the</span><span>
</span><a name="line-1607"></a><span class="hs-comment">--   modification time; or</span><span>
</span><a name="line-1608"></a><span class="hs-comment">--</span><span>
</span><a name="line-1609"></a><span class="hs-comment">-- * 'isDoesNotExistError' if the file or directory does not exist.</span><span>
</span><a name="line-1610"></a><span class="hs-comment">--</span><span>
</span><a name="line-1611"></a><span class="hs-comment">-- Some caveats for POSIX systems:</span><span>
</span><a name="line-1612"></a><span class="hs-comment">--</span><span>
</span><a name="line-1613"></a><span class="hs-comment">-- * Not all systems support @utimensat@, in which case the function can only</span><span>
</span><a name="line-1614"></a><span class="hs-comment">--   emulate the behavior by reading the access time and then setting both the</span><span>
</span><a name="line-1615"></a><span class="hs-comment">--   access and modification times together.  On systems where @utimensat@ is</span><span>
</span><a name="line-1616"></a><span class="hs-comment">--   supported, the modification time is set atomically with nanosecond</span><span>
</span><a name="line-1617"></a><span class="hs-comment">--   precision.</span><span>
</span><a name="line-1618"></a><span class="hs-comment">--</span><span>
</span><a name="line-1619"></a><span class="hs-comment">-- * If compiled against a version of @unix@ prior to @2.7.0.0@, the function</span><span>
</span><a name="line-1620"></a><span class="hs-comment">--   would not be able to set timestamps with sub-second resolution.  In this</span><span>
</span><a name="line-1621"></a><span class="hs-comment">--   case, there would also be loss of precision in the access time.</span><span>
</span><a name="line-1622"></a><span class="hs-comment">--</span><span>
</span><a name="line-1623"></a><span class="hs-comment">-- @since 1.2.3.0</span><span>
</span><a name="line-1624"></a><span class="hs-comment">--</span><span>
</span><a name="line-1625"></a><span class="hs-identifier">setModificationTime</span><span> </span><span class="hs-glyph">::</span><span> </span><a href="../base-4.10.0.0/src/%{MODULE/./-}.html#%{NAME}/GHC.IO.html#FilePath"><span class="hs-identifier hs-type">FilePath</span></a><span> </span><span class="hs-glyph">-&gt;</span><span> </span><a href="../time-1.8.0.1/src/%{MODULE/./-}.html#%{NAME}/Data.Time.Clock.Internal.UTCTime.html#UTCTime"><span class="hs-identifier hs-type">UTCTime</span></a><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="hs-identifier hs-type">IO</span><span> </span><span class="hs-special">(</span><span class="hs-special">)</span><span>
</span><a name="line-1626"></a><a name="setModificationTime"><a href="System.Directory.html#setModificationTime"><span class="hs-identifier">setModificationTime</span></a></a><span> </span><a name="local-6989586621679042756"><a href="#local-6989586621679042756"><span class="hs-identifier">path</span></a></a><span> </span><a name="local-6989586621679042757"><a href="#local-6989586621679042757"><span class="hs-identifier">mtime</span></a></a><span> </span><span class="hs-glyph">=</span><span>
</span><a name="line-1627"></a><span>  </span><a href="../base-4.10.0.0/src/%{MODULE/./-}.html#%{NAME}/System.IO.Error.html#modifyIOError"><span class="hs-identifier hs-var">modifyIOError</span></a><span> </span><span class="hs-special">(</span><span class="hs-special">`</span><a href="System.Directory.html#ioeAddLocation"><span class="hs-identifier hs-var">ioeAddLocation</span></a><span class="hs-special">`</span><span> </span><span class="hs-string">&quot;setModificationTime&quot;</span><span class="hs-special">)</span><span> </span><a href="../base-4.10.0.0/src/%{MODULE/./-}.html#%{NAME}/GHC.Base.html#%24"><span class="hs-operator hs-var">$</span></a><span>
</span><a name="line-1628"></a><span>    </span><a href="System.Directory.html#setFileTimes"><span class="hs-identifier hs-var">setFileTimes</span></a><span> </span><a href="#local-6989586621679042756"><span class="hs-identifier hs-var">path</span></a><span> </span><span class="hs-special">(</span><a href="../base-4.10.0.0/src/%{MODULE/./-}.html#%{NAME}/GHC.Base.html#Nothing"><span class="hs-identifier hs-var">Nothing</span></a><span class="hs-special">,</span><span> </span><a href="../base-4.10.0.0/src/%{MODULE/./-}.html#%{NAME}/GHC.Base.html#Just"><span class="hs-identifier hs-var">Just</span></a><span> </span><a href="#local-6989586621679042757"><span class="hs-identifier hs-var">mtime</span></a><span class="hs-special">)</span><span>
</span><a name="line-1629"></a><span>
</span><a name="line-1630"></a><span class="hs-identifier">setFileTimes</span><span> </span><span class="hs-glyph">::</span><span> </span><a href="../base-4.10.0.0/src/%{MODULE/./-}.html#%{NAME}/GHC.IO.html#FilePath"><span class="hs-identifier hs-type">FilePath</span></a><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="hs-special">(</span><a href="../base-4.10.0.0/src/%{MODULE/./-}.html#%{NAME}/GHC.Base.html#Maybe"><span class="hs-identifier hs-type">Maybe</span></a><span> </span><a href="../time-1.8.0.1/src/%{MODULE/./-}.html#%{NAME}/Data.Time.Clock.Internal.UTCTime.html#UTCTime"><span class="hs-identifier hs-type">UTCTime</span></a><span class="hs-special">,</span><span> </span><a href="../base-4.10.0.0/src/%{MODULE/./-}.html#%{NAME}/GHC.Base.html#Maybe"><span class="hs-identifier hs-type">Maybe</span></a><span> </span><a href="../time-1.8.0.1/src/%{MODULE/./-}.html#%{NAME}/Data.Time.Clock.Internal.UTCTime.html#UTCTime"><span class="hs-identifier hs-type">UTCTime</span></a><span class="hs-special">)</span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="hs-identifier hs-type">IO</span><span> </span><span class="hs-special">(</span><span class="hs-special">)</span><span>
</span><a name="line-1631"></a><a name="setFileTimes"><a href="System.Directory.html#setFileTimes"><span class="hs-identifier">setFileTimes</span></a></a><span> </span><span class="hs-identifier">_</span><span> </span><span class="hs-special">(</span><a href="../base-4.10.0.0/src/%{MODULE/./-}.html#%{NAME}/GHC.Base.html#Nothing"><span class="hs-identifier hs-var">Nothing</span></a><span class="hs-special">,</span><span> </span><a href="../base-4.10.0.0/src/%{MODULE/./-}.html#%{NAME}/GHC.Base.html#Nothing"><span class="hs-identifier hs-var">Nothing</span></a><span class="hs-special">)</span><span> </span><span class="hs-glyph">=</span><span> </span><a href="../base-4.10.0.0/src/%{MODULE/./-}.html#%{NAME}/GHC.Base.html#return"><span class="hs-identifier hs-var">return</span></a><span> </span><span class="hs-special">(</span><span class="hs-special">)</span><span>
</span><a name="line-1632"></a><span class="hs-identifier">setFileTimes</span><span> </span><a name="local-6989586621679042758"><a href="#local-6989586621679042758"><span class="hs-identifier">path</span></a></a><span> </span><span class="hs-special">(</span><a name="local-6989586621679042759"><a href="#local-6989586621679042759"><span class="hs-identifier">atime</span></a></a><span class="hs-special">,</span><span> </span><a name="local-6989586621679042760"><a href="#local-6989586621679042760"><span class="hs-identifier">mtime</span></a></a><span class="hs-special">)</span><span> </span><span class="hs-glyph">=</span><span>
</span><a name="line-1633"></a><span>  </span><a href="../base-4.10.0.0/src/%{MODULE/./-}.html#%{NAME}/System.IO.Error.html#modifyIOError"><span class="hs-identifier hs-var">modifyIOError</span></a><span> </span><span class="hs-special">(</span><span class="hs-special">`</span><a href="System.Directory.html#ioeAddLocation"><span class="hs-identifier hs-var">ioeAddLocation</span></a><span class="hs-special">`</span><span> </span><span class="hs-string">&quot;setFileTimes&quot;</span><span class="hs-special">)</span><span> </span><a href="../base-4.10.0.0/src/%{MODULE/./-}.html#%{NAME}/GHC.Base.html#."><span class="hs-operator hs-var">.</span></a><span>
</span><a name="line-1634"></a><span>  </span><a href="../base-4.10.0.0/src/%{MODULE/./-}.html#%{NAME}/System.IO.Error.html#modifyIOError"><span class="hs-identifier hs-var">modifyIOError</span></a><span> </span><span class="hs-special">(</span><span class="hs-special">`</span><a href="../base-4.10.0.0/src/%{MODULE/./-}.html#%{NAME}/System.IO.Error.html#ioeSetFileName"><span class="hs-identifier hs-var">ioeSetFileName</span></a><span class="hs-special">`</span><span> </span><a href="#local-6989586621679042758"><span class="hs-identifier hs-var">path</span></a><span class="hs-special">)</span><span> </span><a href="../base-4.10.0.0/src/%{MODULE/./-}.html#%{NAME}/GHC.Base.html#%24"><span class="hs-operator hs-var">$</span></a><span>
</span><a name="line-1635"></a><span>    </span><a href="#local-6989586621679042762"><span class="hs-identifier hs-var">setTimes</span></a><span> </span><span class="hs-special">(</span><a href="../time-1.8.0.1/src/%{MODULE/./-}.html#%{NAME}/Data.Time.Clock.POSIX.html#utcTimeToPOSIXSeconds"><span class="hs-identifier hs-var">utcTimeToPOSIXSeconds</span></a><span> </span><a href="../base-4.10.0.0/src/%{MODULE/./-}.html#%{NAME}/Data.Functor.html#%3C%24%3E"><span class="hs-operator hs-var">&lt;$&gt;</span></a><span> </span><a href="#local-6989586621679042759"><span class="hs-identifier hs-var">atime</span></a><span class="hs-special">,</span><span> </span><a href="../time-1.8.0.1/src/%{MODULE/./-}.html#%{NAME}/Data.Time.Clock.POSIX.html#utcTimeToPOSIXSeconds"><span class="hs-identifier hs-var">utcTimeToPOSIXSeconds</span></a><span> </span><a href="../base-4.10.0.0/src/%{MODULE/./-}.html#%{NAME}/Data.Functor.html#%3C%24%3E"><span class="hs-operator hs-var">&lt;$&gt;</span></a><span> </span><a href="#local-6989586621679042760"><span class="hs-identifier hs-var">mtime</span></a><span class="hs-special">)</span><span>
</span><a name="line-1636"></a><span>  </span><span class="hs-keyword">where</span><span>
</span><a name="line-1637"></a><span>    </span><a name="local-6989586621679042761"><a href="#local-6989586621679042761"><span class="hs-identifier">path'</span></a></a><span> </span><span class="hs-glyph">=</span><span> </span><a href="../filepath-1.4.1.1/src/%{MODULE/./-}.html#%{NAME}/System.FilePath.Posix.html#normalise"><span class="hs-identifier hs-var">normalise</span></a><span> </span><a href="#local-6989586621679042758"><span class="hs-identifier hs-var">path</span></a><span>              </span><span class="hs-comment">-- handle empty paths</span><span>
</span><a name="line-1638"></a><span>
</span><a name="line-1639"></a><span>    </span><span class="hs-identifier">setTimes</span><span> </span><span class="hs-glyph">::</span><span> </span><span class="hs-special">(</span><a href="../base-4.10.0.0/src/%{MODULE/./-}.html#%{NAME}/GHC.Base.html#Maybe"><span class="hs-identifier hs-type">Maybe</span></a><span> </span><a href="../time-1.8.0.1/src/%{MODULE/./-}.html#%{NAME}/Data.Time.Clock.Internal.POSIXTime.html#POSIXTime"><span class="hs-identifier hs-type">POSIXTime</span></a><span class="hs-special">,</span><span> </span><a href="../base-4.10.0.0/src/%{MODULE/./-}.html#%{NAME}/GHC.Base.html#Maybe"><span class="hs-identifier hs-type">Maybe</span></a><span> </span><a href="../time-1.8.0.1/src/%{MODULE/./-}.html#%{NAME}/Data.Time.Clock.Internal.POSIXTime.html#POSIXTime"><span class="hs-identifier hs-type">POSIXTime</span></a><span class="hs-special">)</span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="hs-identifier hs-type">IO</span><span> </span><span class="hs-special">(</span><span class="hs-special">)</span><span>
</span><a name="line-1640"></a><span class="hs-cpp">#ifdef mingw32_HOST_OS</span><span>
</span><a name="line-1641"></a><span>    </span><span class="hs-identifier">setTimes</span><span> </span><span class="hs-special">(</span><span class="hs-identifier">atime'</span><span class="hs-special">,</span><span> </span><span class="hs-identifier">mtime'</span><span class="hs-special">)</span><span> </span><span class="hs-glyph">=</span><span>
</span><a name="line-1642"></a><span>      </span><span class="hs-identifier">bracket</span><span> </span><span class="hs-special">(</span><span class="hs-identifier">openFileHandle</span><span> </span><span class="hs-identifier">path'</span><span> </span><span class="hs-identifier">Win32</span><span class="hs-operator">.</span><span class="hs-identifier">gENERIC_WRITE</span><span class="hs-special">)</span><span>
</span><a name="line-1643"></a><span>              </span><span class="hs-identifier">Win32</span><span class="hs-operator">.</span><span class="hs-identifier">closeHandle</span><span> </span><span class="hs-operator">$</span><span> </span><span class="hs-glyph">\</span><span> </span><span class="hs-identifier">handle</span><span> </span><span class="hs-glyph">-&gt;</span><span>
</span><a name="line-1644"></a><span>      </span><span class="hs-identifier">maybeWith</span><span> </span><span class="hs-identifier">with</span><span> </span><span class="hs-special">(</span><span class="hs-identifier">posixToWindowsTime</span><span> </span><span class="hs-operator">&lt;$&gt;</span><span> </span><span class="hs-identifier">atime'</span><span class="hs-special">)</span><span> </span><span class="hs-operator">$</span><span> </span><span class="hs-glyph">\</span><span> </span><span class="hs-identifier">atime''</span><span> </span><span class="hs-glyph">-&gt;</span><span>
</span><a name="line-1645"></a><span>      </span><span class="hs-identifier">maybeWith</span><span> </span><span class="hs-identifier">with</span><span> </span><span class="hs-special">(</span><span class="hs-identifier">posixToWindowsTime</span><span> </span><span class="hs-operator">&lt;$&gt;</span><span> </span><span class="hs-identifier">mtime'</span><span class="hs-special">)</span><span> </span><span class="hs-operator">$</span><span> </span><span class="hs-glyph">\</span><span> </span><span class="hs-identifier">mtime''</span><span> </span><span class="hs-glyph">-&gt;</span><span>
</span><a name="line-1646"></a><span>      </span><span class="hs-identifier">Win32</span><span class="hs-operator">.</span><span class="hs-identifier">failIf_</span><span> </span><span class="hs-identifier">not</span><span> </span><span class="hs-string">&quot;&quot;</span><span> </span><span class="hs-operator">$</span><span>
</span><a name="line-1647"></a><span>        </span><span class="hs-identifier">Win32</span><span class="hs-operator">.</span><span class="hs-identifier">c_SetFileTime</span><span> </span><span class="hs-identifier">handle</span><span> </span><span class="hs-identifier">nullPtr</span><span> </span><span class="hs-identifier">atime''</span><span> </span><span class="hs-identifier">mtime''</span><span>
</span><a name="line-1648"></a><span class="hs-cpp">#elif defined HAVE_UTIMENSAT</span><span>
</span><a name="line-1649"></a><span>    </span><a name="local-6989586621679042762"><a href="#local-6989586621679042762"><span class="hs-identifier">setTimes</span></a></a><span> </span><span class="hs-special">(</span><a name="local-6989586621679042763"><a href="#local-6989586621679042763"><span class="hs-identifier">atime'</span></a></a><span class="hs-special">,</span><span> </span><a name="local-6989586621679042764"><a href="#local-6989586621679042764"><span class="hs-identifier">mtime'</span></a></a><span class="hs-special">)</span><span> </span><span class="hs-glyph">=</span><span>
</span><a name="line-1650"></a><span>      </span><a href="../base-4.10.0.0/src/%{MODULE/./-}.html#%{NAME}/System.Posix.Internals.html#withFilePath"><span class="hs-identifier hs-var">withFilePath</span></a><span> </span><a href="#local-6989586621679042761"><span class="hs-identifier hs-var">path'</span></a><span> </span><a href="../base-4.10.0.0/src/%{MODULE/./-}.html#%{NAME}/GHC.Base.html#%24"><span class="hs-operator hs-var">$</span></a><span> </span><span class="hs-glyph">\</span><span> </span><a name="local-6989586621679042765"><a href="#local-6989586621679042765"><span class="hs-identifier">path''</span></a></a><span> </span><span class="hs-glyph">-&gt;</span><span>
</span><a name="line-1651"></a><span>      </span><a href="../base-4.10.0.0/src/%{MODULE/./-}.html#%{NAME}/Foreign.Marshal.Array.html#withArray"><span class="hs-identifier hs-var">withArray</span></a><span> </span><span class="hs-special">[</span><span> </span><a href="../base-4.10.0.0/src/%{MODULE/./-}.html#%{NAME}/Data.Maybe.html#maybe"><span class="hs-identifier hs-var">maybe</span></a><span> </span><a href="System.Directory.Internal.C_utimensat.html#utimeOmit"><span class="hs-identifier hs-var">utimeOmit</span></a><span> </span><a href="System.Directory.Internal.C_utimensat.html#toCTimeSpec"><span class="hs-identifier hs-var">toCTimeSpec</span></a><span> </span><a href="#local-6989586621679042763"><span class="hs-identifier hs-var">atime'</span></a><span>
</span><a name="line-1652"></a><span>                </span><span class="hs-special">,</span><span> </span><a href="../base-4.10.0.0/src/%{MODULE/./-}.html#%{NAME}/Data.Maybe.html#maybe"><span class="hs-identifier hs-var">maybe</span></a><span> </span><a href="System.Directory.Internal.C_utimensat.html#utimeOmit"><span class="hs-identifier hs-var">utimeOmit</span></a><span> </span><a href="System.Directory.Internal.C_utimensat.html#toCTimeSpec"><span class="hs-identifier hs-var">toCTimeSpec</span></a><span> </span><a href="#local-6989586621679042764"><span class="hs-identifier hs-var">mtime'</span></a><span> </span><span class="hs-special">]</span><span> </span><a href="../base-4.10.0.0/src/%{MODULE/./-}.html#%{NAME}/GHC.Base.html#%24"><span class="hs-operator hs-var">$</span></a><span> </span><span class="hs-glyph">\</span><span> </span><a name="local-6989586621679042837"><a href="#local-6989586621679042837"><span class="hs-identifier">times</span></a></a><span> </span><span class="hs-glyph">-&gt;</span><span>
</span><a name="line-1653"></a><span>      </span><a href="../base-4.10.0.0/src/%{MODULE/./-}.html#%{NAME}/Foreign.C.Error.html#throwErrnoPathIfMinus1_"><span class="hs-identifier hs-var">throwErrnoPathIfMinus1_</span></a><span> </span><span class="hs-string">&quot;&quot;</span><span> </span><a href="#local-6989586621679042761"><span class="hs-identifier hs-var">path'</span></a><span> </span><a href="../base-4.10.0.0/src/%{MODULE/./-}.html#%{NAME}/GHC.Base.html#%24"><span class="hs-operator hs-var">$</span></a><span>
</span><a name="line-1654"></a><span>        </span><a href="System.Directory.Internal.C_utimensat.html#c_utimensat"><span class="hs-identifier hs-var">c_utimensat</span></a><span> </span><a href="System.Directory.Internal.C_utimensat.html#c_AT_FDCWD"><span class="hs-identifier hs-var">c_AT_FDCWD</span></a><span> </span><a href="#local-6989586621679042765"><span class="hs-identifier hs-var">path''</span></a><span> </span><a href="#local-6989586621679042837"><span class="hs-identifier hs-var">times</span></a><span> </span><span class="hs-number">0</span><span>
</span><a name="line-1655"></a><span class="hs-cpp">#else</span><span>
</span><a name="line-1656"></a><span>    </span><span class="hs-identifier">setTimes</span><span> </span><span class="hs-special">(</span><span class="hs-identifier">Just</span><span> </span><span class="hs-identifier">atime'</span><span class="hs-special">,</span><span> </span><span class="hs-identifier">Just</span><span> </span><span class="hs-identifier">mtime'</span><span class="hs-special">)</span><span> </span><span class="hs-glyph">=</span><span> </span><span class="hs-identifier">setFileTimes'</span><span> </span><span class="hs-identifier">path'</span><span> </span><span class="hs-identifier">atime'</span><span> </span><span class="hs-identifier">mtime'</span><span>
</span><a name="line-1657"></a><span>    </span><span class="hs-identifier">setTimes</span><span> </span><span class="hs-special">(</span><span class="hs-identifier">atime'</span><span class="hs-special">,</span><span> </span><span class="hs-identifier">mtime'</span><span class="hs-special">)</span><span> </span><span class="hs-glyph">=</span><span> </span><span class="hs-keyword">do</span><span>
</span><a name="line-1658"></a><span>      </span><span class="hs-special">(</span><span class="hs-identifier">atimeOld</span><span class="hs-special">,</span><span> </span><span class="hs-identifier">mtimeOld</span><span class="hs-special">)</span><span> </span><span class="hs-glyph">&lt;-</span><span> </span><span class="hs-identifier">fileTimesFromStatus</span><span> </span><span class="hs-operator">&lt;$&gt;</span><span> </span><span class="hs-identifier">Posix</span><span class="hs-operator">.</span><span class="hs-identifier">getFileStatus</span><span> </span><span class="hs-identifier">path'</span><span>
</span><a name="line-1659"></a><span>      </span><span class="hs-identifier">setFileTimes'</span><span> </span><span class="hs-identifier">path'</span><span>
</span><a name="line-1660"></a><span>        </span><span class="hs-special">(</span><span class="hs-identifier">fromMaybe</span><span> </span><span class="hs-special">(</span><span class="hs-identifier">utcTimeToPOSIXSeconds</span><span> </span><span class="hs-identifier">atimeOld</span><span class="hs-special">)</span><span> </span><span class="hs-identifier">atime'</span><span class="hs-special">)</span><span>
</span><a name="line-1661"></a><span>        </span><span class="hs-special">(</span><span class="hs-identifier">fromMaybe</span><span> </span><span class="hs-special">(</span><span class="hs-identifier">utcTimeToPOSIXSeconds</span><span> </span><span class="hs-identifier">mtimeOld</span><span class="hs-special">)</span><span> </span><span class="hs-identifier">mtime'</span><span class="hs-special">)</span><span>
</span><a name="line-1662"></a><span>
</span><a name="line-1663"></a><span>    </span><span class="hs-identifier">setFileTimes'</span><span> </span><span class="hs-glyph">::</span><span> </span><span class="hs-identifier">FilePath</span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="hs-identifier">POSIXTime</span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="hs-identifier">POSIXTime</span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="hs-identifier">IO</span><span> </span><span class="hs-special">(</span><span class="hs-special">)</span><span>
</span><a name="line-1664"></a><span class="hs-cpp"># if MIN_VERSION_unix(2, 7, 0)</span><span>
</span><a name="line-1665"></a><span>    </span><span class="hs-identifier">setFileTimes'</span><span> </span><span class="hs-glyph">=</span><span> </span><span class="hs-identifier">Posix</span><span class="hs-operator">.</span><span class="hs-identifier">setFileTimesHiRes</span><span>
</span><a name="line-1666"></a><span class="hs-cpp">#  else</span><span>
</span><a name="line-1667"></a><span>    </span><span class="hs-identifier">setFileTimes'</span><span> </span><span class="hs-identifier">pth</span><span> </span><span class="hs-identifier">atime'</span><span> </span><span class="hs-identifier">mtime'</span><span> </span><span class="hs-glyph">=</span><span>
</span><a name="line-1668"></a><span>      </span><span class="hs-identifier">Posix</span><span class="hs-operator">.</span><span class="hs-identifier">setFileTimes</span><span> </span><span class="hs-identifier">pth</span><span>
</span><a name="line-1669"></a><span>        </span><span class="hs-special">(</span><span class="hs-identifier">fromInteger</span><span> </span><span class="hs-special">(</span><span class="hs-identifier">truncate</span><span> </span><span class="hs-identifier">atime'</span><span class="hs-special">)</span><span class="hs-special">)</span><span>
</span><a name="line-1670"></a><span>        </span><span class="hs-special">(</span><span class="hs-identifier">fromInteger</span><span> </span><span class="hs-special">(</span><span class="hs-identifier">truncate</span><span> </span><span class="hs-identifier">mtime'</span><span class="hs-special">)</span><span class="hs-special">)</span><span>
</span><a name="line-1671"></a><span class="hs-cpp"># endif</span><span>
</span><a name="line-1672"></a><span class="hs-cpp">#endif</span><span>
</span><a name="line-1673"></a><span>
</span><a name="line-1674"></a><span class="hs-cpp">#ifdef mingw32_HOST_OS</span><span>
</span><a name="line-1675"></a><span class="hs-comment">-- | Difference between the Windows and POSIX epochs in units of 100ns.</span><span>
</span><a name="line-1676"></a><span class="hs-identifier">windowsPosixEpochDifference</span><span> </span><span class="hs-glyph">::</span><span> </span><span class="hs-identifier">Num</span><span> </span><span class="hs-identifier">a</span><span> </span><span class="hs-glyph">=&gt;</span><span> </span><span class="hs-identifier">a</span><span>
</span><a name="line-1677"></a><span class="hs-identifier">windowsPosixEpochDifference</span><span> </span><span class="hs-glyph">=</span><span> </span><span class="hs-number">116444736000000000</span><span>
</span><a name="line-1678"></a><span>
</span><a name="line-1679"></a><span class="hs-comment">-- | Convert from Windows time to POSIX time.</span><span>
</span><a name="line-1680"></a><span class="hs-identifier">windowsToPosixTime</span><span> </span><span class="hs-glyph">::</span><span> </span><span class="hs-identifier">Win32</span><span class="hs-operator">.</span><span class="hs-identifier">FILETIME</span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="hs-identifier">POSIXTime</span><span>
</span><a name="line-1681"></a><span class="hs-identifier">windowsToPosixTime</span><span> </span><span class="hs-special">(</span><span class="hs-identifier">Win32</span><span class="hs-operator">.</span><span class="hs-identifier">FILETIME</span><span> </span><span class="hs-identifier">t</span><span class="hs-special">)</span><span> </span><span class="hs-glyph">=</span><span>
</span><a name="line-1682"></a><span>  </span><span class="hs-special">(</span><span class="hs-identifier">fromIntegral</span><span> </span><span class="hs-identifier">t</span><span> </span><span class="hs-glyph">-</span><span> </span><span class="hs-identifier">windowsPosixEpochDifference</span><span class="hs-special">)</span><span> </span><span class="hs-operator">/</span><span> </span><span class="hs-number">10000000</span><span>
</span><a name="line-1683"></a><span>
</span><a name="line-1684"></a><span class="hs-comment">-- | Convert from POSIX time to Windows time.  This is lossy as Windows time</span><span>
</span><a name="line-1685"></a><span class="hs-comment">--   has a resolution of only 100ns.</span><span>
</span><a name="line-1686"></a><span class="hs-identifier">posixToWindowsTime</span><span> </span><span class="hs-glyph">::</span><span> </span><span class="hs-identifier">POSIXTime</span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="hs-identifier">Win32</span><span class="hs-operator">.</span><span class="hs-identifier">FILETIME</span><span>
</span><a name="line-1687"></a><span class="hs-identifier">posixToWindowsTime</span><span> </span><span class="hs-identifier">t</span><span> </span><span class="hs-glyph">=</span><span> </span><span class="hs-identifier">Win32</span><span class="hs-operator">.</span><span class="hs-identifier">FILETIME</span><span> </span><span class="hs-operator">$</span><span>
</span><a name="line-1688"></a><span>  </span><span class="hs-identifier">truncate</span><span> </span><span class="hs-special">(</span><span class="hs-identifier">t</span><span> </span><span class="hs-operator">*</span><span> </span><span class="hs-number">10000000</span><span> </span><span class="hs-operator">+</span><span> </span><span class="hs-identifier">windowsPosixEpochDifference</span><span class="hs-special">)</span><span>
</span><a name="line-1689"></a><span class="hs-cpp">#endif</span><span>
</span><a name="line-1690"></a><span>
</span><a name="line-1691"></a><span class="hs-cpp">#ifdef mingw32_HOST_OS</span><span>
</span><a name="line-1692"></a><span class="hs-identifier">withFileStatus</span><span> </span><span class="hs-glyph">::</span><span> </span><span class="hs-identifier">String</span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="hs-identifier">FilePath</span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="hs-special">(</span><span class="hs-identifier">Ptr</span><span> </span><span class="hs-identifier">CStat</span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="hs-identifier">IO</span><span> </span><span class="hs-identifier">a</span><span class="hs-special">)</span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="hs-identifier">IO</span><span> </span><span class="hs-identifier">a</span><span>
</span><a name="line-1693"></a><span class="hs-identifier">withFileStatus</span><span> </span><span class="hs-identifier">loc</span><span> </span><span class="hs-identifier">name</span><span> </span><span class="hs-identifier">f</span><span> </span><span class="hs-glyph">=</span><span> </span><span class="hs-keyword">do</span><span>
</span><a name="line-1694"></a><span>  </span><span class="hs-identifier">modifyIOError</span><span> </span><span class="hs-special">(</span><span class="hs-special">`</span><span class="hs-identifier">ioeSetFileName</span><span class="hs-special">`</span><span> </span><span class="hs-identifier">name</span><span class="hs-special">)</span><span> </span><span class="hs-operator">$</span><span>
</span><a name="line-1695"></a><span>    </span><span class="hs-identifier">allocaBytes</span><span> </span><span class="hs-identifier">sizeof_stat</span><span> </span><span class="hs-operator">$</span><span> </span><span class="hs-glyph">\</span><span class="hs-identifier">p</span><span> </span><span class="hs-glyph">-&gt;</span><span>
</span><a name="line-1696"></a><span>      </span><span class="hs-identifier">withFilePath</span><span> </span><span class="hs-special">(</span><span class="hs-identifier">fileNameEndClean</span><span> </span><span class="hs-identifier">name</span><span class="hs-special">)</span><span> </span><span class="hs-operator">$</span><span> </span><span class="hs-glyph">\</span><span class="hs-identifier">s</span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="hs-keyword">do</span><span>
</span><a name="line-1697"></a><span>        </span><span class="hs-identifier">throwErrnoIfMinus1Retry_</span><span> </span><span class="hs-identifier">loc</span><span> </span><span class="hs-special">(</span><span class="hs-identifier">c_stat</span><span> </span><span class="hs-identifier">s</span><span> </span><span class="hs-identifier">p</span><span class="hs-special">)</span><span>
</span><a name="line-1698"></a><span>        </span><span class="hs-identifier">f</span><span> </span><span class="hs-identifier">p</span><span>
</span><a name="line-1699"></a><span>
</span><a name="line-1700"></a><span class="hs-identifier">isDirectory</span><span> </span><span class="hs-glyph">::</span><span> </span><span class="hs-identifier">Ptr</span><span> </span><span class="hs-identifier">CStat</span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="hs-identifier">IO</span><span> </span><span class="hs-identifier">Bool</span><span>
</span><a name="line-1701"></a><span class="hs-identifier">isDirectory</span><span> </span><span class="hs-identifier">stat</span><span> </span><span class="hs-glyph">=</span><span> </span><span class="hs-keyword">do</span><span>
</span><a name="line-1702"></a><span>  </span><span class="hs-identifier">mode</span><span> </span><span class="hs-glyph">&lt;-</span><span> </span><span class="hs-identifier">st_mode</span><span> </span><span class="hs-identifier">stat</span><span>
</span><a name="line-1703"></a><span>  </span><span class="hs-identifier">return</span><span> </span><span class="hs-special">(</span><span class="hs-identifier">s_isdir</span><span> </span><span class="hs-identifier">mode</span><span class="hs-special">)</span><span>
</span><a name="line-1704"></a><span>
</span><a name="line-1705"></a><span class="hs-identifier">fileNameEndClean</span><span> </span><span class="hs-glyph">::</span><span> </span><span class="hs-identifier">String</span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="hs-identifier">String</span><span>
</span><a name="line-1706"></a><span class="hs-identifier">fileNameEndClean</span><span> </span><span class="hs-identifier">name</span><span> </span><span class="hs-glyph">=</span><span> </span><span class="hs-keyword">if</span><span> </span><span class="hs-identifier">isDrive</span><span> </span><span class="hs-identifier">name</span><span> </span><span class="hs-keyword">then</span><span> </span><span class="hs-identifier">addTrailingPathSeparator</span><span> </span><span class="hs-identifier">name</span><span>
</span><a name="line-1707"></a><span>                                        </span><span class="hs-keyword">else</span><span> </span><span class="hs-identifier">dropTrailingPathSeparator</span><span> </span><span class="hs-identifier">name</span><span>
</span><a name="line-1708"></a><span class="hs-cpp">#endif</span><span>
</span><a name="line-1709"></a><span>
</span><a name="line-1710"></a><span class="hs-comment">{- | Returns the current user's home directory.

The directory returned is expected to be writable by the current user,
but note that it isn't generally considered good practice to store
application-specific data here; use 'getXdgDirectory' or
'getAppUserDataDirectory' instead.

On Unix, 'getHomeDirectory' returns the value of the @HOME@
environment variable.  On Windows, the system is queried for a
suitable path; a typical path might be @C:\/Users\//\&lt;user\&gt;/@.

The operation may fail with:

* 'UnsupportedOperation'
The operating system has no notion of home directory.

* 'isDoesNotExistError'
The home directory for the current user does not exist, or
cannot be found.
-}</span><span>
</span><a name="line-1730"></a><span class="hs-identifier">getHomeDirectory</span><span> </span><span class="hs-glyph">::</span><span> </span><span class="hs-identifier hs-type">IO</span><span> </span><a href="../base-4.10.0.0/src/%{MODULE/./-}.html#%{NAME}/GHC.IO.html#FilePath"><span class="hs-identifier hs-type">FilePath</span></a><span>
</span><a name="line-1731"></a><a name="getHomeDirectory"><a href="System.Directory.html#getHomeDirectory"><span class="hs-identifier">getHomeDirectory</span></a></a><span> </span><span class="hs-glyph">=</span><span> </span><a href="../base-4.10.0.0/src/%{MODULE/./-}.html#%{NAME}/System.IO.Error.html#modifyIOError"><span class="hs-identifier hs-var">modifyIOError</span></a><span> </span><span class="hs-special">(</span><span class="hs-special">`</span><a href="System.Directory.html#ioeAddLocation"><span class="hs-identifier hs-var">ioeAddLocation</span></a><span class="hs-special">`</span><span> </span><span class="hs-string">&quot;getHomeDirectory&quot;</span><span class="hs-special">)</span><span> </span><a href="#local-6989586621679042838"><span class="hs-identifier hs-var">get</span></a><span>
</span><a name="line-1732"></a><span>  </span><span class="hs-keyword">where</span><span>
</span><a name="line-1733"></a><span class="hs-cpp">#if defined(mingw32_HOST_OS)</span><span>
</span><a name="line-1734"></a><span>    </span><span class="hs-identifier">get</span><span> </span><span class="hs-glyph">=</span><span> </span><span class="hs-identifier">getFolderPath</span><span> </span><span class="hs-identifier">Win32</span><span class="hs-operator">.</span><span class="hs-identifier">cSIDL_PROFILE</span><span> </span><span class="hs-special">`</span><span class="hs-identifier">catchIOError</span><span class="hs-special">`</span><span> </span><span class="hs-glyph">\</span><span> </span><span class="hs-identifier">_</span><span> </span><span class="hs-glyph">-&gt;</span><span>
</span><a name="line-1735"></a><span>          </span><span class="hs-identifier">getFolderPath</span><span> </span><span class="hs-identifier">Win32</span><span class="hs-operator">.</span><span class="hs-identifier">cSIDL_WINDOWS</span><span>
</span><a name="line-1736"></a><span>    </span><span class="hs-identifier">getFolderPath</span><span> </span><span class="hs-identifier">what</span><span> </span><span class="hs-glyph">=</span><span> </span><span class="hs-identifier">Win32</span><span class="hs-operator">.</span><span class="hs-identifier">sHGetFolderPath</span><span> </span><span class="hs-identifier">nullPtr</span><span> </span><span class="hs-identifier">what</span><span> </span><span class="hs-identifier">nullPtr</span><span> </span><span class="hs-number">0</span><span>
</span><a name="line-1737"></a><span class="hs-cpp">#else</span><span>
</span><a name="line-1738"></a><span>    </span><a name="local-6989586621679042838"><a href="#local-6989586621679042838"><span class="hs-identifier">get</span></a></a><span> </span><span class="hs-glyph">=</span><span> </span><a href="../base-4.10.0.0/src/%{MODULE/./-}.html#%{NAME}/System.Environment.html#getEnv"><span class="hs-identifier hs-var">getEnv</span></a><span> </span><span class="hs-string">&quot;HOME&quot;</span><span>
</span><a name="line-1739"></a><span class="hs-cpp">#endif</span><span>
</span><a name="line-1740"></a><span>
</span><a name="line-1741"></a><span class="hs-comment">-- | Special directories for storing user-specific application data,</span><span>
</span><a name="line-1742"></a><span class="hs-comment">--   configuration, and cache files, as specified by the</span><span>
</span><a name="line-1743"></a><span class="hs-comment">--   &lt;http://standards.freedesktop.org/basedir-spec/basedir-spec-latest.html XDG Base Directory Specification&gt;.</span><span>
</span><a name="line-1744"></a><span class="hs-comment">--</span><span>
</span><a name="line-1745"></a><span class="hs-comment">--   Note: On Windows, 'XdgData' and 'XdgConfig' map to the same directory.</span><span>
</span><a name="line-1746"></a><span class="hs-comment">--</span><span>
</span><a name="line-1747"></a><span class="hs-comment">--   @since 1.2.3.0</span><span>
</span><a name="line-1748"></a><span class="hs-keyword">data</span><span> </span><a name="XdgDirectory"><a href="System.Directory.html#XdgDirectory"><span class="hs-identifier">XdgDirectory</span></a></a><span>
</span><a name="line-1749"></a><span>  </span><span class="hs-glyph">=</span><span> </span><a name="XdgData"><a href="System.Directory.html#XdgData"><span class="hs-identifier">XdgData</span></a></a><span>
</span><a name="line-1750"></a><span>    </span><span class="hs-comment">-- ^ For data files (e.g. images).</span><span>
</span><a name="line-1751"></a><span>    </span><span class="hs-comment">--   Defaults to @~\/.local\/share@ and can be</span><span>
</span><a name="line-1752"></a><span>    </span><span class="hs-comment">--   overridden by the @XDG_DATA_HOME@ environment variable.</span><span>
</span><a name="line-1753"></a><span>    </span><span class="hs-comment">--   On Windows, it is @%APPDATA%@</span><span>
</span><a name="line-1754"></a><span>    </span><span class="hs-comment">--   (e.g. @C:\/Users\//\&lt;user\&gt;/\/AppData\/Roaming@).</span><span>
</span><a name="line-1755"></a><span>    </span><span class="hs-comment">--   Can be considered as the user-specific equivalent of @\/usr\/share@.</span><span>
</span><a name="line-1756"></a><span>  </span><span class="hs-glyph">|</span><span> </span><a name="XdgConfig"><a href="System.Directory.html#XdgConfig"><span class="hs-identifier">XdgConfig</span></a></a><span>
</span><a name="line-1757"></a><span>    </span><span class="hs-comment">-- ^ For configuration files.</span><span>
</span><a name="line-1758"></a><span>    </span><span class="hs-comment">--   Defaults to @~\/.config@ and can be</span><span>
</span><a name="line-1759"></a><span>    </span><span class="hs-comment">--   overridden by the @XDG_CONFIG_HOME@ environment variable.</span><span>
</span><a name="line-1760"></a><span>    </span><span class="hs-comment">--   On Windows, it is @%APPDATA%@</span><span>
</span><a name="line-1761"></a><span>    </span><span class="hs-comment">--   (e.g. @C:\/Users\//\&lt;user\&gt;/\/AppData\/Roaming@).</span><span>
</span><a name="line-1762"></a><span>    </span><span class="hs-comment">--   Can be considered as the user-specific equivalent of @\/etc@.</span><span>
</span><a name="line-1763"></a><span>  </span><span class="hs-glyph">|</span><span> </span><a name="XdgCache"><a href="System.Directory.html#XdgCache"><span class="hs-identifier">XdgCache</span></a></a><span>
</span><a name="line-1764"></a><span>    </span><span class="hs-comment">-- ^ For non-essential files (e.g. cache).</span><span>
</span><a name="line-1765"></a><span>    </span><span class="hs-comment">--   Defaults to @~\/.cache@ and can be</span><span>
</span><a name="line-1766"></a><span>    </span><span class="hs-comment">--   overridden by the @XDG_CACHE_HOME@ environment variable.</span><span>
</span><a name="line-1767"></a><span>    </span><span class="hs-comment">--   On Windows, it is @%LOCALAPPDATA%@</span><span>
</span><a name="line-1768"></a><span>    </span><span class="hs-comment">--   (e.g. @C:\/Users\//\&lt;user\&gt;/\/AppData\/Local@).</span><span>
</span><a name="line-1769"></a><span>    </span><span class="hs-comment">--   Can be considered as the user-specific equivalent of @\/var\/cache@.</span><span>
</span><a name="line-1770"></a><span>  </span><span class="hs-keyword">deriving</span><span> </span><span class="hs-special">(</span><a href="../base-4.10.0.0/src/%{MODULE/./-}.html#%{NAME}/GHC.Enum.html#Bounded"><span class="hs-identifier hs-type">Bounded</span></a><span class="hs-special">,</span><span> </span><a href="../base-4.10.0.0/src/%{MODULE/./-}.html#%{NAME}/GHC.Enum.html#Enum"><span class="hs-identifier hs-type">Enum</span></a><span class="hs-special">,</span><span> </span><span class="hs-identifier hs-type">Eq</span><span class="hs-special">,</span><span> </span><span class="hs-identifier hs-type">Ord</span><span class="hs-special">,</span><span> </span><a href="../base-4.10.0.0/src/%{MODULE/./-}.html#%{NAME}/GHC.Read.html#Read"><span class="hs-identifier hs-type">Read</span></a><span class="hs-special">,</span><span> </span><a href="../base-4.10.0.0/src/%{MODULE/./-}.html#%{NAME}/GHC.Show.html#Show"><span class="hs-identifier hs-type">Show</span></a><span class="hs-special">)</span><span>
</span><a name="line-1771"></a><span>
</span><a name="line-1772"></a><span class="hs-comment">-- | Obtain the paths to special directories for storing user-specific</span><span>
</span><a name="line-1773"></a><span class="hs-comment">--   application data, configuration, and cache files, conforming to the</span><span>
</span><a name="line-1774"></a><span class="hs-comment">--   &lt;http://standards.freedesktop.org/basedir-spec/basedir-spec-latest.html XDG Base Directory Specification&gt;.</span><span>
</span><a name="line-1775"></a><span class="hs-comment">--   Compared with 'getAppUserDataDirectory', this function provides a more</span><span>
</span><a name="line-1776"></a><span class="hs-comment">--   fine-grained hierarchy as well as greater flexibility for the user.</span><span>
</span><a name="line-1777"></a><span class="hs-comment">--</span><span>
</span><a name="line-1778"></a><span class="hs-comment">--   It also works on Windows, although in that case 'XdgData' and 'XdgConfig'</span><span>
</span><a name="line-1779"></a><span class="hs-comment">--   will map to the same directory.</span><span>
</span><a name="line-1780"></a><span class="hs-comment">--</span><span>
</span><a name="line-1781"></a><span class="hs-comment">--   The second argument is usually the name of the application.  Since it</span><span>
</span><a name="line-1782"></a><span class="hs-comment">--   will be integrated into the path, it must consist of valid path</span><span>
</span><a name="line-1783"></a><span class="hs-comment">--   characters.</span><span>
</span><a name="line-1784"></a><span class="hs-comment">--</span><span>
</span><a name="line-1785"></a><span class="hs-comment">--   Note: The directory may not actually exist, in which case you would need</span><span>
</span><a name="line-1786"></a><span class="hs-comment">--   to create it with file mode @700@ (i.e. only accessible by the owner).</span><span>
</span><a name="line-1787"></a><span class="hs-comment">--</span><span>
</span><a name="line-1788"></a><span class="hs-comment">--   @since 1.2.3.0</span><span>
</span><a name="line-1789"></a><span class="hs-identifier">getXdgDirectory</span><span> </span><span class="hs-glyph">::</span><span> </span><a href="System.Directory.html#XdgDirectory"><span class="hs-identifier hs-type">XdgDirectory</span></a><span>         </span><span class="hs-comment">-- ^ which special directory</span><span>
</span><a name="line-1790"></a><span>                </span><span class="hs-glyph">-&gt;</span><span> </span><a href="../base-4.10.0.0/src/%{MODULE/./-}.html#%{NAME}/GHC.IO.html#FilePath"><span class="hs-identifier hs-type">FilePath</span></a><span>             </span><span class="hs-comment">-- ^ a relative path that is appended</span><span>
</span><a name="line-1791"></a><span>                                        </span><span class="hs-comment">--   to the path; if empty, the base</span><span>
</span><a name="line-1792"></a><span>                                        </span><span class="hs-comment">--   path is returned</span><span>
</span><a name="line-1793"></a><span>                </span><span class="hs-glyph">-&gt;</span><span> </span><span class="hs-identifier hs-type">IO</span><span> </span><a href="../base-4.10.0.0/src/%{MODULE/./-}.html#%{NAME}/GHC.IO.html#FilePath"><span class="hs-identifier hs-type">FilePath</span></a><span>
</span><a name="line-1794"></a><a name="getXdgDirectory"><a href="System.Directory.html#getXdgDirectory"><span class="hs-identifier">getXdgDirectory</span></a></a><span> </span><a name="local-6989586621679042839"><a href="#local-6989586621679042839"><span class="hs-identifier">xdgDir</span></a></a><span> </span><a name="local-6989586621679042840"><a href="#local-6989586621679042840"><span class="hs-identifier">suffix</span></a></a><span> </span><span class="hs-glyph">=</span><span>
</span><a name="line-1795"></a><span>  </span><a href="../base-4.10.0.0/src/%{MODULE/./-}.html#%{NAME}/System.IO.Error.html#modifyIOError"><span class="hs-identifier hs-var">modifyIOError</span></a><span> </span><span class="hs-special">(</span><span class="hs-special">`</span><a href="System.Directory.html#ioeAddLocation"><span class="hs-identifier hs-var">ioeAddLocation</span></a><span class="hs-special">`</span><span> </span><span class="hs-string">&quot;getXdgDirectory&quot;</span><span class="hs-special">)</span><span> </span><a href="../base-4.10.0.0/src/%{MODULE/./-}.html#%{NAME}/GHC.Base.html#%24"><span class="hs-operator hs-var">$</span></a><span>
</span><a name="line-1796"></a><span>  </span><a href="../filepath-1.4.1.1/src/%{MODULE/./-}.html#%{NAME}/System.FilePath.Posix.html#normalise"><span class="hs-identifier hs-var">normalise</span></a><span> </span><a href="../base-4.10.0.0/src/%{MODULE/./-}.html#%{NAME}/GHC.Base.html#."><span class="hs-operator hs-var">.</span></a><span> </span><span class="hs-special">(</span><a href="../filepath-1.4.1.1/src/%{MODULE/./-}.html#%{NAME}/System.FilePath.Posix.html#%3C%2F%3E"><span class="hs-operator hs-var">&lt;/&gt;</span></a><span> </span><a href="#local-6989586621679042840"><span class="hs-identifier hs-var">suffix</span></a><span class="hs-special">)</span><span> </span><a href="../base-4.10.0.0/src/%{MODULE/./-}.html#%{NAME}/Data.Functor.html#%3C%24%3E"><span class="hs-operator hs-var">&lt;$&gt;</span></a><span>
</span><a name="line-1797"></a><span>  </span><span class="hs-keyword">case</span><span> </span><a href="#local-6989586621679042839"><span class="hs-identifier hs-var">xdgDir</span></a><span> </span><span class="hs-keyword">of</span><span>
</span><a name="line-1798"></a><span>    </span><a href="System.Directory.html#XdgData"><span class="hs-identifier hs-var">XdgData</span></a><span>   </span><span class="hs-glyph">-&gt;</span><span> </span><a href="#local-6989586621679042841"><span class="hs-identifier hs-var">get</span></a><span> </span><span class="hs-identifier hs-var">False</span><span> </span><span class="hs-string">&quot;XDG_DATA_HOME&quot;</span><span>   </span><span class="hs-string">&quot;.local/share&quot;</span><span>
</span><a name="line-1799"></a><span>    </span><a href="System.Directory.html#XdgConfig"><span class="hs-identifier hs-var">XdgConfig</span></a><span> </span><span class="hs-glyph">-&gt;</span><span> </span><a href="#local-6989586621679042841"><span class="hs-identifier hs-var">get</span></a><span> </span><span class="hs-identifier hs-var">False</span><span> </span><span class="hs-string">&quot;XDG_CONFIG_HOME&quot;</span><span> </span><span class="hs-string">&quot;.config&quot;</span><span>
</span><a name="line-1800"></a><span>    </span><a href="System.Directory.html#XdgCache"><span class="hs-identifier hs-var">XdgCache</span></a><span>  </span><span class="hs-glyph">-&gt;</span><span> </span><a href="#local-6989586621679042841"><span class="hs-identifier hs-var">get</span></a><span> </span><span class="hs-identifier hs-var">True</span><span>  </span><span class="hs-string">&quot;XDG_CACHE_HOME&quot;</span><span>  </span><span class="hs-string">&quot;.cache&quot;</span><span>
</span><a name="line-1801"></a><span>  </span><span class="hs-keyword">where</span><span>
</span><a name="line-1802"></a><span class="hs-cpp">#if defined(mingw32_HOST_OS)</span><span>
</span><a name="line-1803"></a><span>    </span><span class="hs-identifier">get</span><span> </span><span class="hs-identifier">isLocal</span><span> </span><span class="hs-identifier">_</span><span> </span><span class="hs-identifier">_</span><span> </span><span class="hs-glyph">=</span><span> </span><span class="hs-identifier">Win32</span><span class="hs-operator">.</span><span class="hs-identifier">sHGetFolderPath</span><span> </span><span class="hs-identifier">nullPtr</span><span> </span><span class="hs-identifier">which</span><span> </span><span class="hs-identifier">nullPtr</span><span> </span><span class="hs-number">0</span><span>
</span><a name="line-1804"></a><span>      </span><span class="hs-keyword">where</span><span> </span><span class="hs-identifier">which</span><span> </span><span class="hs-glyph">|</span><span> </span><span class="hs-identifier">isLocal</span><span>   </span><span class="hs-glyph">=</span><span> </span><span class="hs-identifier">win32_cSIDL_LOCAL_APPDATA</span><span>
</span><a name="line-1805"></a><span>                  </span><span class="hs-glyph">|</span><span> </span><span class="hs-identifier">otherwise</span><span> </span><span class="hs-glyph">=</span><span> </span><span class="hs-identifier">Win32</span><span class="hs-operator">.</span><span class="hs-identifier">cSIDL_APPDATA</span><span>
</span><a name="line-1806"></a><span class="hs-cpp">#else</span><span>
</span><a name="line-1807"></a><span>    </span><a name="local-6989586621679042841"><a href="#local-6989586621679042841"><span class="hs-identifier">get</span></a></a><span> </span><span class="hs-identifier">_</span><span> </span><a name="local-6989586621679042842"><a href="#local-6989586621679042842"><span class="hs-identifier">name</span></a></a><span> </span><a name="local-6989586621679042843"><a href="#local-6989586621679042843"><span class="hs-identifier">fallback</span></a></a><span> </span><span class="hs-glyph">=</span><span> </span><span class="hs-keyword">do</span><span>
</span><a name="line-1808"></a><span>      </span><a name="local-6989586621679042845"><a href="#local-6989586621679042845"><span class="hs-identifier">env</span></a></a><span> </span><span class="hs-glyph">&lt;-</span><span> </span><a href="System.Directory.html#lookupEnv"><span class="hs-identifier hs-var">lookupEnv</span></a><span> </span><a href="#local-6989586621679042842"><span class="hs-identifier hs-var">name</span></a><span>
</span><a name="line-1809"></a><span>      </span><span class="hs-keyword">case</span><span> </span><a href="#local-6989586621679042845"><span class="hs-identifier hs-var">env</span></a><span> </span><span class="hs-keyword">of</span><span>
</span><a name="line-1810"></a><span>        </span><a href="../base-4.10.0.0/src/%{MODULE/./-}.html#%{NAME}/GHC.Base.html#Nothing"><span class="hs-identifier hs-var">Nothing</span></a><span>                     </span><span class="hs-glyph">-&gt;</span><span> </span><a href="#local-6989586621679042844"><span class="hs-identifier hs-var">fallback'</span></a><span>
</span><a name="line-1811"></a><span>        </span><a href="../base-4.10.0.0/src/%{MODULE/./-}.html#%{NAME}/GHC.Base.html#Just"><span class="hs-identifier hs-var">Just</span></a><span> </span><a name="local-6989586621679042846"><a href="#local-6989586621679042846"><span class="hs-identifier">path</span></a></a><span> </span><span class="hs-glyph">|</span><span> </span><a href="../filepath-1.4.1.1/src/%{MODULE/./-}.html#%{NAME}/System.FilePath.Posix.html#isRelative"><span class="hs-identifier hs-var">isRelative</span></a><span> </span><a href="#local-6989586621679042846"><span class="hs-identifier hs-var">path</span></a><span> </span><span class="hs-glyph">-&gt;</span><span> </span><a href="#local-6989586621679042844"><span class="hs-identifier hs-var">fallback'</span></a><span>
</span><a name="line-1812"></a><span>                  </span><span class="hs-glyph">|</span><span> </span><a href="../base-4.10.0.0/src/%{MODULE/./-}.html#%{NAME}/GHC.Base.html#otherwise"><span class="hs-identifier hs-var">otherwise</span></a><span>       </span><span class="hs-glyph">-&gt;</span><span> </span><a href="../base-4.10.0.0/src/%{MODULE/./-}.html#%{NAME}/GHC.Base.html#return"><span class="hs-identifier hs-var">return</span></a><span> </span><a href="#local-6989586621679042846"><span class="hs-identifier hs-var">path</span></a><span>
</span><a name="line-1813"></a><span>      </span><span class="hs-keyword">where</span><span> </span><a name="local-6989586621679042844"><a href="#local-6989586621679042844"><span class="hs-identifier">fallback'</span></a></a><span> </span><span class="hs-glyph">=</span><span> </span><span class="hs-special">(</span><a href="../filepath-1.4.1.1/src/%{MODULE/./-}.html#%{NAME}/System.FilePath.Posix.html#%3C%2F%3E"><span class="hs-operator hs-var">&lt;/&gt;</span></a><span> </span><a href="#local-6989586621679042843"><span class="hs-identifier hs-var">fallback</span></a><span class="hs-special">)</span><span> </span><a href="../base-4.10.0.0/src/%{MODULE/./-}.html#%{NAME}/Data.Functor.html#%3C%24%3E"><span class="hs-operator hs-var">&lt;$&gt;</span></a><span> </span><a href="System.Directory.html#getHomeDirectory"><span class="hs-identifier hs-var">getHomeDirectory</span></a><span>
</span><a name="line-1814"></a><span>
</span><a name="line-1815"></a><span class="hs-comment">-- | Return the value of an environment variable, or 'Nothing' if there is no</span><span>
</span><a name="line-1816"></a><span class="hs-comment">--   such value.  (Equivalent to &quot;lookupEnv&quot; from base-4.6.)</span><span>
</span><a name="line-1817"></a><span class="hs-identifier">lookupEnv</span><span> </span><span class="hs-glyph">::</span><span> </span><a href="../base-4.10.0.0/src/%{MODULE/./-}.html#%{NAME}/GHC.Base.html#String"><span class="hs-identifier hs-type">String</span></a><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="hs-identifier hs-type">IO</span><span> </span><span class="hs-special">(</span><a href="../base-4.10.0.0/src/%{MODULE/./-}.html#%{NAME}/GHC.Base.html#Maybe"><span class="hs-identifier hs-type">Maybe</span></a><span> </span><a href="../base-4.10.0.0/src/%{MODULE/./-}.html#%{NAME}/GHC.Base.html#String"><span class="hs-identifier hs-type">String</span></a><span class="hs-special">)</span><span>
</span><a name="line-1818"></a><a name="lookupEnv"><a href="System.Directory.html#lookupEnv"><span class="hs-identifier">lookupEnv</span></a></a><span> </span><a name="local-6989586621679042847"><a href="#local-6989586621679042847"><span class="hs-identifier">name</span></a></a><span> </span><span class="hs-glyph">=</span><span> </span><span class="hs-keyword">do</span><span>
</span><a name="line-1819"></a><span>  </span><a name="local-6989586621679042848"><a href="#local-6989586621679042848"><span class="hs-identifier">env</span></a></a><span> </span><span class="hs-glyph">&lt;-</span><span> </span><a href="System.Directory.html#tryIOErrorType"><span class="hs-identifier hs-var">tryIOErrorType</span></a><span> </span><a href="../base-4.10.0.0/src/%{MODULE/./-}.html#%{NAME}/System.IO.Error.html#isDoesNotExistError"><span class="hs-identifier hs-var">isDoesNotExistError</span></a><span> </span><span class="hs-special">(</span><a href="../base-4.10.0.0/src/%{MODULE/./-}.html#%{NAME}/System.Environment.html#getEnv"><span class="hs-identifier hs-var">getEnv</span></a><span> </span><a href="#local-6989586621679042847"><span class="hs-identifier hs-var">name</span></a><span class="hs-special">)</span><span>
</span><a name="line-1820"></a><span>  </span><span class="hs-keyword">case</span><span> </span><a href="#local-6989586621679042848"><span class="hs-identifier hs-var">env</span></a><span> </span><span class="hs-keyword">of</span><span>
</span><a name="line-1821"></a><span>    </span><a href="../base-4.10.0.0/src/%{MODULE/./-}.html#%{NAME}/Data.Either.html#Left"><span class="hs-identifier hs-var">Left</span></a><span>  </span><span class="hs-identifier">_</span><span>     </span><span class="hs-glyph">-&gt;</span><span> </span><a href="../base-4.10.0.0/src/%{MODULE/./-}.html#%{NAME}/GHC.Base.html#return"><span class="hs-identifier hs-var">return</span></a><span> </span><a href="../base-4.10.0.0/src/%{MODULE/./-}.html#%{NAME}/GHC.Base.html#Nothing"><span class="hs-identifier hs-var">Nothing</span></a><span>
</span><a name="line-1822"></a><span>    </span><a href="../base-4.10.0.0/src/%{MODULE/./-}.html#%{NAME}/Data.Either.html#Right"><span class="hs-identifier hs-var">Right</span></a><span> </span><a name="local-6989586621679042849"><a href="#local-6989586621679042849"><span class="hs-identifier">value</span></a></a><span> </span><span class="hs-glyph">-&gt;</span><span> </span><a href="../base-4.10.0.0/src/%{MODULE/./-}.html#%{NAME}/GHC.Base.html#return"><span class="hs-identifier hs-var">return</span></a><span> </span><span class="hs-special">(</span><a href="../base-4.10.0.0/src/%{MODULE/./-}.html#%{NAME}/GHC.Base.html#Just"><span class="hs-identifier hs-var">Just</span></a><span> </span><a href="#local-6989586621679042849"><span class="hs-identifier hs-var">value</span></a><span class="hs-special">)</span><span>
</span><a name="line-1823"></a><span class="hs-cpp">#endif</span><span>
</span><a name="line-1824"></a><span>
</span><a name="line-1825"></a><span class="hs-comment">-- | Similar to 'try' but only catches a specify kind of 'IOError' as</span><span>
</span><a name="line-1826"></a><span class="hs-comment">--   specified by the predicate.</span><span>
</span><a name="line-1827"></a><span class="hs-identifier">tryIOErrorType</span><span> </span><span class="hs-glyph">::</span><span> </span><span class="hs-special">(</span><a href="../base-4.10.0.0/src/%{MODULE/./-}.html#%{NAME}/GHC.IO.Exception.html#IOError"><span class="hs-identifier hs-type">IOError</span></a><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="hs-identifier hs-type">Bool</span><span class="hs-special">)</span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="hs-identifier hs-type">IO</span><span> </span><a href="#local-6989586621679040121"><span class="hs-identifier hs-type">a</span></a><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="hs-identifier hs-type">IO</span><span> </span><span class="hs-special">(</span><a href="../base-4.10.0.0/src/%{MODULE/./-}.html#%{NAME}/Data.Either.html#Either"><span class="hs-identifier hs-type">Either</span></a><span> </span><a href="../base-4.10.0.0/src/%{MODULE/./-}.html#%{NAME}/GHC.IO.Exception.html#IOError"><span class="hs-identifier hs-type">IOError</span></a><span> </span><a href="#local-6989586621679040121"><span class="hs-identifier hs-type">a</span></a><span class="hs-special">)</span><span>
</span><a name="line-1828"></a><a name="tryIOErrorType"><a href="System.Directory.html#tryIOErrorType"><span class="hs-identifier">tryIOErrorType</span></a></a><span> </span><a name="local-6989586621679042850"><a href="#local-6989586621679042850"><span class="hs-identifier">check</span></a></a><span> </span><a name="local-6989586621679042851"><a href="#local-6989586621679042851"><span class="hs-identifier">action</span></a></a><span> </span><span class="hs-glyph">=</span><span> </span><span class="hs-keyword">do</span><span>
</span><a name="line-1829"></a><span>  </span><a name="local-6989586621679042852"><a href="#local-6989586621679042852"><span class="hs-identifier">result</span></a></a><span> </span><span class="hs-glyph">&lt;-</span><span> </span><a href="../base-4.10.0.0/src/%{MODULE/./-}.html#%{NAME}/System.IO.Error.html#tryIOError"><span class="hs-identifier hs-var">tryIOError</span></a><span> </span><a href="#local-6989586621679042851"><span class="hs-identifier hs-var">action</span></a><span>
</span><a name="line-1830"></a><span>  </span><span class="hs-keyword">case</span><span> </span><a href="#local-6989586621679042852"><span class="hs-identifier hs-var">result</span></a><span> </span><span class="hs-keyword">of</span><span>
</span><a name="line-1831"></a><span>    </span><a href="../base-4.10.0.0/src/%{MODULE/./-}.html#%{NAME}/Data.Either.html#Left"><span class="hs-identifier hs-var">Left</span></a><span>  </span><a name="local-6989586621679042853"><a href="#local-6989586621679042853"><span class="hs-identifier">err</span></a></a><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="hs-keyword">if</span><span> </span><a href="#local-6989586621679042850"><span class="hs-identifier hs-var">check</span></a><span> </span><a href="#local-6989586621679042853"><span class="hs-identifier hs-var">err</span></a><span> </span><span class="hs-keyword">then</span><span> </span><a href="../base-4.10.0.0/src/%{MODULE/./-}.html#%{NAME}/GHC.Base.html#return"><span class="hs-identifier hs-var">return</span></a><span> </span><span class="hs-special">(</span><a href="../base-4.10.0.0/src/%{MODULE/./-}.html#%{NAME}/Data.Either.html#Left"><span class="hs-identifier hs-var">Left</span></a><span> </span><a href="#local-6989586621679042853"><span class="hs-identifier hs-var">err</span></a><span class="hs-special">)</span><span> </span><span class="hs-keyword">else</span><span> </span><a href="../base-4.10.0.0/src/%{MODULE/./-}.html#%{NAME}/GHC.IO.Exception.html#ioError"><span class="hs-identifier hs-var">ioError</span></a><span> </span><a href="#local-6989586621679042853"><span class="hs-identifier hs-var">err</span></a><span>
</span><a name="line-1832"></a><span>    </span><a href="../base-4.10.0.0/src/%{MODULE/./-}.html#%{NAME}/Data.Either.html#Right"><span class="hs-identifier hs-var">Right</span></a><span> </span><a name="local-6989586621679042854"><a href="#local-6989586621679042854"><span class="hs-identifier">val</span></a></a><span> </span><span class="hs-glyph">-&gt;</span><span> </span><a href="../base-4.10.0.0/src/%{MODULE/./-}.html#%{NAME}/GHC.Base.html#return"><span class="hs-identifier hs-var">return</span></a><span> </span><span class="hs-special">(</span><a href="../base-4.10.0.0/src/%{MODULE/./-}.html#%{NAME}/Data.Either.html#Right"><span class="hs-identifier hs-var">Right</span></a><span> </span><a href="#local-6989586621679042854"><span class="hs-identifier hs-var">val</span></a><span class="hs-special">)</span><span>
</span><a name="line-1833"></a><span>
</span><a name="line-1834"></a><span class="hs-identifier">specializeErrorString</span><span> </span><span class="hs-glyph">::</span><span> </span><a href="../base-4.10.0.0/src/%{MODULE/./-}.html#%{NAME}/GHC.Base.html#String"><span class="hs-identifier hs-type">String</span></a><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="hs-special">(</span><a href="../base-4.10.0.0/src/%{MODULE/./-}.html#%{NAME}/GHC.IO.Exception.html#IOError"><span class="hs-identifier hs-type">IOError</span></a><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="hs-identifier hs-type">Bool</span><span class="hs-special">)</span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="hs-identifier hs-type">IO</span><span> </span><a href="#local-6989586621679040120"><span class="hs-identifier hs-type">a</span></a><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="hs-identifier hs-type">IO</span><span> </span><a href="#local-6989586621679040120"><span class="hs-identifier hs-type">a</span></a><span>
</span><a name="line-1835"></a><a name="specializeErrorString"><a href="System.Directory.html#specializeErrorString"><span class="hs-identifier">specializeErrorString</span></a></a><span> </span><a name="local-6989586621679042855"><a href="#local-6989586621679042855"><span class="hs-identifier">str</span></a></a><span> </span><a name="local-6989586621679042856"><a href="#local-6989586621679042856"><span class="hs-identifier">errType</span></a></a><span> </span><a name="local-6989586621679042857"><a href="#local-6989586621679042857"><span class="hs-identifier">action</span></a></a><span> </span><span class="hs-glyph">=</span><span> </span><span class="hs-keyword">do</span><span>
</span><a name="line-1836"></a><span>  </span><a name="local-6989586621679042858"><a href="#local-6989586621679042858"><span class="hs-identifier">mx</span></a></a><span> </span><span class="hs-glyph">&lt;-</span><span> </span><a href="System.Directory.html#tryIOErrorType"><span class="hs-identifier hs-var">tryIOErrorType</span></a><span> </span><a href="#local-6989586621679042856"><span class="hs-identifier hs-var">errType</span></a><span> </span><a href="#local-6989586621679042857"><span class="hs-identifier hs-var">action</span></a><span>
</span><a name="line-1837"></a><span>  </span><span class="hs-keyword">case</span><span> </span><a href="#local-6989586621679042858"><span class="hs-identifier hs-var">mx</span></a><span> </span><span class="hs-keyword">of</span><span>
</span><a name="line-1838"></a><span>    </span><a href="../base-4.10.0.0/src/%{MODULE/./-}.html#%{NAME}/Data.Either.html#Left"><span class="hs-identifier hs-var">Left</span></a><span>  </span><a name="local-6989586621679042859"><a href="#local-6989586621679042859"><span class="hs-identifier">e</span></a></a><span> </span><span class="hs-glyph">-&gt;</span><span> </span><a href="../base-4.10.0.0/src/%{MODULE/./-}.html#%{NAME}/GHC.IO.Exception.html#ioError"><span class="hs-identifier hs-var">ioError</span></a><span> </span><span class="hs-special">(</span><a href="../base-4.10.0.0/src/%{MODULE/./-}.html#%{NAME}/System.IO.Error.html#ioeSetErrorString"><span class="hs-identifier hs-var">ioeSetErrorString</span></a><span> </span><a href="#local-6989586621679042859"><span class="hs-identifier hs-var">e</span></a><span> </span><a href="#local-6989586621679042855"><span class="hs-identifier hs-var">str</span></a><span class="hs-special">)</span><span>
</span><a name="line-1839"></a><span>    </span><a href="../base-4.10.0.0/src/%{MODULE/./-}.html#%{NAME}/Data.Either.html#Right"><span class="hs-identifier hs-var">Right</span></a><span> </span><a name="local-6989586621679042860"><a href="#local-6989586621679042860"><span class="hs-identifier">x</span></a></a><span> </span><span class="hs-glyph">-&gt;</span><span> </span><a href="../base-4.10.0.0/src/%{MODULE/./-}.html#%{NAME}/GHC.Base.html#return"><span class="hs-identifier hs-var">return</span></a><span> </span><a href="#local-6989586621679042860"><span class="hs-identifier hs-var">x</span></a><span>
</span><a name="line-1840"></a><span>
</span><a name="line-1841"></a><span class="hs-comment">-- | Obtain the path to a special directory for storing user-specific</span><span>
</span><a name="line-1842"></a><span class="hs-comment">--   application data (traditional Unix location).  Newer applications may</span><span>
</span><a name="line-1843"></a><span class="hs-comment">--   prefer the the XDG-conformant location provided by 'getXdgDirectory'</span><span>
</span><a name="line-1844"></a><span class="hs-comment">--   (&lt;https://github.com/haskell/directory/issues/6#issuecomment-96521020 migration guide&gt;).</span><span>
</span><a name="line-1845"></a><span class="hs-comment">--</span><span>
</span><a name="line-1846"></a><span class="hs-comment">--   The argument is usually the name of the application.  Since it will be</span><span>
</span><a name="line-1847"></a><span class="hs-comment">--   integrated into the path, it must consist of valid path characters.</span><span>
</span><a name="line-1848"></a><span class="hs-comment">--</span><span>
</span><a name="line-1849"></a><span class="hs-comment">--   * On Unix-like systems, the path is @~\/./\&lt;app\&gt;/@.</span><span>
</span><a name="line-1850"></a><span class="hs-comment">--   * On Windows, the path is @%APPDATA%\//\&lt;app\&gt;/@</span><span>
</span><a name="line-1851"></a><span class="hs-comment">--     (e.g. @C:\/Users\//\&lt;user\&gt;/\/AppData\/Roaming\//\&lt;app\&gt;/@)</span><span>
</span><a name="line-1852"></a><span class="hs-comment">--</span><span>
</span><a name="line-1853"></a><span class="hs-comment">--   Note: the directory may not actually exist, in which case you would need</span><span>
</span><a name="line-1854"></a><span class="hs-comment">--   to create it.  It is expected that the parent directory exists and is</span><span>
</span><a name="line-1855"></a><span class="hs-comment">--   writable.</span><span>
</span><a name="line-1856"></a><span class="hs-comment">--</span><span>
</span><a name="line-1857"></a><span class="hs-comment">--   The operation may fail with:</span><span>
</span><a name="line-1858"></a><span class="hs-comment">--</span><span>
</span><a name="line-1859"></a><span class="hs-comment">--   * 'UnsupportedOperation'</span><span>
</span><a name="line-1860"></a><span class="hs-comment">--     The operating system has no notion of application-specific data</span><span>
</span><a name="line-1861"></a><span class="hs-comment">--     directory.</span><span>
</span><a name="line-1862"></a><span class="hs-comment">--</span><span>
</span><a name="line-1863"></a><span class="hs-comment">--   * 'isDoesNotExistError'</span><span>
</span><a name="line-1864"></a><span class="hs-comment">--     The home directory for the current user does not exist, or cannot be</span><span>
</span><a name="line-1865"></a><span class="hs-comment">--     found.</span><span>
</span><a name="line-1866"></a><span class="hs-comment">--</span><span>
</span><a name="line-1867"></a><span class="hs-identifier">getAppUserDataDirectory</span><span> </span><span class="hs-glyph">::</span><span> </span><a href="../base-4.10.0.0/src/%{MODULE/./-}.html#%{NAME}/GHC.IO.html#FilePath"><span class="hs-identifier hs-type">FilePath</span></a><span>     </span><span class="hs-comment">-- ^ a relative path that is appended</span><span>
</span><a name="line-1868"></a><span>                                        </span><span class="hs-comment">--   to the path</span><span>
</span><a name="line-1869"></a><span>                        </span><span class="hs-glyph">-&gt;</span><span> </span><span class="hs-identifier hs-type">IO</span><span> </span><a href="../base-4.10.0.0/src/%{MODULE/./-}.html#%{NAME}/GHC.IO.html#FilePath"><span class="hs-identifier hs-type">FilePath</span></a><span>
</span><a name="line-1870"></a><a name="getAppUserDataDirectory"><a href="System.Directory.html#getAppUserDataDirectory"><span class="hs-identifier">getAppUserDataDirectory</span></a></a><span> </span><a name="local-6989586621679042861"><a href="#local-6989586621679042861"><span class="hs-identifier">appName</span></a></a><span> </span><span class="hs-glyph">=</span><span> </span><span class="hs-keyword">do</span><span>
</span><a name="line-1871"></a><span>  </span><a href="../base-4.10.0.0/src/%{MODULE/./-}.html#%{NAME}/System.IO.Error.html#modifyIOError"><span class="hs-identifier hs-var">modifyIOError</span></a><span> </span><span class="hs-special">(</span><span class="hs-special">`</span><a href="System.Directory.html#ioeAddLocation"><span class="hs-identifier hs-var">ioeAddLocation</span></a><span class="hs-special">`</span><span> </span><span class="hs-string">&quot;getAppUserDataDirectory&quot;</span><span class="hs-special">)</span><span> </span><a href="../base-4.10.0.0/src/%{MODULE/./-}.html#%{NAME}/GHC.Base.html#%24"><span class="hs-operator hs-var">$</span></a><span> </span><span class="hs-keyword">do</span><span>
</span><a name="line-1872"></a><span class="hs-cpp">#if defined(mingw32_HOST_OS)</span><span>
</span><a name="line-1873"></a><span>    </span><span class="hs-identifier">s</span><span> </span><span class="hs-glyph">&lt;-</span><span> </span><span class="hs-identifier">Win32</span><span class="hs-operator">.</span><span class="hs-identifier">sHGetFolderPath</span><span> </span><span class="hs-identifier">nullPtr</span><span> </span><span class="hs-identifier">Win32</span><span class="hs-operator">.</span><span class="hs-identifier">cSIDL_APPDATA</span><span> </span><span class="hs-identifier">nullPtr</span><span> </span><span class="hs-number">0</span><span>
</span><a name="line-1874"></a><span>    </span><span class="hs-identifier">return</span><span> </span><span class="hs-special">(</span><span class="hs-identifier">s</span><span class="hs-operator">++</span><span class="hs-char">'\\'</span><span class="hs-glyph">:</span><span class="hs-identifier">appName</span><span class="hs-special">)</span><span>
</span><a name="line-1875"></a><span class="hs-cpp">#else</span><span>
</span><a name="line-1876"></a><span>    </span><a name="local-6989586621679042862"><a href="#local-6989586621679042862"><span class="hs-identifier">path</span></a></a><span> </span><span class="hs-glyph">&lt;-</span><span> </span><a href="../base-4.10.0.0/src/%{MODULE/./-}.html#%{NAME}/System.Environment.html#getEnv"><span class="hs-identifier hs-var">getEnv</span></a><span> </span><span class="hs-string">&quot;HOME&quot;</span><span>
</span><a name="line-1877"></a><span>    </span><a href="../base-4.10.0.0/src/%{MODULE/./-}.html#%{NAME}/GHC.Base.html#return"><span class="hs-identifier hs-var">return</span></a><span> </span><span class="hs-special">(</span><a href="#local-6989586621679042862"><span class="hs-identifier hs-var">path</span></a><a href="../base-4.10.0.0/src/%{MODULE/./-}.html#%{NAME}/GHC.Base.html#%2B%2B"><span class="hs-operator hs-var">++</span></a><span class="hs-char">'/'</span><span class="hs-glyph">:</span><span class="hs-char">'.'</span><span class="hs-glyph">:</span><a href="#local-6989586621679042861"><span class="hs-identifier hs-var">appName</span></a><span class="hs-special">)</span><span>
</span><a name="line-1878"></a><span class="hs-cpp">#endif</span><span>
</span><a name="line-1879"></a><span>
</span><a name="line-1880"></a><span class="hs-comment">{- | Returns the current user's document directory.

The directory returned is expected to be writable by the current user,
but note that it isn't generally considered good practice to store
application-specific data here; use 'getXdgDirectory' or
'getAppUserDataDirectory' instead.

On Unix, 'getUserDocumentsDirectory' returns the value of the @HOME@
environment variable.  On Windows, the system is queried for a
suitable path; a typical path might be @C:\/Users\//\&lt;user\&gt;/\/Documents@.

The operation may fail with:

* 'UnsupportedOperation'
The operating system has no notion of document directory.

* 'isDoesNotExistError'
The document directory for the current user does not exist, or
cannot be found.
-}</span><span>
</span><a name="line-1900"></a><span class="hs-identifier">getUserDocumentsDirectory</span><span> </span><span class="hs-glyph">::</span><span> </span><span class="hs-identifier hs-type">IO</span><span> </span><a href="../base-4.10.0.0/src/%{MODULE/./-}.html#%{NAME}/GHC.IO.html#FilePath"><span class="hs-identifier hs-type">FilePath</span></a><span>
</span><a name="line-1901"></a><a name="getUserDocumentsDirectory"><a href="System.Directory.html#getUserDocumentsDirectory"><span class="hs-identifier">getUserDocumentsDirectory</span></a></a><span> </span><span class="hs-glyph">=</span><span> </span><span class="hs-keyword">do</span><span>
</span><a name="line-1902"></a><span>  </span><a href="../base-4.10.0.0/src/%{MODULE/./-}.html#%{NAME}/System.IO.Error.html#modifyIOError"><span class="hs-identifier hs-var">modifyIOError</span></a><span> </span><span class="hs-special">(</span><span class="hs-special">`</span><a href="System.Directory.html#ioeAddLocation"><span class="hs-identifier hs-var">ioeAddLocation</span></a><span class="hs-special">`</span><span> </span><span class="hs-string">&quot;getUserDocumentsDirectory&quot;</span><span class="hs-special">)</span><span> </span><a href="../base-4.10.0.0/src/%{MODULE/./-}.html#%{NAME}/GHC.Base.html#%24"><span class="hs-operator hs-var">$</span></a><span> </span><span class="hs-keyword">do</span><span>
</span><a name="line-1903"></a><span class="hs-cpp">#if defined(mingw32_HOST_OS)</span><span>
</span><a name="line-1904"></a><span>    </span><span class="hs-identifier">Win32</span><span class="hs-operator">.</span><span class="hs-identifier">sHGetFolderPath</span><span> </span><span class="hs-identifier">nullPtr</span><span> </span><span class="hs-identifier">Win32</span><span class="hs-operator">.</span><span class="hs-identifier">cSIDL_PERSONAL</span><span> </span><span class="hs-identifier">nullPtr</span><span> </span><span class="hs-number">0</span><span>
</span><a name="line-1905"></a><span class="hs-cpp">#else</span><span>
</span><a name="line-1906"></a><span>    </span><a href="../base-4.10.0.0/src/%{MODULE/./-}.html#%{NAME}/System.Environment.html#getEnv"><span class="hs-identifier hs-var">getEnv</span></a><span> </span><span class="hs-string">&quot;HOME&quot;</span><span>
</span><a name="line-1907"></a><span class="hs-cpp">#endif</span><span>
</span><a name="line-1908"></a><span>
</span><a name="line-1909"></a><span class="hs-comment">{- | Returns the current directory for temporary files.

On Unix, 'getTemporaryDirectory' returns the value of the @TMPDIR@
environment variable or \&quot;\/tmp\&quot; if the variable isn\'t defined.
On Windows, the function checks for the existence of environment variables in
the following order and uses the first path found:

*
TMP environment variable.

*
TEMP environment variable.

*
USERPROFILE environment variable.

*
The Windows directory

The operation may fail with:

* 'UnsupportedOperation'
The operating system has no notion of temporary directory.

The function doesn\'t verify whether the path exists.
-}</span><span>
</span><a name="line-1935"></a><span class="hs-identifier">getTemporaryDirectory</span><span> </span><span class="hs-glyph">::</span><span> </span><span class="hs-identifier hs-type">IO</span><span> </span><a href="../base-4.10.0.0/src/%{MODULE/./-}.html#%{NAME}/GHC.IO.html#FilePath"><span class="hs-identifier hs-type">FilePath</span></a><span>
</span><a name="line-1936"></a><a name="getTemporaryDirectory"><a href="System.Directory.html#getTemporaryDirectory"><span class="hs-identifier">getTemporaryDirectory</span></a></a><span> </span><span class="hs-glyph">=</span><span>
</span><a name="line-1937"></a><span class="hs-cpp">#if defined(mingw32_HOST_OS)</span><span>
</span><a name="line-1938"></a><span>  </span><span class="hs-identifier">Win32</span><span class="hs-operator">.</span><span class="hs-identifier">getTemporaryDirectory</span><span>
</span><a name="line-1939"></a><span class="hs-cpp">#else</span><span>
</span><a name="line-1940"></a><span>  </span><a href="../base-4.10.0.0/src/%{MODULE/./-}.html#%{NAME}/System.Environment.html#getEnv"><span class="hs-identifier hs-var">getEnv</span></a><span> </span><span class="hs-string">&quot;TMPDIR&quot;</span><span> </span><span class="hs-special">`</span><a href="../base-4.10.0.0/src/%{MODULE/./-}.html#%{NAME}/System.IO.Error.html#catchIOError"><span class="hs-identifier hs-var">catchIOError</span></a><span class="hs-special">`</span><span> </span><span class="hs-glyph">\</span><span> </span><a name="local-6989586621679042863"><a href="#local-6989586621679042863"><span class="hs-identifier">err</span></a></a><span> </span><span class="hs-glyph">-&gt;</span><span>
</span><a name="line-1941"></a><span>  </span><span class="hs-keyword">if</span><span> </span><a href="../base-4.10.0.0/src/%{MODULE/./-}.html#%{NAME}/System.IO.Error.html#isDoesNotExistError"><span class="hs-identifier hs-var">isDoesNotExistError</span></a><span> </span><a href="#local-6989586621679042863"><span class="hs-identifier hs-var">err</span></a><span> </span><span class="hs-keyword">then</span><span> </span><a href="../base-4.10.0.0/src/%{MODULE/./-}.html#%{NAME}/GHC.Base.html#return"><span class="hs-identifier hs-var">return</span></a><span> </span><span class="hs-string">&quot;/tmp&quot;</span><span> </span><span class="hs-keyword">else</span><span> </span><a href="../base-4.10.0.0/src/%{MODULE/./-}.html#%{NAME}/GHC.IO.Exception.html#ioError"><span class="hs-identifier hs-var">ioError</span></a><span> </span><a href="#local-6989586621679042863"><span class="hs-identifier hs-var">err</span></a><span>
</span><a name="line-1942"></a><span class="hs-cpp">#endif</span><span>
</span><a name="line-1943"></a><span>
</span><a name="line-1944"></a><span class="hs-identifier">ioeAddLocation</span><span> </span><span class="hs-glyph">::</span><span> </span><a href="../base-4.10.0.0/src/%{MODULE/./-}.html#%{NAME}/GHC.IO.Exception.html#IOError"><span class="hs-identifier hs-type">IOError</span></a><span> </span><span class="hs-glyph">-&gt;</span><span> </span><a href="../base-4.10.0.0/src/%{MODULE/./-}.html#%{NAME}/GHC.Base.html#String"><span class="hs-identifier hs-type">String</span></a><span> </span><span class="hs-glyph">-&gt;</span><span> </span><a href="../base-4.10.0.0/src/%{MODULE/./-}.html#%{NAME}/GHC.IO.Exception.html#IOError"><span class="hs-identifier hs-type">IOError</span></a><span>
</span><a name="line-1945"></a><a name="ioeAddLocation"><a href="System.Directory.html#ioeAddLocation"><span class="hs-identifier">ioeAddLocation</span></a></a><span> </span><a name="local-6989586621679042864"><a href="#local-6989586621679042864"><span class="hs-identifier">e</span></a></a><span> </span><a name="local-6989586621679042865"><a href="#local-6989586621679042865"><span class="hs-identifier">loc</span></a></a><span> </span><span class="hs-glyph">=</span><span> </span><span class="hs-keyword">do</span><span>
</span><a name="line-1946"></a><span>  </span><a href="../base-4.10.0.0/src/%{MODULE/./-}.html#%{NAME}/System.IO.Error.html#ioeSetLocation"><span class="hs-identifier hs-var">ioeSetLocation</span></a><span> </span><a href="#local-6989586621679042864"><span class="hs-identifier hs-var">e</span></a><span> </span><a href="#local-6989586621679042866"><span class="hs-identifier hs-var">newLoc</span></a><span>
</span><a name="line-1947"></a><span>  </span><span class="hs-keyword">where</span><span>
</span><a name="line-1948"></a><span>    </span><a name="local-6989586621679042866"><a href="#local-6989586621679042866"><span class="hs-identifier">newLoc</span></a></a><span> </span><span class="hs-glyph">=</span><span> </span><a href="#local-6989586621679042865"><span class="hs-identifier hs-var">loc</span></a><span> </span><a href="../base-4.10.0.0/src/%{MODULE/./-}.html#%{NAME}/Data.Monoid.html#%3C%3E"><span class="hs-operator hs-var">&lt;&gt;</span></a><span> </span><span class="hs-keyword">if</span><span> </span><a href="../base-4.10.0.0/src/%{MODULE/./-}.html#%{NAME}/Data.Foldable.html#null"><span class="hs-identifier hs-var">null</span></a><span> </span><a href="#local-6989586621679042867"><span class="hs-identifier hs-var">oldLoc</span></a><span> </span><span class="hs-keyword">then</span><span> </span><span class="hs-string">&quot;&quot;</span><span> </span><span class="hs-keyword">else</span><span> </span><span class="hs-string">&quot;:&quot;</span><span> </span><a href="../base-4.10.0.0/src/%{MODULE/./-}.html#%{NAME}/Data.Monoid.html#%3C%3E"><span class="hs-operator hs-var">&lt;&gt;</span></a><span> </span><a href="#local-6989586621679042867"><span class="hs-identifier hs-var">oldLoc</span></a><span>
</span><a name="line-1949"></a><span>    </span><a name="local-6989586621679042867"><a href="#local-6989586621679042867"><span class="hs-identifier">oldLoc</span></a></a><span> </span><span class="hs-glyph">=</span><span> </span><a href="../base-4.10.0.0/src/%{MODULE/./-}.html#%{NAME}/System.IO.Error.html#ioeGetLocation"><span class="hs-identifier hs-var">ioeGetLocation</span></a><span> </span><a href="#local-6989586621679042864"><span class="hs-identifier hs-var">e</span></a><span>
</span><a name="line-1950"></a></pre></body></html>