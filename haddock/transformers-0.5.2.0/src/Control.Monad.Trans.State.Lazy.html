<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Transitional//EN" "http://www.w3.org/TR/xhtml1/DTD/xhtml1-transitional.dtd"><html xmlns="http://www.w3.org/1999/xhtml"><head><link rel="stylesheet" type="text/css" href="style.css" /><script type="text/javascript" src="highlight.js"></script></head><body><pre><span class="hs-pragma">{-# LANGUAGE CPP #-}</span><span>
</span><a name="line-2"></a><span class="hs-cpp">#if __GLASGOW_HASKELL__ &gt;= 702</span><span>
</span><a name="line-3"></a><span class="hs-pragma">{-# LANGUAGE Safe #-}</span><span>
</span><a name="line-4"></a><span class="hs-cpp">#endif</span><span>
</span><a name="line-5"></a><span class="hs-cpp">#if __GLASGOW_HASKELL__ &gt;= 710</span><span>
</span><a name="line-6"></a><span class="hs-pragma">{-# LANGUAGE AutoDeriveTypeable #-}</span><span>
</span><a name="line-7"></a><span class="hs-cpp">#endif</span><span>
</span><a name="line-8"></a><span class="hs-comment">-----------------------------------------------------------------------------</span><span>
</span><a name="line-9"></a><span class="hs-comment">-- |</span><span>
</span><a name="line-10"></a><span class="hs-comment">-- Module      :  Control.Monad.Trans.State.Lazy</span><span>
</span><a name="line-11"></a><span class="hs-comment">-- Copyright   :  (c) Andy Gill 2001,</span><span>
</span><a name="line-12"></a><span class="hs-comment">--                (c) Oregon Graduate Institute of Science and Technology, 2001</span><span>
</span><a name="line-13"></a><span class="hs-comment">-- License     :  BSD-style (see the file LICENSE)</span><span>
</span><a name="line-14"></a><span class="hs-comment">--</span><span>
</span><a name="line-15"></a><span class="hs-comment">-- Maintainer  :  R.Paterson@city.ac.uk</span><span>
</span><a name="line-16"></a><span class="hs-comment">-- Stability   :  experimental</span><span>
</span><a name="line-17"></a><span class="hs-comment">-- Portability :  portable</span><span>
</span><a name="line-18"></a><span class="hs-comment">--</span><span>
</span><a name="line-19"></a><span class="hs-comment">-- Lazy state monads, passing an updatable state through a computation.</span><span>
</span><a name="line-20"></a><span class="hs-comment">-- See below for examples.</span><span>
</span><a name="line-21"></a><span class="hs-comment">--</span><span>
</span><a name="line-22"></a><span class="hs-comment">-- Some computations may not require the full power of state transformers:</span><span>
</span><a name="line-23"></a><span class="hs-comment">--</span><span>
</span><a name="line-24"></a><span class="hs-comment">-- * For a read-only state, see &quot;Control.Monad.Trans.Reader&quot;.</span><span>
</span><a name="line-25"></a><span class="hs-comment">--</span><span>
</span><a name="line-26"></a><span class="hs-comment">-- * To accumulate a value without using it on the way, see</span><span>
</span><a name="line-27"></a><span class="hs-comment">--   &quot;Control.Monad.Trans.Writer&quot;.</span><span>
</span><a name="line-28"></a><span class="hs-comment">--</span><span>
</span><a name="line-29"></a><span class="hs-comment">-- In this version, sequencing of computations is lazy, so that for</span><span>
</span><a name="line-30"></a><span class="hs-comment">-- example the following produces a usable result:</span><span>
</span><a name="line-31"></a><span class="hs-comment">--</span><span>
</span><a name="line-32"></a><span class="hs-comment">-- &gt; evalState (sequence $ repeat $ do { n &lt;- get; put (n*2); return n }) 1</span><span>
</span><a name="line-33"></a><span class="hs-comment">--</span><span>
</span><a name="line-34"></a><span class="hs-comment">-- For a strict version with the same interface, see</span><span>
</span><a name="line-35"></a><span class="hs-comment">-- &quot;Control.Monad.Trans.State.Strict&quot;.</span><span>
</span><a name="line-36"></a><span class="hs-comment">-----------------------------------------------------------------------------</span><span>
</span><a name="line-37"></a><span>
</span><a name="line-38"></a><span class="hs-keyword">module</span><span> </span><span class="hs-identifier">Control</span><span class="hs-operator">.</span><span class="hs-identifier">Monad</span><span class="hs-operator">.</span><span class="hs-identifier">Trans</span><span class="hs-operator">.</span><span class="hs-identifier">State</span><span class="hs-operator">.</span><span class="hs-identifier">Lazy</span><span> </span><span class="hs-special">(</span><span>
</span><a name="line-39"></a><span>    </span><span class="hs-comment">-- * The State monad</span><span>
</span><a name="line-40"></a><span>    </span><a href="Control.Monad.Trans.State.Lazy.html#State"><span class="hs-identifier hs-type">State</span></a><span class="hs-special">,</span><span>
</span><a name="line-41"></a><span>    </span><a href="Control.Monad.Trans.State.Lazy.html#state"><span class="hs-identifier hs-var">state</span></a><span class="hs-special">,</span><span>
</span><a name="line-42"></a><span>    </span><a href="Control.Monad.Trans.State.Lazy.html#runState"><span class="hs-identifier hs-var">runState</span></a><span class="hs-special">,</span><span>
</span><a name="line-43"></a><span>    </span><a href="Control.Monad.Trans.State.Lazy.html#evalState"><span class="hs-identifier hs-var">evalState</span></a><span class="hs-special">,</span><span>
</span><a name="line-44"></a><span>    </span><a href="Control.Monad.Trans.State.Lazy.html#execState"><span class="hs-identifier hs-var">execState</span></a><span class="hs-special">,</span><span>
</span><a name="line-45"></a><span>    </span><a href="Control.Monad.Trans.State.Lazy.html#mapState"><span class="hs-identifier hs-var">mapState</span></a><span class="hs-special">,</span><span>
</span><a name="line-46"></a><span>    </span><a href="Control.Monad.Trans.State.Lazy.html#withState"><span class="hs-identifier hs-var">withState</span></a><span class="hs-special">,</span><span>
</span><a name="line-47"></a><span>    </span><span class="hs-comment">-- * The StateT monad transformer</span><span>
</span><a name="line-48"></a><span>    </span><a href="Control.Monad.Trans.State.Lazy.html#StateT"><span class="hs-identifier hs-type">StateT</span></a><span class="hs-special">(</span><span class="hs-glyph">..</span><span class="hs-special">)</span><span class="hs-special">,</span><span>
</span><a name="line-49"></a><span>    </span><a href="Control.Monad.Trans.State.Lazy.html#evalStateT"><span class="hs-identifier hs-var">evalStateT</span></a><span class="hs-special">,</span><span>
</span><a name="line-50"></a><span>    </span><a href="Control.Monad.Trans.State.Lazy.html#execStateT"><span class="hs-identifier hs-var">execStateT</span></a><span class="hs-special">,</span><span>
</span><a name="line-51"></a><span>    </span><a href="Control.Monad.Trans.State.Lazy.html#mapStateT"><span class="hs-identifier hs-var">mapStateT</span></a><span class="hs-special">,</span><span>
</span><a name="line-52"></a><span>    </span><a href="Control.Monad.Trans.State.Lazy.html#withStateT"><span class="hs-identifier hs-var">withStateT</span></a><span class="hs-special">,</span><span>
</span><a name="line-53"></a><span>    </span><span class="hs-comment">-- * State operations</span><span>
</span><a name="line-54"></a><span>    </span><a href="Control.Monad.Trans.State.Lazy.html#get"><span class="hs-identifier hs-var">get</span></a><span class="hs-special">,</span><span>
</span><a name="line-55"></a><span>    </span><a href="Control.Monad.Trans.State.Lazy.html#put"><span class="hs-identifier hs-var">put</span></a><span class="hs-special">,</span><span>
</span><a name="line-56"></a><span>    </span><a href="Control.Monad.Trans.State.Lazy.html#modify"><span class="hs-identifier hs-var">modify</span></a><span class="hs-special">,</span><span>
</span><a name="line-57"></a><span>    </span><a href="Control.Monad.Trans.State.Lazy.html#modify%27"><span class="hs-identifier hs-var">modify'</span></a><span class="hs-special">,</span><span>
</span><a name="line-58"></a><span>    </span><a href="Control.Monad.Trans.State.Lazy.html#gets"><span class="hs-identifier hs-var">gets</span></a><span class="hs-special">,</span><span>
</span><a name="line-59"></a><span>    </span><span class="hs-comment">-- * Lifting other operations</span><span>
</span><a name="line-60"></a><span>    </span><a href="Control.Monad.Trans.State.Lazy.html#liftCallCC"><span class="hs-identifier hs-var">liftCallCC</span></a><span class="hs-special">,</span><span>
</span><a name="line-61"></a><span>    </span><a href="Control.Monad.Trans.State.Lazy.html#liftCallCC%27"><span class="hs-identifier hs-var">liftCallCC'</span></a><span class="hs-special">,</span><span>
</span><a name="line-62"></a><span>    </span><a href="Control.Monad.Trans.State.Lazy.html#liftCatch"><span class="hs-identifier hs-var">liftCatch</span></a><span class="hs-special">,</span><span>
</span><a name="line-63"></a><span>    </span><a href="Control.Monad.Trans.State.Lazy.html#liftListen"><span class="hs-identifier hs-var">liftListen</span></a><span class="hs-special">,</span><span>
</span><a name="line-64"></a><span>    </span><a href="Control.Monad.Trans.State.Lazy.html#liftPass"><span class="hs-identifier hs-var">liftPass</span></a><span class="hs-special">,</span><span>
</span><a name="line-65"></a><span>    </span><span class="hs-comment">-- * Examples</span><span>
</span><a name="line-66"></a><span>    </span><span class="hs-comment">-- ** State monads</span><span>
</span><a name="line-67"></a><span>    </span><span class="hs-comment">-- $examples</span><span>
</span><a name="line-68"></a><span>
</span><a name="line-69"></a><span>    </span><span class="hs-comment">-- ** Counting</span><span>
</span><a name="line-70"></a><span>    </span><span class="hs-comment">-- $counting</span><span>
</span><a name="line-71"></a><span>
</span><a name="line-72"></a><span>    </span><span class="hs-comment">-- ** Labelling trees</span><span>
</span><a name="line-73"></a><span>    </span><span class="hs-comment">-- $labelling</span><span>
</span><a name="line-74"></a><span>  </span><span class="hs-special">)</span><span> </span><span class="hs-keyword">where</span><span>
</span><a name="line-75"></a><span>
</span><a name="line-76"></a><span class="hs-keyword">import</span><span> </span><a href="../base-4.10.0.0/src/%{MODULE/./-}.html#%{NAME}/Control.Monad.IO.Class.html"><span class="hs-identifier">Control</span><span class="hs-operator">.</span><span class="hs-identifier">Monad</span><span class="hs-operator">.</span><span class="hs-identifier">IO</span><span class="hs-operator">.</span><span class="hs-identifier">Class</span></a><span>
</span><a name="line-77"></a><span class="hs-keyword">import</span><span> </span><a href="Control.Monad.Signatures.html"><span class="hs-identifier">Control</span><span class="hs-operator">.</span><span class="hs-identifier">Monad</span><span class="hs-operator">.</span><span class="hs-identifier">Signatures</span></a><span>
</span><a name="line-78"></a><span class="hs-keyword">import</span><span> </span><a href="Control.Monad.Trans.Class.html"><span class="hs-identifier">Control</span><span class="hs-operator">.</span><span class="hs-identifier">Monad</span><span class="hs-operator">.</span><span class="hs-identifier">Trans</span><span class="hs-operator">.</span><span class="hs-identifier">Class</span></a><span>
</span><a name="line-79"></a><span class="hs-keyword">import</span><span> </span><a href="../base-4.10.0.0/src/%{MODULE/./-}.html#%{NAME}/Data.Functor.Identity.html"><span class="hs-identifier">Data</span><span class="hs-operator">.</span><span class="hs-identifier">Functor</span><span class="hs-operator">.</span><span class="hs-identifier">Identity</span></a><span>
</span><a name="line-80"></a><span>
</span><a name="line-81"></a><span class="hs-keyword">import</span><span> </span><a href="../base-4.10.0.0/src/%{MODULE/./-}.html#%{NAME}/Control.Applicative.html"><span class="hs-identifier">Control</span><span class="hs-operator">.</span><span class="hs-identifier">Applicative</span></a><span>
</span><a name="line-82"></a><span class="hs-keyword">import</span><span> </span><a href="../base-4.10.0.0/src/%{MODULE/./-}.html#%{NAME}/Control.Monad.html"><span class="hs-identifier">Control</span><span class="hs-operator">.</span><span class="hs-identifier">Monad</span></a><span>
</span><a name="line-83"></a><span class="hs-cpp">#if MIN_VERSION_base(4,9,0)</span><span>
</span><a name="line-84"></a><span class="hs-keyword">import</span><span> </span><span class="hs-keyword">qualified</span><span> </span><a href="../base-4.10.0.0/src/%{MODULE/./-}.html#%{NAME}/Control.Monad.Fail.html"><span class="hs-identifier">Control</span><span class="hs-operator">.</span><span class="hs-identifier">Monad</span><span class="hs-operator">.</span><span class="hs-identifier">Fail</span></a><span> </span><span class="hs-keyword">as</span><span> </span><span class="hs-identifier">Fail</span><span>
</span><a name="line-85"></a><span class="hs-cpp">#endif</span><span>
</span><a name="line-86"></a><span class="hs-keyword">import</span><span> </span><a href="../base-4.10.0.0/src/%{MODULE/./-}.html#%{NAME}/Control.Monad.Fix.html"><span class="hs-identifier">Control</span><span class="hs-operator">.</span><span class="hs-identifier">Monad</span><span class="hs-operator">.</span><span class="hs-identifier">Fix</span></a><span>
</span><a name="line-87"></a><span>
</span><a name="line-88"></a><span class="hs-comment">-- ---------------------------------------------------------------------------</span><span>
</span><a name="line-89"></a><span class="hs-comment">-- | A state monad parameterized by the type @s@ of the state to carry.</span><span>
</span><a name="line-90"></a><span class="hs-comment">--</span><span>
</span><a name="line-91"></a><span class="hs-comment">-- The 'return' function leaves the state unchanged, while @&gt;&gt;=@ uses</span><span>
</span><a name="line-92"></a><span class="hs-comment">-- the final state of the first computation as the initial state of</span><span>
</span><a name="line-93"></a><span class="hs-comment">-- the second.</span><span>
</span><a name="line-94"></a><span class="hs-keyword">type</span><span> </span><a name="State"><a href="Control.Monad.Trans.State.Lazy.html#State"><span class="hs-identifier">State</span></a></a><span> </span><a name="local-6989586621679056242"><a href="#local-6989586621679056242"><span class="hs-identifier">s</span></a></a><span> </span><span class="hs-glyph">=</span><span> </span><a href="Control.Monad.Trans.State.Lazy.html#StateT"><span class="hs-identifier hs-type">StateT</span></a><span> </span><a href="#local-6989586621679056242"><span class="hs-identifier hs-type">s</span></a><span> </span><a href="../base-4.10.0.0/src/%{MODULE/./-}.html#%{NAME}/Data.Functor.Identity.html#Identity"><span class="hs-identifier hs-type">Identity</span></a><span>
</span><a name="line-95"></a><span>
</span><a name="line-96"></a><span class="hs-comment">-- | Construct a state monad computation from a function.</span><span>
</span><a name="line-97"></a><span class="hs-comment">-- (The inverse of 'runState'.)</span><span>
</span><a name="line-98"></a><span class="hs-identifier">state</span><span> </span><span class="hs-glyph">::</span><span> </span><span class="hs-special">(</span><a href="../base-4.10.0.0/src/%{MODULE/./-}.html#%{NAME}/GHC.Base.html#Monad"><span class="hs-identifier hs-type">Monad</span></a><span> </span><a href="#local-6989586621679056349"><span class="hs-identifier hs-type">m</span></a><span class="hs-special">)</span><span>
</span><a name="line-99"></a><span>      </span><span class="hs-glyph">=&gt;</span><span> </span><span class="hs-special">(</span><a href="#local-6989586621679056350"><span class="hs-identifier hs-type">s</span></a><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="hs-special">(</span><a href="#local-6989586621679056351"><span class="hs-identifier hs-type">a</span></a><span class="hs-special">,</span><span> </span><a href="#local-6989586621679056350"><span class="hs-identifier hs-type">s</span></a><span class="hs-special">)</span><span class="hs-special">)</span><span>  </span><span class="hs-comment">-- ^pure state transformer</span><span>
</span><a name="line-100"></a><span>      </span><span class="hs-glyph">-&gt;</span><span> </span><a href="Control.Monad.Trans.State.Lazy.html#StateT"><span class="hs-identifier hs-type">StateT</span></a><span> </span><a href="#local-6989586621679056350"><span class="hs-identifier hs-type">s</span></a><span> </span><a href="#local-6989586621679056349"><span class="hs-identifier hs-type">m</span></a><span> </span><a href="#local-6989586621679056351"><span class="hs-identifier hs-type">a</span></a><span>   </span><span class="hs-comment">-- ^equivalent state-passing computation</span><span>
</span><a name="line-101"></a><a name="state"><a href="Control.Monad.Trans.State.Lazy.html#state"><span class="hs-identifier">state</span></a></a><span> </span><a name="local-6989586621679056352"><a href="#local-6989586621679056352"><span class="hs-identifier">f</span></a></a><span> </span><span class="hs-glyph">=</span><span> </span><a href="Control.Monad.Trans.State.Lazy.html#StateT"><span class="hs-identifier hs-var">StateT</span></a><span> </span><span class="hs-special">(</span><a href="../base-4.10.0.0/src/%{MODULE/./-}.html#%{NAME}/GHC.Base.html#return"><span class="hs-identifier hs-var">return</span></a><span> </span><a href="../base-4.10.0.0/src/%{MODULE/./-}.html#%{NAME}/GHC.Base.html#."><span class="hs-operator hs-var">.</span></a><span> </span><a href="#local-6989586621679056352"><span class="hs-identifier hs-var">f</span></a><span class="hs-special">)</span><span>
</span><a name="line-102"></a><span class="hs-pragma">{-# INLINE state #-}</span><span>
</span><a name="line-103"></a><span>
</span><a name="line-104"></a><span class="hs-comment">-- | Unwrap a state monad computation as a function.</span><span>
</span><a name="line-105"></a><span class="hs-comment">-- (The inverse of 'state'.)</span><span>
</span><a name="line-106"></a><span class="hs-identifier">runState</span><span> </span><span class="hs-glyph">::</span><span> </span><a href="Control.Monad.Trans.State.Lazy.html#State"><span class="hs-identifier hs-type">State</span></a><span> </span><a href="#local-6989586621679056347"><span class="hs-identifier hs-type">s</span></a><span> </span><a href="#local-6989586621679056348"><span class="hs-identifier hs-type">a</span></a><span>   </span><span class="hs-comment">-- ^state-passing computation to execute</span><span>
</span><a name="line-107"></a><span>         </span><span class="hs-glyph">-&gt;</span><span> </span><a href="#local-6989586621679056347"><span class="hs-identifier hs-type">s</span></a><span>           </span><span class="hs-comment">-- ^initial state</span><span>
</span><a name="line-108"></a><span>         </span><span class="hs-glyph">-&gt;</span><span> </span><span class="hs-special">(</span><a href="#local-6989586621679056348"><span class="hs-identifier hs-type">a</span></a><span class="hs-special">,</span><span> </span><a href="#local-6989586621679056347"><span class="hs-identifier hs-type">s</span></a><span class="hs-special">)</span><span>      </span><span class="hs-comment">-- ^return value and final state</span><span>
</span><a name="line-109"></a><a name="runState"><a href="Control.Monad.Trans.State.Lazy.html#runState"><span class="hs-identifier">runState</span></a></a><span> </span><a name="local-6989586621679056353"><a href="#local-6989586621679056353"><span class="hs-identifier">m</span></a></a><span> </span><span class="hs-glyph">=</span><span> </span><span class="hs-identifier">runIdentity</span><span> </span><a href="../base-4.10.0.0/src/%{MODULE/./-}.html#%{NAME}/GHC.Base.html#."><span class="hs-operator hs-var">.</span></a><span> </span><span class="hs-identifier">runStateT</span><span> </span><a href="#local-6989586621679056353"><span class="hs-identifier hs-var">m</span></a><span>
</span><a name="line-110"></a><span class="hs-pragma">{-# INLINE runState #-}</span><span>
</span><a name="line-111"></a><span>
</span><a name="line-112"></a><span class="hs-comment">-- | Evaluate a state computation with the given initial state</span><span>
</span><a name="line-113"></a><span class="hs-comment">-- and return the final value, discarding the final state.</span><span>
</span><a name="line-114"></a><span class="hs-comment">--</span><span>
</span><a name="line-115"></a><span class="hs-comment">-- * @'evalState' m s = 'fst' ('runState' m s)@</span><span>
</span><a name="line-116"></a><span class="hs-identifier">evalState</span><span> </span><span class="hs-glyph">::</span><span> </span><a href="Control.Monad.Trans.State.Lazy.html#State"><span class="hs-identifier hs-type">State</span></a><span> </span><a href="#local-6989586621679056345"><span class="hs-identifier hs-type">s</span></a><span> </span><a href="#local-6989586621679056346"><span class="hs-identifier hs-type">a</span></a><span>  </span><span class="hs-comment">-- ^state-passing computation to execute</span><span>
</span><a name="line-117"></a><span>          </span><span class="hs-glyph">-&gt;</span><span> </span><a href="#local-6989586621679056345"><span class="hs-identifier hs-type">s</span></a><span>          </span><span class="hs-comment">-- ^initial value</span><span>
</span><a name="line-118"></a><span>          </span><span class="hs-glyph">-&gt;</span><span> </span><a href="#local-6989586621679056346"><span class="hs-identifier hs-type">a</span></a><span>          </span><span class="hs-comment">-- ^return value of the state computation</span><span>
</span><a name="line-119"></a><a name="evalState"><a href="Control.Monad.Trans.State.Lazy.html#evalState"><span class="hs-identifier">evalState</span></a></a><span> </span><a name="local-6989586621679056354"><a href="#local-6989586621679056354"><span class="hs-identifier">m</span></a></a><span> </span><a name="local-6989586621679056355"><a href="#local-6989586621679056355"><span class="hs-identifier">s</span></a></a><span> </span><span class="hs-glyph">=</span><span> </span><a href="../base-4.10.0.0/src/%{MODULE/./-}.html#%{NAME}/Data.Tuple.html#fst"><span class="hs-identifier hs-var">fst</span></a><span> </span><span class="hs-special">(</span><a href="Control.Monad.Trans.State.Lazy.html#runState"><span class="hs-identifier hs-var">runState</span></a><span> </span><a href="#local-6989586621679056354"><span class="hs-identifier hs-var">m</span></a><span> </span><a href="#local-6989586621679056355"><span class="hs-identifier hs-var">s</span></a><span class="hs-special">)</span><span>
</span><a name="line-120"></a><span class="hs-pragma">{-# INLINE evalState #-}</span><span>
</span><a name="line-121"></a><span>
</span><a name="line-122"></a><span class="hs-comment">-- | Evaluate a state computation with the given initial state</span><span>
</span><a name="line-123"></a><span class="hs-comment">-- and return the final state, discarding the final value.</span><span>
</span><a name="line-124"></a><span class="hs-comment">--</span><span>
</span><a name="line-125"></a><span class="hs-comment">-- * @'execState' m s = 'snd' ('runState' m s)@</span><span>
</span><a name="line-126"></a><span class="hs-identifier">execState</span><span> </span><span class="hs-glyph">::</span><span> </span><a href="Control.Monad.Trans.State.Lazy.html#State"><span class="hs-identifier hs-type">State</span></a><span> </span><a href="#local-6989586621679056343"><span class="hs-identifier hs-type">s</span></a><span> </span><a href="#local-6989586621679056344"><span class="hs-identifier hs-type">a</span></a><span>  </span><span class="hs-comment">-- ^state-passing computation to execute</span><span>
</span><a name="line-127"></a><span>          </span><span class="hs-glyph">-&gt;</span><span> </span><a href="#local-6989586621679056343"><span class="hs-identifier hs-type">s</span></a><span>          </span><span class="hs-comment">-- ^initial value</span><span>
</span><a name="line-128"></a><span>          </span><span class="hs-glyph">-&gt;</span><span> </span><a href="#local-6989586621679056343"><span class="hs-identifier hs-type">s</span></a><span>          </span><span class="hs-comment">-- ^final state</span><span>
</span><a name="line-129"></a><a name="execState"><a href="Control.Monad.Trans.State.Lazy.html#execState"><span class="hs-identifier">execState</span></a></a><span> </span><a name="local-6989586621679056356"><a href="#local-6989586621679056356"><span class="hs-identifier">m</span></a></a><span> </span><a name="local-6989586621679056357"><a href="#local-6989586621679056357"><span class="hs-identifier">s</span></a></a><span> </span><span class="hs-glyph">=</span><span> </span><a href="../base-4.10.0.0/src/%{MODULE/./-}.html#%{NAME}/Data.Tuple.html#snd"><span class="hs-identifier hs-var">snd</span></a><span> </span><span class="hs-special">(</span><a href="Control.Monad.Trans.State.Lazy.html#runState"><span class="hs-identifier hs-var">runState</span></a><span> </span><a href="#local-6989586621679056356"><span class="hs-identifier hs-var">m</span></a><span> </span><a href="#local-6989586621679056357"><span class="hs-identifier hs-var">s</span></a><span class="hs-special">)</span><span>
</span><a name="line-130"></a><span class="hs-pragma">{-# INLINE execState #-}</span><span>
</span><a name="line-131"></a><span>
</span><a name="line-132"></a><span class="hs-comment">-- | Map both the return value and final state of a computation using</span><span>
</span><a name="line-133"></a><span class="hs-comment">-- the given function.</span><span>
</span><a name="line-134"></a><span class="hs-comment">--</span><span>
</span><a name="line-135"></a><span class="hs-comment">-- * @'runState' ('mapState' f m) = f . 'runState' m@</span><span>
</span><a name="line-136"></a><span class="hs-identifier">mapState</span><span> </span><span class="hs-glyph">::</span><span> </span><span class="hs-special">(</span><span class="hs-special">(</span><a href="#local-6989586621679056340"><span class="hs-identifier hs-type">a</span></a><span class="hs-special">,</span><span> </span><a href="#local-6989586621679056341"><span class="hs-identifier hs-type">s</span></a><span class="hs-special">)</span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="hs-special">(</span><a href="#local-6989586621679056342"><span class="hs-identifier hs-type">b</span></a><span class="hs-special">,</span><span> </span><a href="#local-6989586621679056341"><span class="hs-identifier hs-type">s</span></a><span class="hs-special">)</span><span class="hs-special">)</span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><a href="Control.Monad.Trans.State.Lazy.html#State"><span class="hs-identifier hs-type">State</span></a><span> </span><a href="#local-6989586621679056341"><span class="hs-identifier hs-type">s</span></a><span> </span><a href="#local-6989586621679056340"><span class="hs-identifier hs-type">a</span></a><span> </span><span class="hs-glyph">-&gt;</span><span> </span><a href="Control.Monad.Trans.State.Lazy.html#State"><span class="hs-identifier hs-type">State</span></a><span> </span><a href="#local-6989586621679056341"><span class="hs-identifier hs-type">s</span></a><span> </span><a href="#local-6989586621679056342"><span class="hs-identifier hs-type">b</span></a><span>
</span><a name="line-137"></a><a name="mapState"><a href="Control.Monad.Trans.State.Lazy.html#mapState"><span class="hs-identifier">mapState</span></a></a><span> </span><a name="local-6989586621679056358"><a href="#local-6989586621679056358"><span class="hs-identifier">f</span></a></a><span> </span><span class="hs-glyph">=</span><span> </span><a href="Control.Monad.Trans.State.Lazy.html#mapStateT"><span class="hs-identifier hs-var">mapStateT</span></a><span> </span><span class="hs-special">(</span><a href="../base-4.10.0.0/src/%{MODULE/./-}.html#%{NAME}/Data.Functor.Identity.html#Identity"><span class="hs-identifier hs-var">Identity</span></a><span> </span><a href="../base-4.10.0.0/src/%{MODULE/./-}.html#%{NAME}/GHC.Base.html#."><span class="hs-operator hs-var">.</span></a><span> </span><a href="#local-6989586621679056358"><span class="hs-identifier hs-var">f</span></a><span> </span><a href="../base-4.10.0.0/src/%{MODULE/./-}.html#%{NAME}/GHC.Base.html#."><span class="hs-operator hs-var">.</span></a><span> </span><span class="hs-identifier">runIdentity</span><span class="hs-special">)</span><span>
</span><a name="line-138"></a><span class="hs-pragma">{-# INLINE mapState #-}</span><span>
</span><a name="line-139"></a><span>
</span><a name="line-140"></a><span class="hs-comment">-- | @'withState' f m@ executes action @m@ on a state modified by</span><span>
</span><a name="line-141"></a><span class="hs-comment">-- applying @f@.</span><span>
</span><a name="line-142"></a><span class="hs-comment">--</span><span>
</span><a name="line-143"></a><span class="hs-comment">-- * @'withState' f m = 'modify' f &gt;&gt; m@</span><span>
</span><a name="line-144"></a><span class="hs-identifier">withState</span><span> </span><span class="hs-glyph">::</span><span> </span><span class="hs-special">(</span><a href="#local-6989586621679056338"><span class="hs-identifier hs-type">s</span></a><span> </span><span class="hs-glyph">-&gt;</span><span> </span><a href="#local-6989586621679056338"><span class="hs-identifier hs-type">s</span></a><span class="hs-special">)</span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><a href="Control.Monad.Trans.State.Lazy.html#State"><span class="hs-identifier hs-type">State</span></a><span> </span><a href="#local-6989586621679056338"><span class="hs-identifier hs-type">s</span></a><span> </span><a href="#local-6989586621679056339"><span class="hs-identifier hs-type">a</span></a><span> </span><span class="hs-glyph">-&gt;</span><span> </span><a href="Control.Monad.Trans.State.Lazy.html#State"><span class="hs-identifier hs-type">State</span></a><span> </span><a href="#local-6989586621679056338"><span class="hs-identifier hs-type">s</span></a><span> </span><a href="#local-6989586621679056339"><span class="hs-identifier hs-type">a</span></a><span>
</span><a name="line-145"></a><a name="withState"><a href="Control.Monad.Trans.State.Lazy.html#withState"><span class="hs-identifier">withState</span></a></a><span> </span><span class="hs-glyph">=</span><span> </span><a href="Control.Monad.Trans.State.Lazy.html#withStateT"><span class="hs-identifier hs-var">withStateT</span></a><span>
</span><a name="line-146"></a><span class="hs-pragma">{-# INLINE withState #-}</span><span>
</span><a name="line-147"></a><span>
</span><a name="line-148"></a><span class="hs-comment">-- ---------------------------------------------------------------------------</span><span>
</span><a name="line-149"></a><span class="hs-comment">-- | A state transformer monad parameterized by:</span><span>
</span><a name="line-150"></a><span class="hs-comment">--</span><span>
</span><a name="line-151"></a><span class="hs-comment">--   * @s@ - The state.</span><span>
</span><a name="line-152"></a><span class="hs-comment">--</span><span>
</span><a name="line-153"></a><span class="hs-comment">--   * @m@ - The inner monad.</span><span>
</span><a name="line-154"></a><span class="hs-comment">--</span><span>
</span><a name="line-155"></a><span class="hs-comment">-- The 'return' function leaves the state unchanged, while @&gt;&gt;=@ uses</span><span>
</span><a name="line-156"></a><span class="hs-comment">-- the final state of the first computation as the initial state of</span><span>
</span><a name="line-157"></a><span class="hs-comment">-- the second.</span><span>
</span><a name="line-158"></a><span class="hs-keyword">newtype</span><span> </span><a name="StateT"><a href="Control.Monad.Trans.State.Lazy.html#StateT"><span class="hs-identifier">StateT</span></a></a><span> </span><a name="local-6989586621679056239"><a href="#local-6989586621679056239"><span class="hs-identifier">s</span></a></a><span> </span><a name="local-6989586621679056240"><a href="#local-6989586621679056240"><span class="hs-identifier">m</span></a></a><span> </span><a name="local-6989586621679056241"><a href="#local-6989586621679056241"><span class="hs-identifier">a</span></a></a><span> </span><span class="hs-glyph">=</span><span> </span><a name="StateT"><a href="Control.Monad.Trans.State.Lazy.html#StateT"><span class="hs-identifier">StateT</span></a></a><span> </span><span class="hs-special">{</span><span> </span><a name="runStateT"><a href="Control.Monad.Trans.State.Lazy.html#runStateT"><span class="hs-identifier">runStateT</span></a></a><span> </span><span class="hs-glyph">::</span><span> </span><a href="#local-6989586621679056239"><span class="hs-identifier hs-type">s</span></a><span> </span><span class="hs-glyph">-&gt;</span><span> </span><a href="#local-6989586621679056240"><span class="hs-identifier hs-type">m</span></a><span> </span><span class="hs-special">(</span><a href="#local-6989586621679056241"><span class="hs-identifier hs-type">a</span></a><span class="hs-special">,</span><a href="#local-6989586621679056239"><span class="hs-identifier hs-type">s</span></a><span class="hs-special">)</span><span> </span><span class="hs-special">}</span><span>
</span><a name="line-159"></a><span>
</span><a name="line-160"></a><span class="hs-comment">-- | Evaluate a state computation with the given initial state</span><span>
</span><a name="line-161"></a><span class="hs-comment">-- and return the final value, discarding the final state.</span><span>
</span><a name="line-162"></a><span class="hs-comment">--</span><span>
</span><a name="line-163"></a><span class="hs-comment">-- * @'evalStateT' m s = 'liftM' 'fst' ('runStateT' m s)@</span><span>
</span><a name="line-164"></a><span class="hs-identifier">evalStateT</span><span> </span><span class="hs-glyph">::</span><span> </span><span class="hs-special">(</span><a href="../base-4.10.0.0/src/%{MODULE/./-}.html#%{NAME}/GHC.Base.html#Monad"><span class="hs-identifier hs-type">Monad</span></a><span> </span><a href="#local-6989586621679056335"><span class="hs-identifier hs-type">m</span></a><span class="hs-special">)</span><span> </span><span class="hs-glyph">=&gt;</span><span> </span><a href="Control.Monad.Trans.State.Lazy.html#StateT"><span class="hs-identifier hs-type">StateT</span></a><span> </span><a href="#local-6989586621679056336"><span class="hs-identifier hs-type">s</span></a><span> </span><a href="#local-6989586621679056335"><span class="hs-identifier hs-type">m</span></a><span> </span><a href="#local-6989586621679056337"><span class="hs-identifier hs-type">a</span></a><span> </span><span class="hs-glyph">-&gt;</span><span> </span><a href="#local-6989586621679056336"><span class="hs-identifier hs-type">s</span></a><span> </span><span class="hs-glyph">-&gt;</span><span> </span><a href="#local-6989586621679056335"><span class="hs-identifier hs-type">m</span></a><span> </span><a href="#local-6989586621679056337"><span class="hs-identifier hs-type">a</span></a><span>
</span><a name="line-165"></a><a name="evalStateT"><a href="Control.Monad.Trans.State.Lazy.html#evalStateT"><span class="hs-identifier">evalStateT</span></a></a><span> </span><a name="local-6989586621679056359"><a href="#local-6989586621679056359"><span class="hs-identifier">m</span></a></a><span> </span><a name="local-6989586621679056360"><a href="#local-6989586621679056360"><span class="hs-identifier">s</span></a></a><span> </span><span class="hs-glyph">=</span><span> </span><span class="hs-keyword">do</span><span>
</span><a name="line-166"></a><span>    </span><span class="hs-glyph">~</span><span class="hs-special">(</span><a name="local-6989586621679056361"><a href="#local-6989586621679056361"><span class="hs-identifier">a</span></a></a><span class="hs-special">,</span><span> </span><span class="hs-identifier">_</span><span class="hs-special">)</span><span> </span><span class="hs-glyph">&lt;-</span><span> </span><span class="hs-identifier">runStateT</span><span> </span><a href="#local-6989586621679056359"><span class="hs-identifier hs-var">m</span></a><span> </span><a href="#local-6989586621679056360"><span class="hs-identifier hs-var">s</span></a><span>
</span><a name="line-167"></a><span>    </span><a href="../base-4.10.0.0/src/%{MODULE/./-}.html#%{NAME}/GHC.Base.html#return"><span class="hs-identifier hs-var">return</span></a><span> </span><a href="#local-6989586621679056361"><span class="hs-identifier hs-var">a</span></a><span>
</span><a name="line-168"></a><span class="hs-pragma">{-# INLINE evalStateT #-}</span><span>
</span><a name="line-169"></a><span>
</span><a name="line-170"></a><span class="hs-comment">-- | Evaluate a state computation with the given initial state</span><span>
</span><a name="line-171"></a><span class="hs-comment">-- and return the final state, discarding the final value.</span><span>
</span><a name="line-172"></a><span class="hs-comment">--</span><span>
</span><a name="line-173"></a><span class="hs-comment">-- * @'execStateT' m s = 'liftM' 'snd' ('runStateT' m s)@</span><span>
</span><a name="line-174"></a><span class="hs-identifier">execStateT</span><span> </span><span class="hs-glyph">::</span><span> </span><span class="hs-special">(</span><a href="../base-4.10.0.0/src/%{MODULE/./-}.html#%{NAME}/GHC.Base.html#Monad"><span class="hs-identifier hs-type">Monad</span></a><span> </span><a href="#local-6989586621679056332"><span class="hs-identifier hs-type">m</span></a><span class="hs-special">)</span><span> </span><span class="hs-glyph">=&gt;</span><span> </span><a href="Control.Monad.Trans.State.Lazy.html#StateT"><span class="hs-identifier hs-type">StateT</span></a><span> </span><a href="#local-6989586621679056333"><span class="hs-identifier hs-type">s</span></a><span> </span><a href="#local-6989586621679056332"><span class="hs-identifier hs-type">m</span></a><span> </span><a href="#local-6989586621679056334"><span class="hs-identifier hs-type">a</span></a><span> </span><span class="hs-glyph">-&gt;</span><span> </span><a href="#local-6989586621679056333"><span class="hs-identifier hs-type">s</span></a><span> </span><span class="hs-glyph">-&gt;</span><span> </span><a href="#local-6989586621679056332"><span class="hs-identifier hs-type">m</span></a><span> </span><a href="#local-6989586621679056333"><span class="hs-identifier hs-type">s</span></a><span>
</span><a name="line-175"></a><a name="execStateT"><a href="Control.Monad.Trans.State.Lazy.html#execStateT"><span class="hs-identifier">execStateT</span></a></a><span> </span><a name="local-6989586621679056362"><a href="#local-6989586621679056362"><span class="hs-identifier">m</span></a></a><span> </span><a name="local-6989586621679056363"><a href="#local-6989586621679056363"><span class="hs-identifier">s</span></a></a><span> </span><span class="hs-glyph">=</span><span> </span><span class="hs-keyword">do</span><span>
</span><a name="line-176"></a><span>    </span><span class="hs-glyph">~</span><span class="hs-special">(</span><span class="hs-identifier">_</span><span class="hs-special">,</span><span> </span><a name="local-6989586621679056364"><a href="#local-6989586621679056364"><span class="hs-identifier">s'</span></a></a><span class="hs-special">)</span><span> </span><span class="hs-glyph">&lt;-</span><span> </span><span class="hs-identifier">runStateT</span><span> </span><a href="#local-6989586621679056362"><span class="hs-identifier hs-var">m</span></a><span> </span><a href="#local-6989586621679056363"><span class="hs-identifier hs-var">s</span></a><span>
</span><a name="line-177"></a><span>    </span><a href="../base-4.10.0.0/src/%{MODULE/./-}.html#%{NAME}/GHC.Base.html#return"><span class="hs-identifier hs-var">return</span></a><span> </span><a href="#local-6989586621679056364"><span class="hs-identifier hs-var">s'</span></a><span>
</span><a name="line-178"></a><span class="hs-pragma">{-# INLINE execStateT #-}</span><span>
</span><a name="line-179"></a><span>
</span><a name="line-180"></a><span class="hs-comment">-- | Map both the return value and final state of a computation using</span><span>
</span><a name="line-181"></a><span class="hs-comment">-- the given function.</span><span>
</span><a name="line-182"></a><span class="hs-comment">--</span><span>
</span><a name="line-183"></a><span class="hs-comment">-- * @'runStateT' ('mapStateT' f m) = f . 'runStateT' m@</span><span>
</span><a name="line-184"></a><span class="hs-identifier">mapStateT</span><span> </span><span class="hs-glyph">::</span><span> </span><span class="hs-special">(</span><a href="#local-6989586621679056327"><span class="hs-identifier hs-type">m</span></a><span> </span><span class="hs-special">(</span><a href="#local-6989586621679056328"><span class="hs-identifier hs-type">a</span></a><span class="hs-special">,</span><span> </span><a href="#local-6989586621679056329"><span class="hs-identifier hs-type">s</span></a><span class="hs-special">)</span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><a href="#local-6989586621679056330"><span class="hs-identifier hs-type">n</span></a><span> </span><span class="hs-special">(</span><a href="#local-6989586621679056331"><span class="hs-identifier hs-type">b</span></a><span class="hs-special">,</span><span> </span><a href="#local-6989586621679056329"><span class="hs-identifier hs-type">s</span></a><span class="hs-special">)</span><span class="hs-special">)</span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><a href="Control.Monad.Trans.State.Lazy.html#StateT"><span class="hs-identifier hs-type">StateT</span></a><span> </span><a href="#local-6989586621679056329"><span class="hs-identifier hs-type">s</span></a><span> </span><a href="#local-6989586621679056327"><span class="hs-identifier hs-type">m</span></a><span> </span><a href="#local-6989586621679056328"><span class="hs-identifier hs-type">a</span></a><span> </span><span class="hs-glyph">-&gt;</span><span> </span><a href="Control.Monad.Trans.State.Lazy.html#StateT"><span class="hs-identifier hs-type">StateT</span></a><span> </span><a href="#local-6989586621679056329"><span class="hs-identifier hs-type">s</span></a><span> </span><a href="#local-6989586621679056330"><span class="hs-identifier hs-type">n</span></a><span> </span><a href="#local-6989586621679056331"><span class="hs-identifier hs-type">b</span></a><span>
</span><a name="line-185"></a><a name="mapStateT"><a href="Control.Monad.Trans.State.Lazy.html#mapStateT"><span class="hs-identifier">mapStateT</span></a></a><span> </span><a name="local-6989586621679056365"><a href="#local-6989586621679056365"><span class="hs-identifier">f</span></a></a><span> </span><a name="local-6989586621679056366"><a href="#local-6989586621679056366"><span class="hs-identifier">m</span></a></a><span> </span><span class="hs-glyph">=</span><span> </span><a href="Control.Monad.Trans.State.Lazy.html#StateT"><span class="hs-identifier hs-var">StateT</span></a><span> </span><a href="../base-4.10.0.0/src/%{MODULE/./-}.html#%{NAME}/GHC.Base.html#%24"><span class="hs-operator hs-var">$</span></a><span> </span><a href="#local-6989586621679056365"><span class="hs-identifier hs-var">f</span></a><span> </span><a href="../base-4.10.0.0/src/%{MODULE/./-}.html#%{NAME}/GHC.Base.html#."><span class="hs-operator hs-var">.</span></a><span> </span><span class="hs-identifier">runStateT</span><span> </span><a href="#local-6989586621679056366"><span class="hs-identifier hs-var">m</span></a><span>
</span><a name="line-186"></a><span class="hs-pragma">{-# INLINE mapStateT #-}</span><span>
</span><a name="line-187"></a><span>
</span><a name="line-188"></a><span class="hs-comment">-- | @'withStateT' f m@ executes action @m@ on a state modified by</span><span>
</span><a name="line-189"></a><span class="hs-comment">-- applying @f@.</span><span>
</span><a name="line-190"></a><span class="hs-comment">--</span><span>
</span><a name="line-191"></a><span class="hs-comment">-- * @'withStateT' f m = 'modify' f &gt;&gt; m@</span><span>
</span><a name="line-192"></a><span class="hs-identifier">withStateT</span><span> </span><span class="hs-glyph">::</span><span> </span><span class="hs-special">(</span><a href="#local-6989586621679056324"><span class="hs-identifier hs-type">s</span></a><span> </span><span class="hs-glyph">-&gt;</span><span> </span><a href="#local-6989586621679056324"><span class="hs-identifier hs-type">s</span></a><span class="hs-special">)</span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><a href="Control.Monad.Trans.State.Lazy.html#StateT"><span class="hs-identifier hs-type">StateT</span></a><span> </span><a href="#local-6989586621679056324"><span class="hs-identifier hs-type">s</span></a><span> </span><a href="#local-6989586621679056325"><span class="hs-identifier hs-type">m</span></a><span> </span><a href="#local-6989586621679056326"><span class="hs-identifier hs-type">a</span></a><span> </span><span class="hs-glyph">-&gt;</span><span> </span><a href="Control.Monad.Trans.State.Lazy.html#StateT"><span class="hs-identifier hs-type">StateT</span></a><span> </span><a href="#local-6989586621679056324"><span class="hs-identifier hs-type">s</span></a><span> </span><a href="#local-6989586621679056325"><span class="hs-identifier hs-type">m</span></a><span> </span><a href="#local-6989586621679056326"><span class="hs-identifier hs-type">a</span></a><span>
</span><a name="line-193"></a><a name="withStateT"><a href="Control.Monad.Trans.State.Lazy.html#withStateT"><span class="hs-identifier">withStateT</span></a></a><span> </span><a name="local-6989586621679056367"><a href="#local-6989586621679056367"><span class="hs-identifier">f</span></a></a><span> </span><a name="local-6989586621679056368"><a href="#local-6989586621679056368"><span class="hs-identifier">m</span></a></a><span> </span><span class="hs-glyph">=</span><span> </span><a href="Control.Monad.Trans.State.Lazy.html#StateT"><span class="hs-identifier hs-var">StateT</span></a><span> </span><a href="../base-4.10.0.0/src/%{MODULE/./-}.html#%{NAME}/GHC.Base.html#%24"><span class="hs-operator hs-var">$</span></a><span> </span><span class="hs-identifier">runStateT</span><span> </span><a href="#local-6989586621679056368"><span class="hs-identifier hs-var">m</span></a><span> </span><a href="../base-4.10.0.0/src/%{MODULE/./-}.html#%{NAME}/GHC.Base.html#."><span class="hs-operator hs-var">.</span></a><span> </span><a href="#local-6989586621679056367"><span class="hs-identifier hs-var">f</span></a><span>
</span><a name="line-194"></a><span class="hs-pragma">{-# INLINE withStateT #-}</span><span>
</span><a name="line-195"></a><span>
</span><a name="line-196"></a><span class="hs-keyword">instance</span><span> </span><span class="hs-special">(</span><a href="../base-4.10.0.0/src/%{MODULE/./-}.html#%{NAME}/GHC.Base.html#Functor"><span class="hs-identifier hs-type">Functor</span></a><span> </span><a href="#local-6989586621679056286"><span class="hs-identifier hs-type">m</span></a><span class="hs-special">)</span><span> </span><span class="hs-glyph">=&gt;</span><span> </span><a href="../base-4.10.0.0/src/%{MODULE/./-}.html#%{NAME}/GHC.Base.html#Functor"><span class="hs-identifier hs-type">Functor</span></a><span> </span><span class="hs-special">(</span><a href="Control.Monad.Trans.State.Lazy.html#StateT"><span class="hs-identifier hs-type">StateT</span></a><span> </span><a href="#local-6989586621679056287"><span class="hs-identifier hs-type">s</span></a><span> </span><a href="#local-6989586621679056286"><span class="hs-identifier hs-type">m</span></a><span class="hs-special">)</span><span> </span><span class="hs-keyword">where</span><span>
</span><a name="line-197"></a><span>    </span><a name="local-3458764513820541101"><a href="../base-4.10.0.0/src/%{MODULE/./-}.html#%{NAME}/GHC.Base.html#fmap"><span class="hs-identifier">fmap</span></a></a><span> </span><a name="local-6989586621679056288"><a href="#local-6989586621679056288"><span class="hs-identifier">f</span></a></a><span> </span><a name="local-6989586621679056289"><a href="#local-6989586621679056289"><span class="hs-identifier">m</span></a></a><span> </span><span class="hs-glyph">=</span><span> </span><a href="Control.Monad.Trans.State.Lazy.html#StateT"><span class="hs-identifier hs-var">StateT</span></a><span> </span><a href="../base-4.10.0.0/src/%{MODULE/./-}.html#%{NAME}/GHC.Base.html#%24"><span class="hs-operator hs-var">$</span></a><span> </span><span class="hs-glyph">\</span><span> </span><a name="local-6989586621679056290"><a href="#local-6989586621679056290"><span class="hs-identifier">s</span></a></a><span> </span><span class="hs-glyph">-&gt;</span><span>
</span><a name="line-198"></a><span>        </span><a href="../base-4.10.0.0/src/%{MODULE/./-}.html#%{NAME}/GHC.Base.html#fmap"><span class="hs-identifier hs-var">fmap</span></a><span> </span><span class="hs-special">(</span><span class="hs-glyph">\</span><span> </span><span class="hs-glyph">~</span><span class="hs-special">(</span><a name="local-6989586621679056291"><a href="#local-6989586621679056291"><span class="hs-identifier">a</span></a></a><span class="hs-special">,</span><span> </span><a name="local-6989586621679056292"><a href="#local-6989586621679056292"><span class="hs-identifier">s'</span></a></a><span class="hs-special">)</span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="hs-special">(</span><a href="#local-6989586621679056288"><span class="hs-identifier hs-var">f</span></a><span> </span><a href="#local-6989586621679056291"><span class="hs-identifier hs-var">a</span></a><span class="hs-special">,</span><span> </span><a href="#local-6989586621679056292"><span class="hs-identifier hs-var">s'</span></a><span class="hs-special">)</span><span class="hs-special">)</span><span> </span><a href="../base-4.10.0.0/src/%{MODULE/./-}.html#%{NAME}/GHC.Base.html#%24"><span class="hs-operator hs-var">$</span></a><span> </span><span class="hs-identifier">runStateT</span><span> </span><a href="#local-6989586621679056289"><span class="hs-identifier hs-var">m</span></a><span> </span><a href="#local-6989586621679056290"><span class="hs-identifier hs-var">s</span></a><span>
</span><a name="line-199"></a><span>    </span><span class="hs-pragma">{-# INLINE fmap #-}</span><span>
</span><a name="line-200"></a><span>
</span><a name="line-201"></a><span class="hs-keyword">instance</span><span> </span><span class="hs-special">(</span><a href="../base-4.10.0.0/src/%{MODULE/./-}.html#%{NAME}/GHC.Base.html#Functor"><span class="hs-identifier hs-type">Functor</span></a><span> </span><a href="#local-6989586621679056275"><span class="hs-identifier hs-type">m</span></a><span class="hs-special">,</span><span> </span><a href="../base-4.10.0.0/src/%{MODULE/./-}.html#%{NAME}/GHC.Base.html#Monad"><span class="hs-identifier hs-type">Monad</span></a><span> </span><a href="#local-6989586621679056275"><span class="hs-identifier hs-type">m</span></a><span class="hs-special">)</span><span> </span><span class="hs-glyph">=&gt;</span><span> </span><a href="../base-4.10.0.0/src/%{MODULE/./-}.html#%{NAME}/GHC.Base.html#Applicative"><span class="hs-identifier hs-type">Applicative</span></a><span> </span><span class="hs-special">(</span><a href="Control.Monad.Trans.State.Lazy.html#StateT"><span class="hs-identifier hs-type">StateT</span></a><span> </span><a href="#local-6989586621679056276"><span class="hs-identifier hs-type">s</span></a><span> </span><a href="#local-6989586621679056275"><span class="hs-identifier hs-type">m</span></a><span class="hs-special">)</span><span> </span><span class="hs-keyword">where</span><span>
</span><a name="line-202"></a><span>    </span><a name="local-3458764513820541680"><a href="../base-4.10.0.0/src/%{MODULE/./-}.html#%{NAME}/GHC.Base.html#pure"><span class="hs-identifier">pure</span></a></a><span> </span><a name="local-6989586621679056277"><a href="#local-6989586621679056277"><span class="hs-identifier">a</span></a></a><span> </span><span class="hs-glyph">=</span><span> </span><a href="Control.Monad.Trans.State.Lazy.html#StateT"><span class="hs-identifier hs-var">StateT</span></a><span> </span><a href="../base-4.10.0.0/src/%{MODULE/./-}.html#%{NAME}/GHC.Base.html#%24"><span class="hs-operator hs-var">$</span></a><span> </span><span class="hs-glyph">\</span><span> </span><a name="local-6989586621679056278"><a href="#local-6989586621679056278"><span class="hs-identifier">s</span></a></a><span> </span><span class="hs-glyph">-&gt;</span><span> </span><a href="../base-4.10.0.0/src/%{MODULE/./-}.html#%{NAME}/GHC.Base.html#return"><span class="hs-identifier hs-var">return</span></a><span> </span><span class="hs-special">(</span><a href="#local-6989586621679056277"><span class="hs-identifier hs-var">a</span></a><span class="hs-special">,</span><span> </span><a href="#local-6989586621679056278"><span class="hs-identifier hs-var">s</span></a><span class="hs-special">)</span><span>
</span><a name="line-203"></a><span>    </span><span class="hs-pragma">{-# INLINE pure #-}</span><span>
</span><a name="line-204"></a><span>    </span><a href="Control.Monad.Trans.State.Lazy.html#StateT"><span class="hs-identifier hs-var">StateT</span></a><span> </span><a name="local-6989586621679056279"><a href="#local-6989586621679056279"><span class="hs-identifier">mf</span></a></a><span> </span><a name="local-3458764513820541679"><a href="../base-4.10.0.0/src/%{MODULE/./-}.html#%{NAME}/GHC.Base.html#%3C%2A%3E"><span class="hs-operator">&lt;*&gt;</span></a></a><span> </span><a href="Control.Monad.Trans.State.Lazy.html#StateT"><span class="hs-identifier hs-var">StateT</span></a><span> </span><a name="local-6989586621679056280"><a href="#local-6989586621679056280"><span class="hs-identifier">mx</span></a></a><span> </span><span class="hs-glyph">=</span><span> </span><a href="Control.Monad.Trans.State.Lazy.html#StateT"><span class="hs-identifier hs-var">StateT</span></a><span> </span><a href="../base-4.10.0.0/src/%{MODULE/./-}.html#%{NAME}/GHC.Base.html#%24"><span class="hs-operator hs-var">$</span></a><span> </span><span class="hs-glyph">\</span><span> </span><a name="local-6989586621679056281"><a href="#local-6989586621679056281"><span class="hs-identifier">s</span></a></a><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="hs-keyword">do</span><span>
</span><a name="line-205"></a><span>        </span><span class="hs-glyph">~</span><span class="hs-special">(</span><a name="local-6989586621679056282"><a href="#local-6989586621679056282"><span class="hs-identifier">f</span></a></a><span class="hs-special">,</span><span> </span><a name="local-6989586621679056283"><a href="#local-6989586621679056283"><span class="hs-identifier">s'</span></a></a><span class="hs-special">)</span><span> </span><span class="hs-glyph">&lt;-</span><span> </span><a href="#local-6989586621679056279"><span class="hs-identifier hs-var">mf</span></a><span> </span><a href="#local-6989586621679056281"><span class="hs-identifier hs-var">s</span></a><span>
</span><a name="line-206"></a><span>        </span><span class="hs-glyph">~</span><span class="hs-special">(</span><a name="local-6989586621679056284"><a href="#local-6989586621679056284"><span class="hs-identifier">x</span></a></a><span class="hs-special">,</span><span> </span><a name="local-6989586621679056285"><a href="#local-6989586621679056285"><span class="hs-identifier">s''</span></a></a><span class="hs-special">)</span><span> </span><span class="hs-glyph">&lt;-</span><span> </span><a href="#local-6989586621679056280"><span class="hs-identifier hs-var">mx</span></a><span> </span><a href="#local-6989586621679056283"><span class="hs-identifier hs-var">s'</span></a><span>
</span><a name="line-207"></a><span>        </span><a href="../base-4.10.0.0/src/%{MODULE/./-}.html#%{NAME}/GHC.Base.html#return"><span class="hs-identifier hs-var">return</span></a><span> </span><span class="hs-special">(</span><a href="#local-6989586621679056282"><span class="hs-identifier hs-var">f</span></a><span> </span><a href="#local-6989586621679056284"><span class="hs-identifier hs-var">x</span></a><span class="hs-special">,</span><span> </span><a href="#local-6989586621679056285"><span class="hs-identifier hs-var">s''</span></a><span class="hs-special">)</span><span>
</span><a name="line-208"></a><span>    </span><span class="hs-pragma">{-# INLINE (&lt;*&gt;) #-}</span><span>
</span><a name="line-209"></a><span>
</span><a name="line-210"></a><span class="hs-keyword">instance</span><span> </span><span class="hs-special">(</span><a href="../base-4.10.0.0/src/%{MODULE/./-}.html#%{NAME}/GHC.Base.html#Functor"><span class="hs-identifier hs-type">Functor</span></a><span> </span><a href="#local-6989586621679056270"><span class="hs-identifier hs-type">m</span></a><span class="hs-special">,</span><span> </span><a href="../base-4.10.0.0/src/%{MODULE/./-}.html#%{NAME}/GHC.Base.html#MonadPlus"><span class="hs-identifier hs-type">MonadPlus</span></a><span> </span><a href="#local-6989586621679056270"><span class="hs-identifier hs-type">m</span></a><span class="hs-special">)</span><span> </span><span class="hs-glyph">=&gt;</span><span> </span><a href="../base-4.10.0.0/src/%{MODULE/./-}.html#%{NAME}/GHC.Base.html#Alternative"><span class="hs-identifier hs-type">Alternative</span></a><span> </span><span class="hs-special">(</span><a href="Control.Monad.Trans.State.Lazy.html#StateT"><span class="hs-identifier hs-type">StateT</span></a><span> </span><a href="#local-6989586621679056271"><span class="hs-identifier hs-type">s</span></a><span> </span><a href="#local-6989586621679056270"><span class="hs-identifier hs-type">m</span></a><span class="hs-special">)</span><span> </span><span class="hs-keyword">where</span><span>
</span><a name="line-211"></a><span>    </span><a name="local-8214565720323790963"><a href="../base-4.10.0.0/src/%{MODULE/./-}.html#%{NAME}/GHC.Base.html#empty"><span class="hs-identifier">empty</span></a></a><span> </span><span class="hs-glyph">=</span><span> </span><a href="Control.Monad.Trans.State.Lazy.html#StateT"><span class="hs-identifier hs-var">StateT</span></a><span> </span><a href="../base-4.10.0.0/src/%{MODULE/./-}.html#%{NAME}/GHC.Base.html#%24"><span class="hs-operator hs-var">$</span></a><span> </span><span class="hs-glyph">\</span><span> </span><span class="hs-identifier">_</span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><a href="../base-4.10.0.0/src/%{MODULE/./-}.html#%{NAME}/GHC.Base.html#mzero"><span class="hs-identifier hs-var">mzero</span></a><span>
</span><a name="line-212"></a><span>    </span><span class="hs-pragma">{-# INLINE empty #-}</span><span>
</span><a name="line-213"></a><span>    </span><a href="Control.Monad.Trans.State.Lazy.html#StateT"><span class="hs-identifier hs-var">StateT</span></a><span> </span><a name="local-6989586621679056272"><a href="#local-6989586621679056272"><span class="hs-identifier">m</span></a></a><span> </span><a name="local-8214565720323790962"><a href="../base-4.10.0.0/src/%{MODULE/./-}.html#%{NAME}/GHC.Base.html#%3C%7C%3E"><span class="hs-operator">&lt;|&gt;</span></a></a><span> </span><a href="Control.Monad.Trans.State.Lazy.html#StateT"><span class="hs-identifier hs-var">StateT</span></a><span> </span><a name="local-6989586621679056273"><a href="#local-6989586621679056273"><span class="hs-identifier">n</span></a></a><span> </span><span class="hs-glyph">=</span><span> </span><a href="Control.Monad.Trans.State.Lazy.html#StateT"><span class="hs-identifier hs-var">StateT</span></a><span> </span><a href="../base-4.10.0.0/src/%{MODULE/./-}.html#%{NAME}/GHC.Base.html#%24"><span class="hs-operator hs-var">$</span></a><span> </span><span class="hs-glyph">\</span><span> </span><a name="local-6989586621679056274"><a href="#local-6989586621679056274"><span class="hs-identifier">s</span></a></a><span> </span><span class="hs-glyph">-&gt;</span><span> </span><a href="#local-6989586621679056272"><span class="hs-identifier hs-var">m</span></a><span> </span><a href="#local-6989586621679056274"><span class="hs-identifier hs-var">s</span></a><span> </span><span class="hs-special">`</span><a href="../base-4.10.0.0/src/%{MODULE/./-}.html#%{NAME}/GHC.Base.html#mplus"><span class="hs-identifier hs-var">mplus</span></a><span class="hs-special">`</span><span> </span><a href="#local-6989586621679056273"><span class="hs-identifier hs-var">n</span></a><span> </span><a href="#local-6989586621679056274"><span class="hs-identifier hs-var">s</span></a><span>
</span><a name="line-214"></a><span>    </span><span class="hs-pragma">{-# INLINE (&lt;|&gt;) #-}</span><span>
</span><a name="line-215"></a><span>
</span><a name="line-216"></a><span class="hs-keyword">instance</span><span> </span><span class="hs-special">(</span><a href="../base-4.10.0.0/src/%{MODULE/./-}.html#%{NAME}/GHC.Base.html#Monad"><span class="hs-identifier hs-type">Monad</span></a><span> </span><a href="#local-6989586621679056262"><span class="hs-identifier hs-type">m</span></a><span class="hs-special">)</span><span> </span><span class="hs-glyph">=&gt;</span><span> </span><a href="../base-4.10.0.0/src/%{MODULE/./-}.html#%{NAME}/GHC.Base.html#Monad"><span class="hs-identifier hs-type">Monad</span></a><span> </span><span class="hs-special">(</span><a href="Control.Monad.Trans.State.Lazy.html#StateT"><span class="hs-identifier hs-type">StateT</span></a><span> </span><a href="#local-6989586621679056263"><span class="hs-identifier hs-type">s</span></a><span> </span><a href="#local-6989586621679056262"><span class="hs-identifier hs-type">m</span></a><span class="hs-special">)</span><span> </span><span class="hs-keyword">where</span><span>
</span><a name="line-217"></a><span class="hs-cpp">#if !(MIN_VERSION_base(4,8,0))</span><span>
</span><a name="line-218"></a><span>    </span><span class="hs-identifier">return</span><span> </span><span class="hs-identifier">a</span><span> </span><span class="hs-glyph">=</span><span> </span><span class="hs-identifier">StateT</span><span> </span><span class="hs-operator">$</span><span> </span><span class="hs-glyph">\</span><span> </span><span class="hs-identifier">s</span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="hs-identifier">return</span><span> </span><span class="hs-special">(</span><span class="hs-identifier">a</span><span class="hs-special">,</span><span> </span><span class="hs-identifier">s</span><span class="hs-special">)</span><span>
</span><a name="line-219"></a><span>    </span><span class="hs-pragma">{-# INLINE return #-}</span><span>
</span><a name="line-220"></a><span class="hs-cpp">#endif</span><span>
</span><a name="line-221"></a><span>    </span><a name="local-6989586621679056264"><a href="#local-6989586621679056264"><span class="hs-identifier">m</span></a></a><span> </span><a name="local-3458764513820541099"><a href="../base-4.10.0.0/src/%{MODULE/./-}.html#%{NAME}/GHC.Base.html#%3E%3E%3D"><span class="hs-operator">&gt;&gt;=</span></a></a><span> </span><a name="local-6989586621679056265"><a href="#local-6989586621679056265"><span class="hs-identifier">k</span></a></a><span>  </span><span class="hs-glyph">=</span><span> </span><a href="Control.Monad.Trans.State.Lazy.html#StateT"><span class="hs-identifier hs-var">StateT</span></a><span> </span><a href="../base-4.10.0.0/src/%{MODULE/./-}.html#%{NAME}/GHC.Base.html#%24"><span class="hs-operator hs-var">$</span></a><span> </span><span class="hs-glyph">\</span><span> </span><a name="local-6989586621679056266"><a href="#local-6989586621679056266"><span class="hs-identifier">s</span></a></a><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="hs-keyword">do</span><span>
</span><a name="line-222"></a><span>        </span><span class="hs-glyph">~</span><span class="hs-special">(</span><a name="local-6989586621679056267"><a href="#local-6989586621679056267"><span class="hs-identifier">a</span></a></a><span class="hs-special">,</span><span> </span><a name="local-6989586621679056268"><a href="#local-6989586621679056268"><span class="hs-identifier">s'</span></a></a><span class="hs-special">)</span><span> </span><span class="hs-glyph">&lt;-</span><span> </span><span class="hs-identifier">runStateT</span><span> </span><a href="#local-6989586621679056264"><span class="hs-identifier hs-var">m</span></a><span> </span><a href="#local-6989586621679056266"><span class="hs-identifier hs-var">s</span></a><span>
</span><a name="line-223"></a><span>        </span><span class="hs-identifier">runStateT</span><span> </span><span class="hs-special">(</span><a href="#local-6989586621679056265"><span class="hs-identifier hs-var">k</span></a><span> </span><a href="#local-6989586621679056267"><span class="hs-identifier hs-var">a</span></a><span class="hs-special">)</span><span> </span><a href="#local-6989586621679056268"><span class="hs-identifier hs-var">s'</span></a><span>
</span><a name="line-224"></a><span>    </span><span class="hs-pragma">{-# INLINE (&gt;&gt;=) #-}</span><span>
</span><a name="line-225"></a><span>    </span><a name="local-3458764513820541098"><a href="../base-4.10.0.0/src/%{MODULE/./-}.html#%{NAME}/GHC.Base.html#fail"><span class="hs-identifier">fail</span></a></a><span> </span><a name="local-6989586621679056269"><a href="#local-6989586621679056269"><span class="hs-identifier">str</span></a></a><span> </span><span class="hs-glyph">=</span><span> </span><a href="Control.Monad.Trans.State.Lazy.html#StateT"><span class="hs-identifier hs-var">StateT</span></a><span> </span><a href="../base-4.10.0.0/src/%{MODULE/./-}.html#%{NAME}/GHC.Base.html#%24"><span class="hs-operator hs-var">$</span></a><span> </span><span class="hs-glyph">\</span><span> </span><span class="hs-identifier">_</span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><a href="../base-4.10.0.0/src/%{MODULE/./-}.html#%{NAME}/GHC.Base.html#fail"><span class="hs-identifier hs-var">fail</span></a><span> </span><a href="#local-6989586621679056269"><span class="hs-identifier hs-var">str</span></a><span>
</span><a name="line-226"></a><span>    </span><span class="hs-pragma">{-# INLINE fail #-}</span><span>
</span><a name="line-227"></a><span>
</span><a name="line-228"></a><span class="hs-cpp">#if MIN_VERSION_base(4,9,0)</span><span>
</span><a name="line-229"></a><span class="hs-keyword">instance</span><span> </span><span class="hs-special">(</span><a href="../base-4.10.0.0/src/%{MODULE/./-}.html#%{NAME}/Control.Monad.Fail.html#MonadFail"><span class="hs-identifier hs-type">Fail</span><span class="hs-operator hs-type">.</span><span class="hs-identifier hs-type">MonadFail</span></a><span> </span><a href="#local-6989586621679056259"><span class="hs-identifier hs-type">m</span></a><span class="hs-special">)</span><span> </span><span class="hs-glyph">=&gt;</span><span> </span><a href="../base-4.10.0.0/src/%{MODULE/./-}.html#%{NAME}/Control.Monad.Fail.html#MonadFail"><span class="hs-identifier hs-type">Fail</span><span class="hs-operator hs-type">.</span><span class="hs-identifier hs-type">MonadFail</span></a><span> </span><span class="hs-special">(</span><a href="Control.Monad.Trans.State.Lazy.html#StateT"><span class="hs-identifier hs-type">StateT</span></a><span> </span><a href="#local-6989586621679056260"><span class="hs-identifier hs-type">s</span></a><span> </span><a href="#local-6989586621679056259"><span class="hs-identifier hs-type">m</span></a><span class="hs-special">)</span><span> </span><span class="hs-keyword">where</span><span>
</span><a name="line-230"></a><span>    </span><a name="local-3458764513820541104"><a href="../base-4.10.0.0/src/%{MODULE/./-}.html#%{NAME}/Control.Monad.Fail.html#fail"><span class="hs-identifier">fail</span></a></a><span> </span><a name="local-6989586621679056261"><a href="#local-6989586621679056261"><span class="hs-identifier">str</span></a></a><span> </span><span class="hs-glyph">=</span><span> </span><a href="Control.Monad.Trans.State.Lazy.html#StateT"><span class="hs-identifier hs-var">StateT</span></a><span> </span><a href="../base-4.10.0.0/src/%{MODULE/./-}.html#%{NAME}/GHC.Base.html#%24"><span class="hs-operator hs-var">$</span></a><span> </span><span class="hs-glyph">\</span><span> </span><span class="hs-identifier">_</span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><a href="../base-4.10.0.0/src/%{MODULE/./-}.html#%{NAME}/Control.Monad.Fail.html#fail"><span class="hs-identifier hs-var">Fail</span><span class="hs-operator hs-var">.</span><span class="hs-identifier hs-var">fail</span></a><span> </span><a href="#local-6989586621679056261"><span class="hs-identifier hs-var">str</span></a><span>
</span><a name="line-231"></a><span>    </span><span class="hs-pragma">{-# INLINE fail #-}</span><span>
</span><a name="line-232"></a><span class="hs-cpp">#endif</span><span>
</span><a name="line-233"></a><span>
</span><a name="line-234"></a><span class="hs-keyword">instance</span><span> </span><span class="hs-special">(</span><a href="../base-4.10.0.0/src/%{MODULE/./-}.html#%{NAME}/GHC.Base.html#MonadPlus"><span class="hs-identifier hs-type">MonadPlus</span></a><span> </span><a href="#local-6989586621679056254"><span class="hs-identifier hs-type">m</span></a><span class="hs-special">)</span><span> </span><span class="hs-glyph">=&gt;</span><span> </span><a href="../base-4.10.0.0/src/%{MODULE/./-}.html#%{NAME}/GHC.Base.html#MonadPlus"><span class="hs-identifier hs-type">MonadPlus</span></a><span> </span><span class="hs-special">(</span><a href="Control.Monad.Trans.State.Lazy.html#StateT"><span class="hs-identifier hs-type">StateT</span></a><span> </span><a href="#local-6989586621679056255"><span class="hs-identifier hs-type">s</span></a><span> </span><a href="#local-6989586621679056254"><span class="hs-identifier hs-type">m</span></a><span class="hs-special">)</span><span> </span><span class="hs-keyword">where</span><span>
</span><a name="line-235"></a><span>    </span><a name="local-8214565720323790966"><a href="../base-4.10.0.0/src/%{MODULE/./-}.html#%{NAME}/GHC.Base.html#mzero"><span class="hs-identifier">mzero</span></a></a><span>       </span><span class="hs-glyph">=</span><span> </span><a href="Control.Monad.Trans.State.Lazy.html#StateT"><span class="hs-identifier hs-var">StateT</span></a><span> </span><a href="../base-4.10.0.0/src/%{MODULE/./-}.html#%{NAME}/GHC.Base.html#%24"><span class="hs-operator hs-var">$</span></a><span> </span><span class="hs-glyph">\</span><span> </span><span class="hs-identifier">_</span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><a href="../base-4.10.0.0/src/%{MODULE/./-}.html#%{NAME}/GHC.Base.html#mzero"><span class="hs-identifier hs-var">mzero</span></a><span>
</span><a name="line-236"></a><span>    </span><span class="hs-pragma">{-# INLINE mzero #-}</span><span>
</span><a name="line-237"></a><span>    </span><a href="Control.Monad.Trans.State.Lazy.html#StateT"><span class="hs-identifier hs-var">StateT</span></a><span> </span><a name="local-6989586621679056256"><a href="#local-6989586621679056256"><span class="hs-identifier">m</span></a></a><span> </span><span class="hs-special">`</span><a name="local-8214565720323790965"><a href="../base-4.10.0.0/src/%{MODULE/./-}.html#%{NAME}/GHC.Base.html#mplus"><span class="hs-identifier">mplus</span></a></a><span class="hs-special">`</span><span> </span><a href="Control.Monad.Trans.State.Lazy.html#StateT"><span class="hs-identifier hs-var">StateT</span></a><span> </span><a name="local-6989586621679056257"><a href="#local-6989586621679056257"><span class="hs-identifier">n</span></a></a><span> </span><span class="hs-glyph">=</span><span> </span><a href="Control.Monad.Trans.State.Lazy.html#StateT"><span class="hs-identifier hs-var">StateT</span></a><span> </span><a href="../base-4.10.0.0/src/%{MODULE/./-}.html#%{NAME}/GHC.Base.html#%24"><span class="hs-operator hs-var">$</span></a><span> </span><span class="hs-glyph">\</span><span> </span><a name="local-6989586621679056258"><a href="#local-6989586621679056258"><span class="hs-identifier">s</span></a></a><span> </span><span class="hs-glyph">-&gt;</span><span> </span><a href="#local-6989586621679056256"><span class="hs-identifier hs-var">m</span></a><span> </span><a href="#local-6989586621679056258"><span class="hs-identifier hs-var">s</span></a><span> </span><span class="hs-special">`</span><a href="../base-4.10.0.0/src/%{MODULE/./-}.html#%{NAME}/GHC.Base.html#mplus"><span class="hs-identifier hs-var">mplus</span></a><span class="hs-special">`</span><span> </span><a href="#local-6989586621679056257"><span class="hs-identifier hs-var">n</span></a><span> </span><a href="#local-6989586621679056258"><span class="hs-identifier hs-var">s</span></a><span>
</span><a name="line-238"></a><span>    </span><span class="hs-pragma">{-# INLINE mplus #-}</span><span>
</span><a name="line-239"></a><span>
</span><a name="line-240"></a><span class="hs-keyword">instance</span><span> </span><span class="hs-special">(</span><a href="../base-4.10.0.0/src/%{MODULE/./-}.html#%{NAME}/Control.Monad.Fix.html#MonadFix"><span class="hs-identifier hs-type">MonadFix</span></a><span> </span><a href="#local-6989586621679056249"><span class="hs-identifier hs-type">m</span></a><span class="hs-special">)</span><span> </span><span class="hs-glyph">=&gt;</span><span> </span><a href="../base-4.10.0.0/src/%{MODULE/./-}.html#%{NAME}/Control.Monad.Fix.html#MonadFix"><span class="hs-identifier hs-type">MonadFix</span></a><span> </span><span class="hs-special">(</span><a href="Control.Monad.Trans.State.Lazy.html#StateT"><span class="hs-identifier hs-type">StateT</span></a><span> </span><a href="#local-6989586621679056250"><span class="hs-identifier hs-type">s</span></a><span> </span><a href="#local-6989586621679056249"><span class="hs-identifier hs-type">m</span></a><span class="hs-special">)</span><span> </span><span class="hs-keyword">where</span><span>
</span><a name="line-241"></a><span>    </span><a name="local-3458764513820541103"><a href="../base-4.10.0.0/src/%{MODULE/./-}.html#%{NAME}/Control.Monad.Fix.html#mfix"><span class="hs-identifier">mfix</span></a></a><span> </span><a name="local-6989586621679056251"><a href="#local-6989586621679056251"><span class="hs-identifier">f</span></a></a><span> </span><span class="hs-glyph">=</span><span> </span><a href="Control.Monad.Trans.State.Lazy.html#StateT"><span class="hs-identifier hs-var">StateT</span></a><span> </span><a href="../base-4.10.0.0/src/%{MODULE/./-}.html#%{NAME}/GHC.Base.html#%24"><span class="hs-operator hs-var">$</span></a><span> </span><span class="hs-glyph">\</span><span> </span><a name="local-6989586621679056252"><a href="#local-6989586621679056252"><span class="hs-identifier">s</span></a></a><span> </span><span class="hs-glyph">-&gt;</span><span> </span><a href="../base-4.10.0.0/src/%{MODULE/./-}.html#%{NAME}/Control.Monad.Fix.html#mfix"><span class="hs-identifier hs-var">mfix</span></a><span> </span><a href="../base-4.10.0.0/src/%{MODULE/./-}.html#%{NAME}/GHC.Base.html#%24"><span class="hs-operator hs-var">$</span></a><span> </span><span class="hs-glyph">\</span><span> </span><span class="hs-glyph">~</span><span class="hs-special">(</span><a name="local-6989586621679056253"><a href="#local-6989586621679056253"><span class="hs-identifier">a</span></a></a><span class="hs-special">,</span><span> </span><span class="hs-identifier">_</span><span class="hs-special">)</span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="hs-identifier">runStateT</span><span> </span><span class="hs-special">(</span><a href="#local-6989586621679056251"><span class="hs-identifier hs-var">f</span></a><span> </span><a href="#local-6989586621679056253"><span class="hs-identifier hs-var">a</span></a><span class="hs-special">)</span><span> </span><a href="#local-6989586621679056252"><span class="hs-identifier hs-var">s</span></a><span>
</span><a name="line-242"></a><span>    </span><span class="hs-pragma">{-# INLINE mfix #-}</span><span>
</span><a name="line-243"></a><span>
</span><a name="line-244"></a><span class="hs-keyword">instance</span><span> </span><a href="Control.Monad.Trans.Class.html#MonadTrans"><span class="hs-identifier hs-type">MonadTrans</span></a><span> </span><span class="hs-special">(</span><a href="Control.Monad.Trans.State.Lazy.html#StateT"><span class="hs-identifier hs-type">StateT</span></a><span> </span><a href="#local-6989586621679056245"><span class="hs-identifier hs-type">s</span></a><span class="hs-special">)</span><span> </span><span class="hs-keyword">where</span><span>
</span><a name="line-245"></a><span>    </span><a name="local-8214565720323813130"><a href="Control.Monad.Trans.Class.html#lift"><span class="hs-identifier">lift</span></a></a><span> </span><a name="local-6989586621679056246"><a href="#local-6989586621679056246"><span class="hs-identifier">m</span></a></a><span> </span><span class="hs-glyph">=</span><span> </span><a href="Control.Monad.Trans.State.Lazy.html#StateT"><span class="hs-identifier hs-var">StateT</span></a><span> </span><a href="../base-4.10.0.0/src/%{MODULE/./-}.html#%{NAME}/GHC.Base.html#%24"><span class="hs-operator hs-var">$</span></a><span> </span><span class="hs-glyph">\</span><span> </span><a name="local-6989586621679056247"><a href="#local-6989586621679056247"><span class="hs-identifier">s</span></a></a><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="hs-keyword">do</span><span>
</span><a name="line-246"></a><span>        </span><a name="local-6989586621679056248"><a href="#local-6989586621679056248"><span class="hs-identifier">a</span></a></a><span> </span><span class="hs-glyph">&lt;-</span><span> </span><a href="#local-6989586621679056246"><span class="hs-identifier hs-var">m</span></a><span>
</span><a name="line-247"></a><span>        </span><a href="../base-4.10.0.0/src/%{MODULE/./-}.html#%{NAME}/GHC.Base.html#return"><span class="hs-identifier hs-var">return</span></a><span> </span><span class="hs-special">(</span><a href="#local-6989586621679056248"><span class="hs-identifier hs-var">a</span></a><span class="hs-special">,</span><span> </span><a href="#local-6989586621679056247"><span class="hs-identifier hs-var">s</span></a><span class="hs-special">)</span><span>
</span><a name="line-248"></a><span>    </span><span class="hs-pragma">{-# INLINE lift #-}</span><span>
</span><a name="line-249"></a><span>
</span><a name="line-250"></a><span class="hs-keyword">instance</span><span> </span><span class="hs-special">(</span><a href="../base-4.10.0.0/src/%{MODULE/./-}.html#%{NAME}/Control.Monad.IO.Class.html#MonadIO"><span class="hs-identifier hs-type">MonadIO</span></a><span> </span><a href="#local-6989586621679056243"><span class="hs-identifier hs-type">m</span></a><span class="hs-special">)</span><span> </span><span class="hs-glyph">=&gt;</span><span> </span><a href="../base-4.10.0.0/src/%{MODULE/./-}.html#%{NAME}/Control.Monad.IO.Class.html#MonadIO"><span class="hs-identifier hs-type">MonadIO</span></a><span> </span><span class="hs-special">(</span><a href="Control.Monad.Trans.State.Lazy.html#StateT"><span class="hs-identifier hs-type">StateT</span></a><span> </span><a href="#local-6989586621679056244"><span class="hs-identifier hs-type">s</span></a><span> </span><a href="#local-6989586621679056243"><span class="hs-identifier hs-type">m</span></a><span class="hs-special">)</span><span> </span><span class="hs-keyword">where</span><span>
</span><a name="line-251"></a><span>    </span><a name="local-8214565720323787865"><a href="../base-4.10.0.0/src/%{MODULE/./-}.html#%{NAME}/Control.Monad.IO.Class.html#liftIO"><span class="hs-identifier">liftIO</span></a></a><span> </span><span class="hs-glyph">=</span><span> </span><a href="Control.Monad.Trans.Class.html#lift"><span class="hs-identifier hs-var">lift</span></a><span> </span><a href="../base-4.10.0.0/src/%{MODULE/./-}.html#%{NAME}/GHC.Base.html#."><span class="hs-operator hs-var">.</span></a><span> </span><a href="../base-4.10.0.0/src/%{MODULE/./-}.html#%{NAME}/Control.Monad.IO.Class.html#liftIO"><span class="hs-identifier hs-var">liftIO</span></a><span>
</span><a name="line-252"></a><span>    </span><span class="hs-pragma">{-# INLINE liftIO #-}</span><span>
</span><a name="line-253"></a><span>
</span><a name="line-254"></a><span class="hs-comment">-- | Fetch the current value of the state within the monad.</span><span>
</span><a name="line-255"></a><span class="hs-identifier">get</span><span> </span><span class="hs-glyph">::</span><span> </span><span class="hs-special">(</span><a href="../base-4.10.0.0/src/%{MODULE/./-}.html#%{NAME}/GHC.Base.html#Monad"><span class="hs-identifier hs-type">Monad</span></a><span> </span><a href="#local-6989586621679056322"><span class="hs-identifier hs-type">m</span></a><span class="hs-special">)</span><span> </span><span class="hs-glyph">=&gt;</span><span> </span><a href="Control.Monad.Trans.State.Lazy.html#StateT"><span class="hs-identifier hs-type">StateT</span></a><span> </span><a href="#local-6989586621679056323"><span class="hs-identifier hs-type">s</span></a><span> </span><a href="#local-6989586621679056322"><span class="hs-identifier hs-type">m</span></a><span> </span><a href="#local-6989586621679056323"><span class="hs-identifier hs-type">s</span></a><span>
</span><a name="line-256"></a><a name="get"><a href="Control.Monad.Trans.State.Lazy.html#get"><span class="hs-identifier">get</span></a></a><span> </span><span class="hs-glyph">=</span><span> </span><a href="Control.Monad.Trans.State.Lazy.html#state"><span class="hs-identifier hs-var">state</span></a><span> </span><a href="../base-4.10.0.0/src/%{MODULE/./-}.html#%{NAME}/GHC.Base.html#%24"><span class="hs-operator hs-var">$</span></a><span> </span><span class="hs-glyph">\</span><span> </span><a name="local-6989586621679056369"><a href="#local-6989586621679056369"><span class="hs-identifier">s</span></a></a><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="hs-special">(</span><a href="#local-6989586621679056369"><span class="hs-identifier hs-var">s</span></a><span class="hs-special">,</span><span> </span><a href="#local-6989586621679056369"><span class="hs-identifier hs-var">s</span></a><span class="hs-special">)</span><span>
</span><a name="line-257"></a><span class="hs-pragma">{-# INLINE get #-}</span><span>
</span><a name="line-258"></a><span>
</span><a name="line-259"></a><span class="hs-comment">-- | @'put' s@ sets the state within the monad to @s@.</span><span>
</span><a name="line-260"></a><span class="hs-identifier">put</span><span> </span><span class="hs-glyph">::</span><span> </span><span class="hs-special">(</span><a href="../base-4.10.0.0/src/%{MODULE/./-}.html#%{NAME}/GHC.Base.html#Monad"><span class="hs-identifier hs-type">Monad</span></a><span> </span><a href="#local-6989586621679056320"><span class="hs-identifier hs-type">m</span></a><span class="hs-special">)</span><span> </span><span class="hs-glyph">=&gt;</span><span> </span><a href="#local-6989586621679056321"><span class="hs-identifier hs-type">s</span></a><span> </span><span class="hs-glyph">-&gt;</span><span> </span><a href="Control.Monad.Trans.State.Lazy.html#StateT"><span class="hs-identifier hs-type">StateT</span></a><span> </span><a href="#local-6989586621679056321"><span class="hs-identifier hs-type">s</span></a><span> </span><a href="#local-6989586621679056320"><span class="hs-identifier hs-type">m</span></a><span> </span><span class="hs-special">(</span><span class="hs-special">)</span><span>
</span><a name="line-261"></a><a name="put"><a href="Control.Monad.Trans.State.Lazy.html#put"><span class="hs-identifier">put</span></a></a><span> </span><a name="local-6989586621679056370"><a href="#local-6989586621679056370"><span class="hs-identifier">s</span></a></a><span> </span><span class="hs-glyph">=</span><span> </span><a href="Control.Monad.Trans.State.Lazy.html#state"><span class="hs-identifier hs-var">state</span></a><span> </span><a href="../base-4.10.0.0/src/%{MODULE/./-}.html#%{NAME}/GHC.Base.html#%24"><span class="hs-operator hs-var">$</span></a><span> </span><span class="hs-glyph">\</span><span> </span><span class="hs-identifier">_</span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="hs-special">(</span><span class="hs-special">(</span><span class="hs-special">)</span><span class="hs-special">,</span><span> </span><a href="#local-6989586621679056370"><span class="hs-identifier hs-var">s</span></a><span class="hs-special">)</span><span>
</span><a name="line-262"></a><span class="hs-pragma">{-# INLINE put #-}</span><span>
</span><a name="line-263"></a><span>
</span><a name="line-264"></a><span class="hs-comment">-- | @'modify' f@ is an action that updates the state to the result of</span><span>
</span><a name="line-265"></a><span class="hs-comment">-- applying @f@ to the current state.</span><span>
</span><a name="line-266"></a><span class="hs-comment">--</span><span>
</span><a name="line-267"></a><span class="hs-comment">-- * @'modify' f = 'get' &gt;&gt;= ('put' . f)@</span><span>
</span><a name="line-268"></a><span class="hs-identifier">modify</span><span> </span><span class="hs-glyph">::</span><span> </span><span class="hs-special">(</span><a href="../base-4.10.0.0/src/%{MODULE/./-}.html#%{NAME}/GHC.Base.html#Monad"><span class="hs-identifier hs-type">Monad</span></a><span> </span><a href="#local-6989586621679056318"><span class="hs-identifier hs-type">m</span></a><span class="hs-special">)</span><span> </span><span class="hs-glyph">=&gt;</span><span> </span><span class="hs-special">(</span><a href="#local-6989586621679056319"><span class="hs-identifier hs-type">s</span></a><span> </span><span class="hs-glyph">-&gt;</span><span> </span><a href="#local-6989586621679056319"><span class="hs-identifier hs-type">s</span></a><span class="hs-special">)</span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><a href="Control.Monad.Trans.State.Lazy.html#StateT"><span class="hs-identifier hs-type">StateT</span></a><span> </span><a href="#local-6989586621679056319"><span class="hs-identifier hs-type">s</span></a><span> </span><a href="#local-6989586621679056318"><span class="hs-identifier hs-type">m</span></a><span> </span><span class="hs-special">(</span><span class="hs-special">)</span><span>
</span><a name="line-269"></a><a name="modify"><a href="Control.Monad.Trans.State.Lazy.html#modify"><span class="hs-identifier">modify</span></a></a><span> </span><a name="local-6989586621679056371"><a href="#local-6989586621679056371"><span class="hs-identifier">f</span></a></a><span> </span><span class="hs-glyph">=</span><span> </span><a href="Control.Monad.Trans.State.Lazy.html#state"><span class="hs-identifier hs-var">state</span></a><span> </span><a href="../base-4.10.0.0/src/%{MODULE/./-}.html#%{NAME}/GHC.Base.html#%24"><span class="hs-operator hs-var">$</span></a><span> </span><span class="hs-glyph">\</span><span> </span><a name="local-6989586621679056372"><a href="#local-6989586621679056372"><span class="hs-identifier">s</span></a></a><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="hs-special">(</span><span class="hs-special">(</span><span class="hs-special">)</span><span class="hs-special">,</span><span> </span><a href="#local-6989586621679056371"><span class="hs-identifier hs-var">f</span></a><span> </span><a href="#local-6989586621679056372"><span class="hs-identifier hs-var">s</span></a><span class="hs-special">)</span><span>
</span><a name="line-270"></a><span class="hs-pragma">{-# INLINE modify #-}</span><span>
</span><a name="line-271"></a><span>
</span><a name="line-272"></a><span class="hs-comment">-- | A variant of 'modify' in which the computation is strict in the</span><span>
</span><a name="line-273"></a><span class="hs-comment">-- new state.</span><span>
</span><a name="line-274"></a><span class="hs-comment">--</span><span>
</span><a name="line-275"></a><span class="hs-comment">-- * @'modify'' f = 'get' &gt;&gt;= (('$!') 'put' . f)@</span><span>
</span><a name="line-276"></a><span class="hs-identifier">modify'</span><span> </span><span class="hs-glyph">::</span><span> </span><span class="hs-special">(</span><a href="../base-4.10.0.0/src/%{MODULE/./-}.html#%{NAME}/GHC.Base.html#Monad"><span class="hs-identifier hs-type">Monad</span></a><span> </span><a href="#local-6989586621679056316"><span class="hs-identifier hs-type">m</span></a><span class="hs-special">)</span><span> </span><span class="hs-glyph">=&gt;</span><span> </span><span class="hs-special">(</span><a href="#local-6989586621679056317"><span class="hs-identifier hs-type">s</span></a><span> </span><span class="hs-glyph">-&gt;</span><span> </span><a href="#local-6989586621679056317"><span class="hs-identifier hs-type">s</span></a><span class="hs-special">)</span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><a href="Control.Monad.Trans.State.Lazy.html#StateT"><span class="hs-identifier hs-type">StateT</span></a><span> </span><a href="#local-6989586621679056317"><span class="hs-identifier hs-type">s</span></a><span> </span><a href="#local-6989586621679056316"><span class="hs-identifier hs-type">m</span></a><span> </span><span class="hs-special">(</span><span class="hs-special">)</span><span>
</span><a name="line-277"></a><a name="modify%27"><a href="Control.Monad.Trans.State.Lazy.html#modify%27"><span class="hs-identifier">modify'</span></a></a><span> </span><a name="local-6989586621679056373"><a href="#local-6989586621679056373"><span class="hs-identifier">f</span></a></a><span> </span><span class="hs-glyph">=</span><span> </span><span class="hs-keyword">do</span><span>
</span><a name="line-278"></a><span>    </span><a name="local-6989586621679056374"><a href="#local-6989586621679056374"><span class="hs-identifier">s</span></a></a><span> </span><span class="hs-glyph">&lt;-</span><span> </span><a href="Control.Monad.Trans.State.Lazy.html#get"><span class="hs-identifier hs-var">get</span></a><span>
</span><a name="line-279"></a><span>    </span><a href="Control.Monad.Trans.State.Lazy.html#put"><span class="hs-identifier hs-var">put</span></a><span> </span><a href="../base-4.10.0.0/src/%{MODULE/./-}.html#%{NAME}/GHC.Base.html#%24%21"><span class="hs-operator hs-var">$!</span></a><span> </span><a href="#local-6989586621679056373"><span class="hs-identifier hs-var">f</span></a><span> </span><a href="#local-6989586621679056374"><span class="hs-identifier hs-var">s</span></a><span>
</span><a name="line-280"></a><span class="hs-pragma">{-# INLINE modify' #-}</span><span>
</span><a name="line-281"></a><span>
</span><a name="line-282"></a><span class="hs-comment">-- | Get a specific component of the state, using a projection function</span><span>
</span><a name="line-283"></a><span class="hs-comment">-- supplied.</span><span>
</span><a name="line-284"></a><span class="hs-comment">--</span><span>
</span><a name="line-285"></a><span class="hs-comment">-- * @'gets' f = 'liftM' f 'get'@</span><span>
</span><a name="line-286"></a><span class="hs-identifier">gets</span><span> </span><span class="hs-glyph">::</span><span> </span><span class="hs-special">(</span><a href="../base-4.10.0.0/src/%{MODULE/./-}.html#%{NAME}/GHC.Base.html#Monad"><span class="hs-identifier hs-type">Monad</span></a><span> </span><a href="#local-6989586621679056313"><span class="hs-identifier hs-type">m</span></a><span class="hs-special">)</span><span> </span><span class="hs-glyph">=&gt;</span><span> </span><span class="hs-special">(</span><a href="#local-6989586621679056314"><span class="hs-identifier hs-type">s</span></a><span> </span><span class="hs-glyph">-&gt;</span><span> </span><a href="#local-6989586621679056315"><span class="hs-identifier hs-type">a</span></a><span class="hs-special">)</span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><a href="Control.Monad.Trans.State.Lazy.html#StateT"><span class="hs-identifier hs-type">StateT</span></a><span> </span><a href="#local-6989586621679056314"><span class="hs-identifier hs-type">s</span></a><span> </span><a href="#local-6989586621679056313"><span class="hs-identifier hs-type">m</span></a><span> </span><a href="#local-6989586621679056315"><span class="hs-identifier hs-type">a</span></a><span>
</span><a name="line-287"></a><a name="gets"><a href="Control.Monad.Trans.State.Lazy.html#gets"><span class="hs-identifier">gets</span></a></a><span> </span><a name="local-6989586621679056375"><a href="#local-6989586621679056375"><span class="hs-identifier">f</span></a></a><span> </span><span class="hs-glyph">=</span><span> </span><a href="Control.Monad.Trans.State.Lazy.html#state"><span class="hs-identifier hs-var">state</span></a><span> </span><a href="../base-4.10.0.0/src/%{MODULE/./-}.html#%{NAME}/GHC.Base.html#%24"><span class="hs-operator hs-var">$</span></a><span> </span><span class="hs-glyph">\</span><span> </span><a name="local-6989586621679056376"><a href="#local-6989586621679056376"><span class="hs-identifier">s</span></a></a><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="hs-special">(</span><a href="#local-6989586621679056375"><span class="hs-identifier hs-var">f</span></a><span> </span><a href="#local-6989586621679056376"><span class="hs-identifier hs-var">s</span></a><span class="hs-special">,</span><span> </span><a href="#local-6989586621679056376"><span class="hs-identifier hs-var">s</span></a><span class="hs-special">)</span><span>
</span><a name="line-288"></a><span class="hs-pragma">{-# INLINE gets #-}</span><span>
</span><a name="line-289"></a><span>
</span><a name="line-290"></a><span class="hs-comment">-- | Uniform lifting of a @callCC@ operation to the new monad.</span><span>
</span><a name="line-291"></a><span class="hs-comment">-- This version rolls back to the original state on entering the</span><span>
</span><a name="line-292"></a><span class="hs-comment">-- continuation.</span><span>
</span><a name="line-293"></a><span class="hs-identifier">liftCallCC</span><span> </span><span class="hs-glyph">::</span><span> </span><a href="Control.Monad.Signatures.html#CallCC"><span class="hs-identifier hs-type">CallCC</span></a><span> </span><a href="#local-6989586621679056309"><span class="hs-identifier hs-type">m</span></a><span> </span><span class="hs-special">(</span><a href="#local-6989586621679056310"><span class="hs-identifier hs-type">a</span></a><span class="hs-special">,</span><a href="#local-6989586621679056311"><span class="hs-identifier hs-type">s</span></a><span class="hs-special">)</span><span> </span><span class="hs-special">(</span><a href="#local-6989586621679056312"><span class="hs-identifier hs-type">b</span></a><span class="hs-special">,</span><a href="#local-6989586621679056311"><span class="hs-identifier hs-type">s</span></a><span class="hs-special">)</span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><a href="Control.Monad.Signatures.html#CallCC"><span class="hs-identifier hs-type">CallCC</span></a><span> </span><span class="hs-special">(</span><a href="Control.Monad.Trans.State.Lazy.html#StateT"><span class="hs-identifier hs-type">StateT</span></a><span> </span><a href="#local-6989586621679056311"><span class="hs-identifier hs-type">s</span></a><span> </span><a href="#local-6989586621679056309"><span class="hs-identifier hs-type">m</span></a><span class="hs-special">)</span><span> </span><a href="#local-6989586621679056310"><span class="hs-identifier hs-type">a</span></a><span> </span><a href="#local-6989586621679056312"><span class="hs-identifier hs-type">b</span></a><span>
</span><a name="line-294"></a><a name="liftCallCC"><a href="Control.Monad.Trans.State.Lazy.html#liftCallCC"><span class="hs-identifier">liftCallCC</span></a></a><span> </span><a name="local-6989586621679056377"><a href="#local-6989586621679056377"><span class="hs-identifier">callCC</span></a></a><span> </span><a name="local-6989586621679056378"><a href="#local-6989586621679056378"><span class="hs-identifier">f</span></a></a><span> </span><span class="hs-glyph">=</span><span> </span><a href="Control.Monad.Trans.State.Lazy.html#StateT"><span class="hs-identifier hs-var">StateT</span></a><span> </span><a href="../base-4.10.0.0/src/%{MODULE/./-}.html#%{NAME}/GHC.Base.html#%24"><span class="hs-operator hs-var">$</span></a><span> </span><span class="hs-glyph">\</span><span> </span><a name="local-6989586621679056379"><a href="#local-6989586621679056379"><span class="hs-identifier">s</span></a></a><span> </span><span class="hs-glyph">-&gt;</span><span>
</span><a name="line-295"></a><span>    </span><a href="#local-6989586621679056377"><span class="hs-identifier hs-var">callCC</span></a><span> </span><a href="../base-4.10.0.0/src/%{MODULE/./-}.html#%{NAME}/GHC.Base.html#%24"><span class="hs-operator hs-var">$</span></a><span> </span><span class="hs-glyph">\</span><span> </span><a name="local-6989586621679056380"><a href="#local-6989586621679056380"><span class="hs-identifier">c</span></a></a><span> </span><span class="hs-glyph">-&gt;</span><span>
</span><a name="line-296"></a><span>    </span><span class="hs-identifier">runStateT</span><span> </span><span class="hs-special">(</span><a href="#local-6989586621679056378"><span class="hs-identifier hs-var">f</span></a><span> </span><span class="hs-special">(</span><span class="hs-glyph">\</span><span> </span><a name="local-6989586621679056381"><a href="#local-6989586621679056381"><span class="hs-identifier">a</span></a></a><span> </span><span class="hs-glyph">-&gt;</span><span> </span><a href="Control.Monad.Trans.State.Lazy.html#StateT"><span class="hs-identifier hs-var">StateT</span></a><span> </span><a href="../base-4.10.0.0/src/%{MODULE/./-}.html#%{NAME}/GHC.Base.html#%24"><span class="hs-operator hs-var">$</span></a><span> </span><span class="hs-glyph">\</span><span> </span><span class="hs-identifier">_</span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><a href="#local-6989586621679056380"><span class="hs-identifier hs-var">c</span></a><span> </span><span class="hs-special">(</span><a href="#local-6989586621679056381"><span class="hs-identifier hs-var">a</span></a><span class="hs-special">,</span><span> </span><a href="#local-6989586621679056379"><span class="hs-identifier hs-var">s</span></a><span class="hs-special">)</span><span class="hs-special">)</span><span class="hs-special">)</span><span> </span><a href="#local-6989586621679056379"><span class="hs-identifier hs-var">s</span></a><span>
</span><a name="line-297"></a><span class="hs-pragma">{-# INLINE liftCallCC #-}</span><span>
</span><a name="line-298"></a><span>
</span><a name="line-299"></a><span class="hs-comment">-- | In-situ lifting of a @callCC@ operation to the new monad.</span><span>
</span><a name="line-300"></a><span class="hs-comment">-- This version uses the current state on entering the continuation.</span><span>
</span><a name="line-301"></a><span class="hs-comment">-- It does not satisfy the uniformity property (see &quot;Control.Monad.Signatures&quot;).</span><span>
</span><a name="line-302"></a><span class="hs-identifier">liftCallCC'</span><span> </span><span class="hs-glyph">::</span><span> </span><a href="Control.Monad.Signatures.html#CallCC"><span class="hs-identifier hs-type">CallCC</span></a><span> </span><a href="#local-6989586621679056305"><span class="hs-identifier hs-type">m</span></a><span> </span><span class="hs-special">(</span><a href="#local-6989586621679056306"><span class="hs-identifier hs-type">a</span></a><span class="hs-special">,</span><a href="#local-6989586621679056307"><span class="hs-identifier hs-type">s</span></a><span class="hs-special">)</span><span> </span><span class="hs-special">(</span><a href="#local-6989586621679056308"><span class="hs-identifier hs-type">b</span></a><span class="hs-special">,</span><a href="#local-6989586621679056307"><span class="hs-identifier hs-type">s</span></a><span class="hs-special">)</span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><a href="Control.Monad.Signatures.html#CallCC"><span class="hs-identifier hs-type">CallCC</span></a><span> </span><span class="hs-special">(</span><a href="Control.Monad.Trans.State.Lazy.html#StateT"><span class="hs-identifier hs-type">StateT</span></a><span> </span><a href="#local-6989586621679056307"><span class="hs-identifier hs-type">s</span></a><span> </span><a href="#local-6989586621679056305"><span class="hs-identifier hs-type">m</span></a><span class="hs-special">)</span><span> </span><a href="#local-6989586621679056306"><span class="hs-identifier hs-type">a</span></a><span> </span><a href="#local-6989586621679056308"><span class="hs-identifier hs-type">b</span></a><span>
</span><a name="line-303"></a><a name="liftCallCC%27"><a href="Control.Monad.Trans.State.Lazy.html#liftCallCC%27"><span class="hs-identifier">liftCallCC'</span></a></a><span> </span><a name="local-6989586621679056382"><a href="#local-6989586621679056382"><span class="hs-identifier">callCC</span></a></a><span> </span><a name="local-6989586621679056383"><a href="#local-6989586621679056383"><span class="hs-identifier">f</span></a></a><span> </span><span class="hs-glyph">=</span><span> </span><a href="Control.Monad.Trans.State.Lazy.html#StateT"><span class="hs-identifier hs-var">StateT</span></a><span> </span><a href="../base-4.10.0.0/src/%{MODULE/./-}.html#%{NAME}/GHC.Base.html#%24"><span class="hs-operator hs-var">$</span></a><span> </span><span class="hs-glyph">\</span><span> </span><a name="local-6989586621679056384"><a href="#local-6989586621679056384"><span class="hs-identifier">s</span></a></a><span> </span><span class="hs-glyph">-&gt;</span><span>
</span><a name="line-304"></a><span>    </span><a href="#local-6989586621679056382"><span class="hs-identifier hs-var">callCC</span></a><span> </span><a href="../base-4.10.0.0/src/%{MODULE/./-}.html#%{NAME}/GHC.Base.html#%24"><span class="hs-operator hs-var">$</span></a><span> </span><span class="hs-glyph">\</span><span> </span><a name="local-6989586621679056385"><a href="#local-6989586621679056385"><span class="hs-identifier">c</span></a></a><span> </span><span class="hs-glyph">-&gt;</span><span>
</span><a name="line-305"></a><span>    </span><span class="hs-identifier">runStateT</span><span> </span><span class="hs-special">(</span><a href="#local-6989586621679056383"><span class="hs-identifier hs-var">f</span></a><span> </span><span class="hs-special">(</span><span class="hs-glyph">\</span><span> </span><a name="local-6989586621679056386"><a href="#local-6989586621679056386"><span class="hs-identifier">a</span></a></a><span> </span><span class="hs-glyph">-&gt;</span><span> </span><a href="Control.Monad.Trans.State.Lazy.html#StateT"><span class="hs-identifier hs-var">StateT</span></a><span> </span><a href="../base-4.10.0.0/src/%{MODULE/./-}.html#%{NAME}/GHC.Base.html#%24"><span class="hs-operator hs-var">$</span></a><span> </span><span class="hs-glyph">\</span><span> </span><a name="local-6989586621679056387"><a href="#local-6989586621679056387"><span class="hs-identifier">s'</span></a></a><span> </span><span class="hs-glyph">-&gt;</span><span> </span><a href="#local-6989586621679056385"><span class="hs-identifier hs-var">c</span></a><span> </span><span class="hs-special">(</span><a href="#local-6989586621679056386"><span class="hs-identifier hs-var">a</span></a><span class="hs-special">,</span><span> </span><a href="#local-6989586621679056387"><span class="hs-identifier hs-var">s'</span></a><span class="hs-special">)</span><span class="hs-special">)</span><span class="hs-special">)</span><span> </span><a href="#local-6989586621679056384"><span class="hs-identifier hs-var">s</span></a><span>
</span><a name="line-306"></a><span class="hs-pragma">{-# INLINE liftCallCC' #-}</span><span>
</span><a name="line-307"></a><span>
</span><a name="line-308"></a><span class="hs-comment">-- | Lift a @catchE@ operation to the new monad.</span><span>
</span><a name="line-309"></a><span class="hs-identifier">liftCatch</span><span> </span><span class="hs-glyph">::</span><span> </span><a href="Control.Monad.Signatures.html#Catch"><span class="hs-identifier hs-type">Catch</span></a><span> </span><a href="#local-6989586621679056301"><span class="hs-identifier hs-type">e</span></a><span> </span><a href="#local-6989586621679056302"><span class="hs-identifier hs-type">m</span></a><span> </span><span class="hs-special">(</span><a href="#local-6989586621679056303"><span class="hs-identifier hs-type">a</span></a><span class="hs-special">,</span><a href="#local-6989586621679056304"><span class="hs-identifier hs-type">s</span></a><span class="hs-special">)</span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><a href="Control.Monad.Signatures.html#Catch"><span class="hs-identifier hs-type">Catch</span></a><span> </span><a href="#local-6989586621679056301"><span class="hs-identifier hs-type">e</span></a><span> </span><span class="hs-special">(</span><a href="Control.Monad.Trans.State.Lazy.html#StateT"><span class="hs-identifier hs-type">StateT</span></a><span> </span><a href="#local-6989586621679056304"><span class="hs-identifier hs-type">s</span></a><span> </span><a href="#local-6989586621679056302"><span class="hs-identifier hs-type">m</span></a><span class="hs-special">)</span><span> </span><a href="#local-6989586621679056303"><span class="hs-identifier hs-type">a</span></a><span>
</span><a name="line-310"></a><a name="liftCatch"><a href="Control.Monad.Trans.State.Lazy.html#liftCatch"><span class="hs-identifier">liftCatch</span></a></a><span> </span><a name="local-6989586621679056388"><a href="#local-6989586621679056388"><span class="hs-identifier">catchE</span></a></a><span> </span><a name="local-6989586621679056389"><a href="#local-6989586621679056389"><span class="hs-identifier">m</span></a></a><span> </span><a name="local-6989586621679056390"><a href="#local-6989586621679056390"><span class="hs-identifier">h</span></a></a><span> </span><span class="hs-glyph">=</span><span>
</span><a name="line-311"></a><span>    </span><a href="Control.Monad.Trans.State.Lazy.html#StateT"><span class="hs-identifier hs-var">StateT</span></a><span> </span><a href="../base-4.10.0.0/src/%{MODULE/./-}.html#%{NAME}/GHC.Base.html#%24"><span class="hs-operator hs-var">$</span></a><span> </span><span class="hs-glyph">\</span><span> </span><a name="local-6989586621679056391"><a href="#local-6989586621679056391"><span class="hs-identifier">s</span></a></a><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="hs-identifier">runStateT</span><span> </span><a href="#local-6989586621679056389"><span class="hs-identifier hs-var">m</span></a><span> </span><a href="#local-6989586621679056391"><span class="hs-identifier hs-var">s</span></a><span> </span><span class="hs-special">`</span><a href="#local-6989586621679056388"><span class="hs-identifier hs-var">catchE</span></a><span class="hs-special">`</span><span> </span><span class="hs-glyph">\</span><span> </span><a name="local-6989586621679056392"><a href="#local-6989586621679056392"><span class="hs-identifier">e</span></a></a><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="hs-identifier">runStateT</span><span> </span><span class="hs-special">(</span><a href="#local-6989586621679056390"><span class="hs-identifier hs-var">h</span></a><span> </span><a href="#local-6989586621679056392"><span class="hs-identifier hs-var">e</span></a><span class="hs-special">)</span><span> </span><a href="#local-6989586621679056391"><span class="hs-identifier hs-var">s</span></a><span>
</span><a name="line-312"></a><span class="hs-pragma">{-# INLINE liftCatch #-}</span><span>
</span><a name="line-313"></a><span>
</span><a name="line-314"></a><span class="hs-comment">-- | Lift a @listen@ operation to the new monad.</span><span>
</span><a name="line-315"></a><span class="hs-identifier">liftListen</span><span> </span><span class="hs-glyph">::</span><span> </span><span class="hs-special">(</span><a href="../base-4.10.0.0/src/%{MODULE/./-}.html#%{NAME}/GHC.Base.html#Monad"><span class="hs-identifier hs-type">Monad</span></a><span> </span><a href="#local-6989586621679056297"><span class="hs-identifier hs-type">m</span></a><span class="hs-special">)</span><span> </span><span class="hs-glyph">=&gt;</span><span> </span><a href="Control.Monad.Signatures.html#Listen"><span class="hs-identifier hs-type">Listen</span></a><span> </span><a href="#local-6989586621679056298"><span class="hs-identifier hs-type">w</span></a><span> </span><a href="#local-6989586621679056297"><span class="hs-identifier hs-type">m</span></a><span> </span><span class="hs-special">(</span><a href="#local-6989586621679056299"><span class="hs-identifier hs-type">a</span></a><span class="hs-special">,</span><a href="#local-6989586621679056300"><span class="hs-identifier hs-type">s</span></a><span class="hs-special">)</span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><a href="Control.Monad.Signatures.html#Listen"><span class="hs-identifier hs-type">Listen</span></a><span> </span><a href="#local-6989586621679056298"><span class="hs-identifier hs-type">w</span></a><span> </span><span class="hs-special">(</span><a href="Control.Monad.Trans.State.Lazy.html#StateT"><span class="hs-identifier hs-type">StateT</span></a><span> </span><a href="#local-6989586621679056300"><span class="hs-identifier hs-type">s</span></a><span> </span><a href="#local-6989586621679056297"><span class="hs-identifier hs-type">m</span></a><span class="hs-special">)</span><span> </span><a href="#local-6989586621679056299"><span class="hs-identifier hs-type">a</span></a><span>
</span><a name="line-316"></a><a name="liftListen"><a href="Control.Monad.Trans.State.Lazy.html#liftListen"><span class="hs-identifier">liftListen</span></a></a><span> </span><a name="local-6989586621679056393"><a href="#local-6989586621679056393"><span class="hs-identifier">listen</span></a></a><span> </span><a name="local-6989586621679056394"><a href="#local-6989586621679056394"><span class="hs-identifier">m</span></a></a><span> </span><span class="hs-glyph">=</span><span> </span><a href="Control.Monad.Trans.State.Lazy.html#StateT"><span class="hs-identifier hs-var">StateT</span></a><span> </span><a href="../base-4.10.0.0/src/%{MODULE/./-}.html#%{NAME}/GHC.Base.html#%24"><span class="hs-operator hs-var">$</span></a><span> </span><span class="hs-glyph">\</span><span> </span><a name="local-6989586621679056395"><a href="#local-6989586621679056395"><span class="hs-identifier">s</span></a></a><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="hs-keyword">do</span><span>
</span><a name="line-317"></a><span>    </span><span class="hs-glyph">~</span><span class="hs-special">(</span><span class="hs-special">(</span><a name="local-6989586621679056396"><a href="#local-6989586621679056396"><span class="hs-identifier">a</span></a></a><span class="hs-special">,</span><span> </span><a name="local-6989586621679056397"><a href="#local-6989586621679056397"><span class="hs-identifier">s'</span></a></a><span class="hs-special">)</span><span class="hs-special">,</span><span> </span><a name="local-6989586621679056398"><a href="#local-6989586621679056398"><span class="hs-identifier">w</span></a></a><span class="hs-special">)</span><span> </span><span class="hs-glyph">&lt;-</span><span> </span><a href="#local-6989586621679056393"><span class="hs-identifier hs-var">listen</span></a><span> </span><span class="hs-special">(</span><span class="hs-identifier">runStateT</span><span> </span><a href="#local-6989586621679056394"><span class="hs-identifier hs-var">m</span></a><span> </span><a href="#local-6989586621679056395"><span class="hs-identifier hs-var">s</span></a><span class="hs-special">)</span><span>
</span><a name="line-318"></a><span>    </span><a href="../base-4.10.0.0/src/%{MODULE/./-}.html#%{NAME}/GHC.Base.html#return"><span class="hs-identifier hs-var">return</span></a><span> </span><span class="hs-special">(</span><span class="hs-special">(</span><a href="#local-6989586621679056396"><span class="hs-identifier hs-var">a</span></a><span class="hs-special">,</span><span> </span><a href="#local-6989586621679056398"><span class="hs-identifier hs-var">w</span></a><span class="hs-special">)</span><span class="hs-special">,</span><span> </span><a href="#local-6989586621679056397"><span class="hs-identifier hs-var">s'</span></a><span class="hs-special">)</span><span>
</span><a name="line-319"></a><span class="hs-pragma">{-# INLINE liftListen #-}</span><span>
</span><a name="line-320"></a><span>
</span><a name="line-321"></a><span class="hs-comment">-- | Lift a @pass@ operation to the new monad.</span><span>
</span><a name="line-322"></a><span class="hs-identifier">liftPass</span><span> </span><span class="hs-glyph">::</span><span> </span><span class="hs-special">(</span><a href="../base-4.10.0.0/src/%{MODULE/./-}.html#%{NAME}/GHC.Base.html#Monad"><span class="hs-identifier hs-type">Monad</span></a><span> </span><a href="#local-6989586621679056293"><span class="hs-identifier hs-type">m</span></a><span class="hs-special">)</span><span> </span><span class="hs-glyph">=&gt;</span><span> </span><a href="Control.Monad.Signatures.html#Pass"><span class="hs-identifier hs-type">Pass</span></a><span> </span><a href="#local-6989586621679056294"><span class="hs-identifier hs-type">w</span></a><span> </span><a href="#local-6989586621679056293"><span class="hs-identifier hs-type">m</span></a><span> </span><span class="hs-special">(</span><a href="#local-6989586621679056295"><span class="hs-identifier hs-type">a</span></a><span class="hs-special">,</span><a href="#local-6989586621679056296"><span class="hs-identifier hs-type">s</span></a><span class="hs-special">)</span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><a href="Control.Monad.Signatures.html#Pass"><span class="hs-identifier hs-type">Pass</span></a><span> </span><a href="#local-6989586621679056294"><span class="hs-identifier hs-type">w</span></a><span> </span><span class="hs-special">(</span><a href="Control.Monad.Trans.State.Lazy.html#StateT"><span class="hs-identifier hs-type">StateT</span></a><span> </span><a href="#local-6989586621679056296"><span class="hs-identifier hs-type">s</span></a><span> </span><a href="#local-6989586621679056293"><span class="hs-identifier hs-type">m</span></a><span class="hs-special">)</span><span> </span><a href="#local-6989586621679056295"><span class="hs-identifier hs-type">a</span></a><span>
</span><a name="line-323"></a><a name="liftPass"><a href="Control.Monad.Trans.State.Lazy.html#liftPass"><span class="hs-identifier">liftPass</span></a></a><span> </span><a name="local-6989586621679056399"><a href="#local-6989586621679056399"><span class="hs-identifier">pass</span></a></a><span> </span><a name="local-6989586621679056400"><a href="#local-6989586621679056400"><span class="hs-identifier">m</span></a></a><span> </span><span class="hs-glyph">=</span><span> </span><a href="Control.Monad.Trans.State.Lazy.html#StateT"><span class="hs-identifier hs-var">StateT</span></a><span> </span><a href="../base-4.10.0.0/src/%{MODULE/./-}.html#%{NAME}/GHC.Base.html#%24"><span class="hs-operator hs-var">$</span></a><span> </span><span class="hs-glyph">\</span><span> </span><a name="local-6989586621679056401"><a href="#local-6989586621679056401"><span class="hs-identifier">s</span></a></a><span> </span><span class="hs-glyph">-&gt;</span><span> </span><a href="#local-6989586621679056399"><span class="hs-identifier hs-var">pass</span></a><span> </span><a href="../base-4.10.0.0/src/%{MODULE/./-}.html#%{NAME}/GHC.Base.html#%24"><span class="hs-operator hs-var">$</span></a><span> </span><span class="hs-keyword">do</span><span>
</span><a name="line-324"></a><span>    </span><span class="hs-glyph">~</span><span class="hs-special">(</span><span class="hs-special">(</span><a name="local-6989586621679056402"><a href="#local-6989586621679056402"><span class="hs-identifier">a</span></a></a><span class="hs-special">,</span><span> </span><a name="local-6989586621679056403"><a href="#local-6989586621679056403"><span class="hs-identifier">f</span></a></a><span class="hs-special">)</span><span class="hs-special">,</span><span> </span><a name="local-6989586621679056404"><a href="#local-6989586621679056404"><span class="hs-identifier">s'</span></a></a><span class="hs-special">)</span><span> </span><span class="hs-glyph">&lt;-</span><span> </span><span class="hs-identifier">runStateT</span><span> </span><a href="#local-6989586621679056400"><span class="hs-identifier hs-var">m</span></a><span> </span><a href="#local-6989586621679056401"><span class="hs-identifier hs-var">s</span></a><span>
</span><a name="line-325"></a><span>    </span><a href="../base-4.10.0.0/src/%{MODULE/./-}.html#%{NAME}/GHC.Base.html#return"><span class="hs-identifier hs-var">return</span></a><span> </span><span class="hs-special">(</span><span class="hs-special">(</span><a href="#local-6989586621679056402"><span class="hs-identifier hs-var">a</span></a><span class="hs-special">,</span><span> </span><a href="#local-6989586621679056404"><span class="hs-identifier hs-var">s'</span></a><span class="hs-special">)</span><span class="hs-special">,</span><span> </span><a href="#local-6989586621679056403"><span class="hs-identifier hs-var">f</span></a><span class="hs-special">)</span><span>
</span><a name="line-326"></a><span class="hs-pragma">{-# INLINE liftPass #-}</span><span>
</span><a name="line-327"></a><span>
</span><a name="line-328"></a><span class="hs-comment">{- $examples

Parser from ParseLib with Hugs:

&gt; type Parser a = StateT String [] a
&gt;    ==&gt; StateT (String -&gt; [(a,String)])

For example, item can be written as:

&gt; item = do (x:xs) &lt;- get
&gt;        put xs
&gt;        return x
&gt;
&gt; type BoringState s a = StateT s Identity a
&gt;      ==&gt; StateT (s -&gt; Identity (a,s))
&gt;
&gt; type StateWithIO s a = StateT s IO a
&gt;      ==&gt; StateT (s -&gt; IO (a,s))
&gt;
&gt; type StateWithErr s a = StateT s Maybe a
&gt;      ==&gt; StateT (s -&gt; Maybe (a,s))

-}</span><span>
</span><a name="line-351"></a><span>
</span><a name="line-352"></a><span class="hs-comment">{- $counting

A function to increment a counter.
Taken from the paper \&quot;Generalising Monads to Arrows\&quot;,
John Hughes (&lt;http://www.cse.chalmers.se/~rjmh/&gt;), November 1998:

&gt; tick :: State Int Int
&gt; tick = do n &lt;- get
&gt;           put (n+1)
&gt;           return n

Add one to the given number using the state monad:

&gt; plusOne :: Int -&gt; Int
&gt; plusOne n = execState tick n

A contrived addition example. Works only with positive numbers:

&gt; plus :: Int -&gt; Int -&gt; Int
&gt; plus n x = execState (sequence $ replicate n tick) x

-}</span><span>
</span><a name="line-374"></a><span>
</span><a name="line-375"></a><span class="hs-comment">{- $labelling

An example from /The Craft of Functional Programming/, Simon
Thompson (&lt;http://www.cs.kent.ac.uk/people/staff/sjt/&gt;),
Addison-Wesley 1999: \&quot;Given an arbitrary tree, transform it to a
tree of integers in which the original elements are replaced by
natural numbers, starting from 0.  The same element has to be
replaced by the same number at every occurrence, and when we meet
an as-yet-unvisited element we have to find a \'new\' number to match
it with:\&quot;

&gt; data Tree a = Nil | Node a (Tree a) (Tree a) deriving (Show, Eq)
&gt; type Table a = [a]

&gt; numberTree :: Eq a =&gt; Tree a -&gt; State (Table a) (Tree Int)
&gt; numberTree Nil = return Nil
&gt; numberTree (Node x t1 t2) = do
&gt;     num &lt;- numberNode x
&gt;     nt1 &lt;- numberTree t1
&gt;     nt2 &lt;- numberTree t2
&gt;     return (Node num nt1 nt2)
&gt;   where
&gt;     numberNode :: Eq a =&gt; a -&gt; State (Table a) Int
&gt;     numberNode x = do
&gt;         table &lt;- get
&gt;         case elemIndex x table of
&gt;             Nothing -&gt; do
&gt;                 put (table ++ [x])
&gt;                 return (length table)
&gt;             Just i -&gt; return i

numTree applies numberTree with an initial state:

&gt; numTree :: (Eq a) =&gt; Tree a -&gt; Tree Int
&gt; numTree t = evalState (numberTree t) []

&gt; testTree = Node &quot;Zero&quot; (Node &quot;One&quot; (Node &quot;Two&quot; Nil Nil) (Node &quot;One&quot; (Node &quot;Zero&quot; Nil Nil) Nil)) Nil
&gt; numTree testTree =&gt; Node 0 (Node 1 (Node 2 Nil Nil) (Node 1 (Node 0 Nil Nil) Nil)) Nil

-}</span><span>
</span><a name="line-415"></a></pre></body></html>